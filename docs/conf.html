<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 10 Approches causales | Interactions et modifications d’effet   en Epidémiologie</title>
  <meta name="description" content="." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 10 Approches causales | Interactions et modifications d’effet   en Epidémiologie" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="." />
  <meta name="github-repo" content="interaction" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 10 Approches causales | Interactions et modifications d’effet   en Epidémiologie" />
  
  <meta name="twitter:description" content="." />
  

<meta name="author" content="CERPOP, INSERM, EQUITY Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="graph.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Interactions</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Présentation</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#quand-étudier-les-interactions"><i class="fa fa-check"></i><b>2.1</b> Quand étudier les interactions ?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#prediction-versus-causalité"><i class="fa fa-check"></i><b>2.1.1</b> <em>Prediction</em> versus <em>causalité</em></a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#types-dobjectifs"><i class="fa fa-check"></i><b>2.1.2</b> Types d’objectifs</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#les-points-les-plus-importants"><i class="fa fa-check"></i><b>2.2</b> Les points les plus importants</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#avertissement"><i class="fa fa-check"></i><b>2.3</b> Avertissement</a></li>
</ul></li>
<li class="part"><span><b>I Synthèse de la littérature</b></span></li>
<li class="chapter" data-level="3" data-path="définitions-préalables.html"><a href="définitions-préalables.html"><i class="fa fa-check"></i><b>3</b> Définitions préalables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="définitions-préalables.html"><a href="définitions-préalables.html#variables-et-probabilités"><i class="fa fa-check"></i><b>3.1</b> Variables et probabilités</a></li>
<li class="chapter" data-level="3.2" data-path="définitions-préalables.html"><a href="définitions-préalables.html#mesures-deffets"><i class="fa fa-check"></i><b>3.2</b> Mesures d’effets</a>
<ul>
<li class="chapter" data-level="" data-path="définitions-préalables.html"><a href="définitions-préalables.html#concernant-les-différences-de-risques-dr-effets-additifs"><i class="fa fa-check"></i>Concernant les différences de risques (DR, effets additifs)</a></li>
<li class="chapter" data-level="" data-path="définitions-préalables.html"><a href="définitions-préalables.html#concernant-les-rapports-de-risques-rr-effets-multiplicatifs"><i class="fa fa-check"></i>Concernant les rapports de risques (RR, effets multiplicatifs)</a></li>
<li class="chapter" data-level="" data-path="définitions-préalables.html"><a href="définitions-préalables.html#une-autre-échelle-multiplicative-fréquemment-utilisée-est-léchelle-des-odds-ratios-or"><i class="fa fa-check"></i>Une autre échelle multiplicative fréquemment utilisée est l’échelle des odds-ratios (OR)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="définitions-préalables.html"><a href="définitions-préalables.html#effets-conditionnels-et-marginaux"><i class="fa fa-check"></i><b>3.3</b> Effets conditionnels et marginaux</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intmodif.html"><a href="intmodif.html"><i class="fa fa-check"></i><b>4</b> Interaction ou modification d’effets</a>
<ul>
<li class="chapter" data-level="4.1" data-path="intmodif.html"><a href="intmodif.html#modification-deffets"><i class="fa fa-check"></i><b>4.1</b> Modification d’effets</a></li>
<li class="chapter" data-level="4.2" data-path="intmodif.html"><a href="intmodif.html#interaction"><i class="fa fa-check"></i><b>4.2</b> Interaction</a></li>
<li class="chapter" data-level="4.3" data-path="intmodif.html"><a href="intmodif.html#synthèse"><i class="fa fa-check"></i><b>4.3</b> Synthèse</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="echelle.html"><a href="echelle.html"><i class="fa fa-check"></i><b>5</b> La question des échelles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="echelle.html"><a href="echelle.html#mesures-des-interactions"><i class="fa fa-check"></i><b>5.1</b> Mesures des interactions</a>
<ul>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#echelle-additive"><i class="fa fa-check"></i>Echelle additive</a></li>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#echelle-multiplicative"><i class="fa fa-check"></i>Echelle multiplicative</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="echelle.html"><a href="echelle.html#lien-entre-les-deux-échelles"><i class="fa fa-check"></i><b>5.2</b> Lien entre les deux échelles</a>
<ul>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#un-apparent-paradoxe"><i class="fa fa-check"></i>Un apparent paradoxe</a></li>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#le-continuum"><i class="fa fa-check"></i>Le continuum</a></li>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#interactions-pures-et-qualitatives-interactions-inversées"><i class="fa fa-check"></i>Interactions pures et qualitatives, interactions inversées</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="echelle.html"><a href="echelle.html#synthèse-1"><i class="fa fa-check"></i><b>5.3</b> Synthèse</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="param.html"><a href="param.html"><i class="fa fa-check"></i><b>6</b> Types de paramètres</a>
<ul>
<li class="chapter" data-level="6.1" data-path="param.html"><a href="param.html#sur-léchelle-multiplicative"><i class="fa fa-check"></i><b>6.1</b> Sur l’échelle multiplicative</a>
<ul>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#avec-les-risques-relatifs-mi"><i class="fa fa-check"></i>Avec les risques relatifs (MI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#avec-les-odds-ratio-mi"><i class="fa fa-check"></i>Avec les Odds Ratio (MI)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="param.html"><a href="param.html#sur-léchelle-additive"><i class="fa fa-check"></i><b>6.2</b> Sur l’échelle additive</a>
<ul>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#avec-les-différences-de-risques-ai"><i class="fa fa-check"></i>Avec les différences de risques (AI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#excès-de-risque-à-partir-des-rr-reri"><i class="fa fa-check"></i>Excès de risque, à partir des RR (RERI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#le-synergie-index-si"><i class="fa fa-check"></i>Le “Synergie index” (SI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#proportion-attribuable-ap"><i class="fa fa-check"></i>Proportion attribuable (AP)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Estimations, Interprétations, Présentations</b></span></li>
<li class="chapter" data-level="7" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html"><i class="fa fa-check"></i><b>7</b> Présentation des résultats</a>
<ul>
<li class="chapter" data-level="7.1" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#recommandations"><i class="fa fa-check"></i><b>7.1</b> Recommandations</a>
<ul>
<li class="chapter" data-level="" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#pour-une-analyse-dune-modification-deffet-de-small-x-sur-small-y-par-small-v"><i class="fa fa-check"></i>Pour une analyse d’une modification d’effet de <span class="math inline">\(\small X\)</span> sur <span class="math inline">\(\small Y\)</span> par <span class="math inline">\(\small V\)</span></a></li>
<li class="chapter" data-level="" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#interaction-small-xv-sur-small-y"><i class="fa fa-check"></i>Interaction <span class="math inline">\(\small X*V\)</span> sur <span class="math inline">\(\small Y\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#proposition"><i class="fa fa-check"></i><b>7.2</b> Proposition</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>8</b> Simulations</a></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> A partir de modèles de régression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#regressionlogistique"><i class="fa fa-check"></i><b>9.1</b> Régression logistique</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#régression-lineaire"><i class="fa fa-check"></i><b>9.2</b> Régression lineaire</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conf.html"><a href="conf.html"><i class="fa fa-check"></i><b>10</b> Approches causales</a>
<ul>
<li class="chapter" data-level="10.1" data-path="conf.html"><a href="conf.html#gcomputation"><i class="fa fa-check"></i><b>10.1</b> Estimation par G-computation</a></li>
<li class="chapter" data-level="10.2" data-path="conf.html"><a href="conf.html#estimation-par-modèle-structurel-marginal"><i class="fa fa-check"></i><b>10.2</b> Estimation par Modèle Structurel Marginal</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="conf.html"><a href="conf.html#estimation-du-msm-par-g-computation"><i class="fa fa-check"></i><b>10.2.1</b> Estimation du MSM par g-computation</a></li>
<li class="chapter" data-level="10.2.2" data-path="conf.html"><a href="conf.html#estimation-du-msm-par-iptw"><i class="fa fa-check"></i><b>10.2.2</b> Estimation du MSM par IPTW</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="conf.html"><a href="conf.html#estimation-avec-tmle"><i class="fa fa-check"></i><b>10.3</b> Estimation avec TMLE</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>11</b> Représentations graphiques</a></li>
<li class="part"><span><b>III En pratique</b></span></li>
<li class="chapter" data-level="12" data-path="proposition-détapes.html"><a href="proposition-détapes.html"><i class="fa fa-check"></i><b>12</b> Proposition d’étapes</a></li>
<li class="chapter" data-level="13" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html"><i class="fa fa-check"></i><b>13</b> Exemple 1 - Y binaire</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#formuler-les-objectifs"><i class="fa fa-check"></i><b>13.1</b> Formuler les objectifs</a></li>
<li class="chapter" data-level="13.2" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#stratégies-et-méthodes"><i class="fa fa-check"></i><b>13.2</b> Stratégies et méthodes</a></li>
<li class="chapter" data-level="13.3" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#analyse-descriptive"><i class="fa fa-check"></i><b>13.3</b> Analyse descriptive</a></li>
<li class="chapter" data-level="13.4" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#analyse-exploratoire"><i class="fa fa-check"></i><b>13.4</b> Analyse exploratoire</a></li>
<li class="chapter" data-level="13.5" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#analyse-confirmatoire"><i class="fa fa-check"></i><b>13.5</b> Analyse confirmatoire</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html"><i class="fa fa-check"></i><b>14</b> Exemple 2 - Y quantitatif</a>
<ul>
<li class="chapter" data-level="14.1" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#formuler-les-objectifs-1"><i class="fa fa-check"></i><b>14.1</b> Formuler les objectifs</a></li>
<li class="chapter" data-level="14.2" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#stratégies-et-méthodes-1"><i class="fa fa-check"></i><b>14.2</b> Stratégies et méthodes</a></li>
<li class="chapter" data-level="14.3" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#analyse-descriptive-1"><i class="fa fa-check"></i><b>14.3</b> Analyse descriptive</a></li>
<li class="chapter" data-level="14.4" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#analyse-exploratoire-1"><i class="fa fa-check"></i><b>14.4</b> Analyse exploratoire</a></li>
<li class="chapter" data-level="14.5" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#analyse-confirmatoire-1"><i class="fa fa-check"></i><b>14.5</b> Analyse confirmatoire</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html"><i class="fa fa-check"></i><b>15</b> Exemple 4 - X quantitatif</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#formuler-les-objectifs-2"><i class="fa fa-check"></i><b>15.1</b> Formuler les objectifs</a></li>
<li class="chapter" data-level="15.2" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#stratégies-et-méthodes-2"><i class="fa fa-check"></i><b>15.2</b> Stratégies et méthodes</a></li>
<li class="chapter" data-level="15.3" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#analyse-descriptive-2"><i class="fa fa-check"></i><b>15.3</b> Analyse descriptive</a></li>
<li class="chapter" data-level="15.4" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#analyse-exploratoire-2"><i class="fa fa-check"></i><b>15.4</b> Analyse exploratoire</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#régression-logistique"><i class="fa fa-check"></i><b>15.4.1</b> Régression logistique</a></li>
<li class="chapter" data-level="15.4.2" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#régression-linéaire"><i class="fa fa-check"></i><b>15.4.2</b> Régression linéaire</a></li>
<li class="chapter" data-level="15.4.3" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#effets-prédits"><i class="fa fa-check"></i><b>15.4.3</b> Effets prédits</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#analyse-confirmatoire-2"><i class="fa fa-check"></i><b>15.5</b> Analyse confirmatoire</a></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="16" data-path="synthèse-générale.html"><a href="synthèse-générale.html"><i class="fa fa-check"></i><b>16</b> Synthèse générale</a></li>
<li class="chapter" data-level="17" data-path="plusloin.html"><a href="plusloin.html"><i class="fa fa-check"></i><b>17</b> Pour aller plus loin…</a>
<ul>
<li class="chapter" data-level="17.1" data-path="plusloin.html"><a href="plusloin.html#ajouter-de-la-complexité"><i class="fa fa-check"></i><b>17.1</b> Ajouter de la complexité</a></li>
<li class="chapter" data-level="17.2" data-path="plusloin.html"><a href="plusloin.html#interaction-avec-confusion-intermédiaire"><i class="fa fa-check"></i><b>17.2</b> Interaction avec confusion intermédiaire</a></li>
<li class="chapter" data-level="17.3" data-path="plusloin.html"><a href="plusloin.html#interaction-et-médiation"><i class="fa fa-check"></i><b>17.3</b> Interaction et médiation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i><b>18</b> Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactions et modifications d’effet <br> en Epidémiologie</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conf" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapitre 10</span> Approches causales<a href="conf.html#conf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="gcomputation" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Estimation par G-computation<a href="conf.html#gcomputation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il s’agit d’une “G-méthode” qui peut être décrite comme une “standardisation” par régression (Hernàn <span class="citation">[<a href="#ref-hernan2020causal">12</a>]</span>).
Le principe est le suivant :</p>
<ol style="list-style-type: lower-roman">
<li>Modéliser le critère de jugement en fonction des deux expositions d’intérêt, de leur interaction et des facteurs de confusion
<span class="math display">\[\begin{equation*}
  \overline{Q}(A_1,A_2,L) = \mathbb{E}(Y | A_1, A_2, L_1,L_2,L_3)
\end{equation*}\]</span></li>
<li>A partir de ce modèle <span class="math inline">\(\overline{Q}\)</span>, estimer pour chaque individu <span class="math inline">\(i\)</span> les valeurs moyennes attendues (contrefactuelles) <span class="math inline">\(\overline{Q}_i(0,0,L)\)</span>, <span class="math inline">\(\overline{Q}_i(1,0,L)\)</span>, <span class="math inline">\(\overline{Q}_i(0,1,L)\)</span> et <span class="math inline">\(\overline{Q}_i(1,1,L)\)</span>, sous les 4 scénarios possibles <span class="math inline">\(\{A_1 = 0, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 1, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 0, A_2 = 1\}\)</span> et <span class="math inline">\(\{A_1 = 1, A_2 = 1\}\)</span>.</li>
<li>Utiliser les moyennes contrefactuelles estimées pour calculer les différents indicateurs d’intérêt pour l’analyse d’interaction :</li>
</ol>
<ul>
<li><p>Les moyennes marginales pour chaque case du tableau d’interaction
<span class="math display">\[\begin{align*}
p_{00} &amp;= \frac{1}{n} \sum \overline{Q}_i(0,0,L) \\
p_{10} &amp;= \frac{1}{n} \sum \overline{Q}_i(1,0,L) \\
p_{01} &amp;= \frac{1}{n} \sum \overline{Q}_i(0,1,L) \\
p_{11} &amp;= \frac{1}{n} \sum \overline{Q}_i(1,1,L)
\end{align*}\]</span></p></li>
<li><p>Les différences de risques marginales
<span class="math display">\[\begin{align*}
DR(A_1, A_2 = 0) &amp;= p_{10} - p_{00} \\
DR(A_1, A_2 = 1) &amp;= p_{11} - p_{01} \\
DR(A_2, A_1 = 0) &amp;= p_{01} - p_{00} \\
DR(A_2, A_1 = 1) &amp;= p_{11} - p_{10}
\end{align*}\]</span></p></li>
<li><p>Les risques relatifs marginaux
<span class="math display">\[\begin{align*}
RR(A_1, A_2 = 0) &amp;= p_{10} / p_{00} \\
RR(A_1, A_2 = 1) &amp;= p_{11} / p_{01} \\
RR(A_2, A_1 = 0) &amp;= p_{01} / p_{00} \\
RR(A_2, A_1 = 1) &amp;= p_{11} / p_{10}
\end{align*}\]</span></p></li>
<li><p>Les mesures d’interaction
<span class="math display">\[\begin{align*}
MI &amp;= \frac{p_{11} \times p_{00}}{p_{10} \times p_{01}} \\
AI &amp;= p_{11} - p_{10} - p_{01} + p_{00} \\
RERI &amp;= \frac{p_{11} - p_{10} - p_{01} + p_{00}}{p_{00}}
\end{align*}\]</span></p></li>
</ul>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="conf.html#cb8-1" tabindex="-1"></a><span class="do">## i) Modéliser le critère de jugement en fonction des deux expositions d&#39;intérêt, </span></span>
<span id="cb8-2"><a href="conf.html#cb8-2" tabindex="-1"></a><span class="do">##    de leur interaction et des facteurs de confusion</span></span>
<span id="cb8-3"><a href="conf.html#cb8-3" tabindex="-1"></a>    model.Y <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> L1 <span class="sc">+</span> L2 <span class="sc">+</span> L3 <span class="sc">+</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb8-4"><a href="conf.html#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="conf.html#cb8-5" tabindex="-1"></a>    <span class="co"># dans cette exemple, les données étaient simulées à partir d&#39;un modèle additif, </span></span>
<span id="cb8-6"><a href="conf.html#cb8-6" tabindex="-1"></a>    <span class="co"># le modèle plus adapté serait donc plutôt le suivant : </span></span>
<span id="cb8-7"><a href="conf.html#cb8-7" tabindex="-1"></a>    <span class="co"># model.Y &lt;- glm(Y ~ L1 + L2 + L3 + A1 + A2 + A1:A2, data = df,</span></span>
<span id="cb8-8"><a href="conf.html#cb8-8" tabindex="-1"></a>    <span class="co">#                family = &quot;gaussian&quot;) </span></span>
<span id="cb8-9"><a href="conf.html#cb8-9" tabindex="-1"></a>    <span class="co"># (en pratique, on ne connaît pas la nature du modèle générateur des données)</span></span>
<span id="cb8-10"><a href="conf.html#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="conf.html#cb8-11" tabindex="-1"></a><span class="do">## ii) Estimer les valeurs attendues sous les 4 scenarios contrefactuels</span></span>
<span id="cb8-12"><a href="conf.html#cb8-12" tabindex="-1"></a><span class="do">## ii.a) on crée 4 bases de données correspondant aux 4 scenarios contrefactuels</span></span>
<span id="cb8-13"><a href="conf.html#cb8-13" tabindex="-1"></a>    df.A1_0.A2_0 <span class="ot">&lt;-</span> df.A1_1.A2_0 <span class="ot">&lt;-</span> df.A1_0.A2_1 <span class="ot">&lt;-</span> df.A1_1.A2_1 <span class="ot">&lt;-</span> df</span>
<span id="cb8-14"><a href="conf.html#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="conf.html#cb8-15" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 0, A2 = 0) pour toute la population</span></span>
<span id="cb8-16"><a href="conf.html#cb8-16" tabindex="-1"></a>    df.A1_0.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> df.A1_0.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-17"><a href="conf.html#cb8-17" tabindex="-1"></a>    </span>
<span id="cb8-18"><a href="conf.html#cb8-18" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 1, A2 = 0) pour toute la population</span></span>
<span id="cb8-19"><a href="conf.html#cb8-19" tabindex="-1"></a>    df.A1_1.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-20"><a href="conf.html#cb8-20" tabindex="-1"></a>    df.A1_1.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-21"><a href="conf.html#cb8-21" tabindex="-1"></a>    </span>
<span id="cb8-22"><a href="conf.html#cb8-22" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 0, A2 = 1) pour toute la population</span></span>
<span id="cb8-23"><a href="conf.html#cb8-23" tabindex="-1"></a>    df.A1_0.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-24"><a href="conf.html#cb8-24" tabindex="-1"></a>    df.A1_0.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-25"><a href="conf.html#cb8-25" tabindex="-1"></a></span>
<span id="cb8-26"><a href="conf.html#cb8-26" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 1, A2 = 1) pour toute la population</span></span>
<span id="cb8-27"><a href="conf.html#cb8-27" tabindex="-1"></a>    df.A1_1.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> df.A1_1.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-28"><a href="conf.html#cb8-28" tabindex="-1"></a></span>
<span id="cb8-29"><a href="conf.html#cb8-29" tabindex="-1"></a><span class="do">## ii.b) on prédit le critère de jugement sous les scenarios contrefactuels</span></span>
<span id="cb8-30"><a href="conf.html#cb8-30" tabindex="-1"></a>    Qbar_00 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_0.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-31"><a href="conf.html#cb8-31" tabindex="-1"></a>    Qbar_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_1.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-32"><a href="conf.html#cb8-32" tabindex="-1"></a>    Qbar_01 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_0.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-33"><a href="conf.html#cb8-33" tabindex="-1"></a>    Qbar_11 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_1.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-34"><a href="conf.html#cb8-34" tabindex="-1"></a></span>
<span id="cb8-35"><a href="conf.html#cb8-35" tabindex="-1"></a>    </span>
<span id="cb8-36"><a href="conf.html#cb8-36" tabindex="-1"></a><span class="do">## iii) Utiliser les moyennes contrefactuelles estimées pour calculer les différents </span></span>
<span id="cb8-37"><a href="conf.html#cb8-37" tabindex="-1"></a><span class="do">##      indicateurs d&#39;intérêt pour l&#39;analyse d&#39;interaction</span></span>
<span id="cb8-38"><a href="conf.html#cb8-38" tabindex="-1"></a><span class="do">## iii.a) on va enregistrer l&#39;ensemble des résultats pertinents dans une table &#39;int.r&#39;</span></span>
<span id="cb8-39"><a href="conf.html#cb8-39" tabindex="-1"></a><span class="do">##        de longueur 2 x 2</span></span>
<span id="cb8-40"><a href="conf.html#cb8-40" tabindex="-1"></a>    int.r <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,</span>
<span id="cb8-41"><a href="conf.html#cb8-41" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">26</span>,</span>
<span id="cb8-42"><a href="conf.html#cb8-42" tabindex="-1"></a>                    <span class="at">nrow =</span> <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>A1)) <span class="sc">*</span> <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>A2)))</span>
<span id="cb8-43"><a href="conf.html#cb8-43" tabindex="-1"></a>    int.r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(int.r)</span>
<span id="cb8-44"><a href="conf.html#cb8-44" tabindex="-1"></a>    <span class="fu">names</span>(int.r) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>,<span class="st">&quot;p&quot;</span>,<span class="st">&quot;p.lo&quot;</span>,<span class="st">&quot;p.up&quot;</span>,</span>
<span id="cb8-45"><a href="conf.html#cb8-45" tabindex="-1"></a>                      <span class="st">&quot;RD.A1&quot;</span>,<span class="st">&quot;RD.A1.lo&quot;</span>,<span class="st">&quot;RD.A1.up&quot;</span>,<span class="st">&quot;RD.A2&quot;</span>,<span class="st">&quot;RD.A2.lo&quot;</span>,<span class="st">&quot;RD.A2.up&quot;</span>,</span>
<span id="cb8-46"><a href="conf.html#cb8-46" tabindex="-1"></a>                      <span class="st">&quot;RR.A1&quot;</span>,<span class="st">&quot;RR.A1.lo&quot;</span>,<span class="st">&quot;RR.A1.up&quot;</span>,<span class="st">&quot;RR.A2&quot;</span>,<span class="st">&quot;RR.A2.lo&quot;</span>,<span class="st">&quot;RR.A2.up&quot;</span>,</span>
<span id="cb8-47"><a href="conf.html#cb8-47" tabindex="-1"></a>                      <span class="st">&quot;a.INT&quot;</span>, <span class="st">&quot;a.INT.lo&quot;</span>, <span class="st">&quot;a.INT.up&quot;</span>,<span class="st">&quot;RERI&quot;</span>,<span class="st">&quot;RERI.lo&quot;</span>,<span class="st">&quot;RERI.up&quot;</span>,</span>
<span id="cb8-48"><a href="conf.html#cb8-48" tabindex="-1"></a>                      <span class="st">&quot;m.INT&quot;</span>, <span class="st">&quot;m.INT.lo&quot;</span>, <span class="st">&quot;m.INT.up&quot;</span> )</span>
<span id="cb8-49"><a href="conf.html#cb8-49" tabindex="-1"></a>    int.r[,<span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb8-50"><a href="conf.html#cb8-50" tabindex="-1"></a></span>
<span id="cb8-51"><a href="conf.html#cb8-51" tabindex="-1"></a><span class="do">## iii.b) Les moyennes marginales pour chaque case du tableau d’interaction</span></span>
<span id="cb8-52"><a href="conf.html#cb8-52" tabindex="-1"></a><span class="co"># dans chaque case de la table 2 x 2</span></span>
<span id="cb8-53"><a href="conf.html#cb8-53" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb8-54"><a href="conf.html#cb8-54" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-55"><a href="conf.html#cb8-55" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb8-56"><a href="conf.html#cb8-56" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-57"><a href="conf.html#cb8-57" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb8-58"><a href="conf.html#cb8-58" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-59"><a href="conf.html#cb8-59" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb8-60"><a href="conf.html#cb8-60" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11)</span>
<span id="cb8-61"><a href="conf.html#cb8-61" tabindex="-1"></a></span>
<span id="cb8-62"><a href="conf.html#cb8-62" tabindex="-1"></a><span class="do">## iii.c) Les différences de risques marginales</span></span>
<span id="cb8-63"><a href="conf.html#cb8-63" tabindex="-1"></a>    <span class="co"># RD.A1.A2is0</span></span>
<span id="cb8-64"><a href="conf.html#cb8-64" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-65"><a href="conf.html#cb8-65" tabindex="-1"></a>    <span class="co"># RD.A1.A2is1</span></span>
<span id="cb8-66"><a href="conf.html#cb8-66" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-67"><a href="conf.html#cb8-67" tabindex="-1"></a>    <span class="co"># RD.A2.A1is0</span></span>
<span id="cb8-68"><a href="conf.html#cb8-68" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-69"><a href="conf.html#cb8-69" tabindex="-1"></a>    <span class="co"># RD.A2.A1is1</span></span>
<span id="cb8-70"><a href="conf.html#cb8-70" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-71"><a href="conf.html#cb8-71" tabindex="-1"></a></span>
<span id="cb8-72"><a href="conf.html#cb8-72" tabindex="-1"></a><span class="do">## iii.d) Les risques relatifs marginaux</span></span>
<span id="cb8-73"><a href="conf.html#cb8-73" tabindex="-1"></a>    <span class="co"># RR.A1.A2is0</span></span>
<span id="cb8-74"><a href="conf.html#cb8-74" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-75"><a href="conf.html#cb8-75" tabindex="-1"></a>    <span class="co"># RR.A1.A2is1</span></span>
<span id="cb8-76"><a href="conf.html#cb8-76" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-77"><a href="conf.html#cb8-77" tabindex="-1"></a>    <span class="co"># RR.A2.A1is0</span></span>
<span id="cb8-78"><a href="conf.html#cb8-78" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-79"><a href="conf.html#cb8-79" tabindex="-1"></a>    <span class="co"># RR.A2.A1is1</span></span>
<span id="cb8-80"><a href="conf.html#cb8-80" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-81"><a href="conf.html#cb8-81" tabindex="-1"></a></span>
<span id="cb8-82"><a href="conf.html#cb8-82" tabindex="-1"></a><span class="do">## iii.e) Les mesures d&#39;interaction</span></span>
<span id="cb8-83"><a href="conf.html#cb8-83" tabindex="-1"></a>    <span class="co"># additive interaction</span></span>
<span id="cb8-84"><a href="conf.html#cb8-84" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-85"><a href="conf.html#cb8-85" tabindex="-1"></a>                                                  <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span></span>
<span id="cb8-86"><a href="conf.html#cb8-86" tabindex="-1"></a>                                                  <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span></span>
<span id="cb8-87"><a href="conf.html#cb8-87" tabindex="-1"></a>                                                  <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-88"><a href="conf.html#cb8-88" tabindex="-1"></a>    <span class="co"># RERI</span></span>
<span id="cb8-89"><a href="conf.html#cb8-89" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-90"><a href="conf.html#cb8-90" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span></span>
<span id="cb8-91"><a href="conf.html#cb8-91" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span></span>
<span id="cb8-92"><a href="conf.html#cb8-92" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_00)) <span class="sc">/</span></span>
<span id="cb8-93"><a href="conf.html#cb8-93" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-94"><a href="conf.html#cb8-94" tabindex="-1"></a>    <span class="co"># multiplicative interaction</span></span>
<span id="cb8-95"><a href="conf.html#cb8-95" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(Qbar_11) <span class="sc">*</span></span>
<span id="cb8-96"><a href="conf.html#cb8-96" tabindex="-1"></a>                                                   <span class="fu">mean</span>(Qbar_00)) <span class="sc">/</span></span>
<span id="cb8-97"><a href="conf.html#cb8-97" tabindex="-1"></a>                                                   (<span class="fu">mean</span>(Qbar_10) <span class="sc">*</span></span>
<span id="cb8-98"><a href="conf.html#cb8-98" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_01))</span>
<span id="cb8-99"><a href="conf.html#cb8-99" tabindex="-1"></a></span>
<span id="cb8-100"><a href="conf.html#cb8-100" tabindex="-1"></a></span>
<span id="cb8-101"><a href="conf.html#cb8-101" tabindex="-1"></a><span class="do">## iii.f) Calcul des intervalles de confiance </span></span>
<span id="cb8-102"><a href="conf.html#cb8-102" tabindex="-1"></a>    <span class="co"># Le script ci-dessous présente une méthode de bootstrap </span></span>
<span id="cb8-103"><a href="conf.html#cb8-103" tabindex="-1"></a>    <span class="co"># pour calculer les intervalles de confiance à 95% des différents indicateurs</span></span>
<span id="cb8-104"><a href="conf.html#cb8-104" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">5678</span>)</span>
<span id="cb8-105"><a href="conf.html#cb8-105" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># on utilise 1000 échantillons boostrap dans cet exemple</span></span>
<span id="cb8-106"><a href="conf.html#cb8-106" tabindex="-1"></a>    bootstrap.est <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> B, <span class="at">ncol =</span> <span class="dv">15</span>))</span>
<span id="cb8-107"><a href="conf.html#cb8-107" tabindex="-1"></a>    <span class="fu">colnames</span>(bootstrap.est) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p.A1is0.A2is0&quot;</span>, <span class="st">&quot;p.A1is1.A2is0&quot;</span>, </span>
<span id="cb8-108"><a href="conf.html#cb8-108" tabindex="-1"></a>                                 <span class="st">&quot;p.A1is0.A2is1&quot;</span>, <span class="st">&quot;p.A1is1.A2is1&quot;</span>,</span>
<span id="cb8-109"><a href="conf.html#cb8-109" tabindex="-1"></a>                                 <span class="st">&quot;RD.A1.A2is0&quot;</span>, <span class="st">&quot;RD.A1.A2is1&quot;</span>, </span>
<span id="cb8-110"><a href="conf.html#cb8-110" tabindex="-1"></a>                                 <span class="st">&quot;RD.A2.A1is0&quot;</span>, <span class="st">&quot;RD.A2.A1is1&quot;</span>,</span>
<span id="cb8-111"><a href="conf.html#cb8-111" tabindex="-1"></a>                                 <span class="st">&quot;lnRR.A1.A2is0&quot;</span>, <span class="st">&quot;lnRR.A1.A2is1&quot;</span>, </span>
<span id="cb8-112"><a href="conf.html#cb8-112" tabindex="-1"></a>                                 <span class="st">&quot;lnRR.A2.A1is0&quot;</span>, <span class="st">&quot;lnRR.A2.A1is1&quot;</span>,</span>
<span id="cb8-113"><a href="conf.html#cb8-113" tabindex="-1"></a>                                 <span class="st">&quot;INT.a&quot;</span>, <span class="st">&quot;lnRERI&quot;</span>, <span class="st">&quot;lnINT.m&quot;</span>)</span>
<span id="cb8-114"><a href="conf.html#cb8-114" tabindex="-1"></a></span>
<span id="cb8-115"><a href="conf.html#cb8-115" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){ <span class="co"># on refait toute l&#39;analyse dans chaque échantillon bootstrap</span></span>
<span id="cb8-116"><a href="conf.html#cb8-116" tabindex="-1"></a>      <span class="co"># constituer un échantillon bootstrap (échantillonnage avec remise)</span></span>
<span id="cb8-117"><a href="conf.html#cb8-117" tabindex="-1"></a>      bootIndices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df), <span class="at">replace=</span>T)</span>
<span id="cb8-118"><a href="conf.html#cb8-118" tabindex="-1"></a>      bootData <span class="ot">&lt;-</span> df[bootIndices,]</span>
<span id="cb8-119"><a href="conf.html#cb8-119" tabindex="-1"></a></span>
<span id="cb8-120"><a href="conf.html#cb8-120" tabindex="-1"></a>      <span class="cf">if</span> ( <span class="fu">round</span>(b<span class="sc">/</span><span class="dv">100</span>, <span class="dv">0</span>) <span class="sc">==</span> b<span class="sc">/</span><span class="dv">100</span> ) <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;bootstrap number &quot;</span>,b))</span>
<span id="cb8-121"><a href="conf.html#cb8-121" tabindex="-1"></a></span>
<span id="cb8-122"><a href="conf.html#cb8-122" tabindex="-1"></a>      <span class="co"># étape (i) de modélisation du critère de jugement</span></span>
<span id="cb8-123"><a href="conf.html#cb8-123" tabindex="-1"></a>      model.Y <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> L1 <span class="sc">+</span> L2 <span class="sc">+</span> L3 <span class="sc">+</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2,</span>
<span id="cb8-124"><a href="conf.html#cb8-124" tabindex="-1"></a>                     <span class="at">data =</span> bootData,                    <span class="co"># use BootData here +++</span></span>
<span id="cb8-125"><a href="conf.html#cb8-125" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb8-126"><a href="conf.html#cb8-126" tabindex="-1"></a></span>
<span id="cb8-127"><a href="conf.html#cb8-127" tabindex="-1"></a>      <span class="co"># étape (ii) d&#39;estimation des valeurs attendus sous les 4 scénarios contrefactuels</span></span>
<span id="cb8-128"><a href="conf.html#cb8-128" tabindex="-1"></a>      boot.A1_0.A2_0 <span class="ot">&lt;-</span> boot.A1_1.A2_0 <span class="ot">&lt;-</span> boot.A1_0.A2_1 <span class="ot">&lt;-</span> boot.A1_1.A2_1 <span class="ot">&lt;-</span> bootData</span>
<span id="cb8-129"><a href="conf.html#cb8-129" tabindex="-1"></a>      boot.A1_0.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> boot.A1_0.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-130"><a href="conf.html#cb8-130" tabindex="-1"></a>      boot.A1_1.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-131"><a href="conf.html#cb8-131" tabindex="-1"></a>      boot.A1_1.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-132"><a href="conf.html#cb8-132" tabindex="-1"></a>      boot.A1_0.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-133"><a href="conf.html#cb8-133" tabindex="-1"></a>      boot.A1_0.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-134"><a href="conf.html#cb8-134" tabindex="-1"></a>      boot.A1_1.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> boot.A1_1.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-135"><a href="conf.html#cb8-135" tabindex="-1"></a></span>
<span id="cb8-136"><a href="conf.html#cb8-136" tabindex="-1"></a>      <span class="co"># prédire les résultats contrefactuels sous les différents scénarios</span></span>
<span id="cb8-137"><a href="conf.html#cb8-137" tabindex="-1"></a>      Qbar_00 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_0.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-138"><a href="conf.html#cb8-138" tabindex="-1"></a>      Qbar_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_1.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-139"><a href="conf.html#cb8-139" tabindex="-1"></a>      Qbar_01 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_0.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-140"><a href="conf.html#cb8-140" tabindex="-1"></a>      Qbar_11 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_1.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-141"><a href="conf.html#cb8-141" tabindex="-1"></a></span>
<span id="cb8-142"><a href="conf.html#cb8-142" tabindex="-1"></a>      <span class="co"># étape (iii) de calcul des différents indicateurs d&#39;intérêt</span></span>
<span id="cb8-143"><a href="conf.html#cb8-143" tabindex="-1"></a>      <span class="co"># on sauve les résultats dans la table bootstrap.est</span></span>
<span id="cb8-144"><a href="conf.html#cb8-144" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is0.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-145"><a href="conf.html#cb8-145" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is1.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-146"><a href="conf.html#cb8-146" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is0.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-147"><a href="conf.html#cb8-147" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is1.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11)</span>
<span id="cb8-148"><a href="conf.html#cb8-148" tabindex="-1"></a></span>
<span id="cb8-149"><a href="conf.html#cb8-149" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A1.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-150"><a href="conf.html#cb8-150" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A1.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-151"><a href="conf.html#cb8-151" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A2.A1is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-152"><a href="conf.html#cb8-152" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A2.A1is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-153"><a href="conf.html#cb8-153" tabindex="-1"></a>      </span>
<span id="cb8-154"><a href="conf.html#cb8-154" tabindex="-1"></a>      <span class="co"># les Ic95% des RR sont d&#39;abord calculés sur une échelle logarithmique</span></span>
<span id="cb8-155"><a href="conf.html#cb8-155" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A1.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_10) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-156"><a href="conf.html#cb8-156" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A1.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_01))</span>
<span id="cb8-157"><a href="conf.html#cb8-157" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A2.A1is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_01) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-158"><a href="conf.html#cb8-158" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A2.A1is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_10))</span>
<span id="cb8-159"><a href="conf.html#cb8-159" tabindex="-1"></a></span>
<span id="cb8-160"><a href="conf.html#cb8-160" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;INT.a&quot;</span>] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-161"><a href="conf.html#cb8-161" tabindex="-1"></a>                                     <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-162"><a href="conf.html#cb8-162" tabindex="-1"></a>      <span class="co"># les IC95% du RERI et de l&#39;interaction multiplicative sont d&#39;abord calculés</span></span>
<span id="cb8-163"><a href="conf.html#cb8-163" tabindex="-1"></a>      <span class="co"># sur une échelle logarithmique</span></span>
<span id="cb8-164"><a href="conf.html#cb8-164" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRERI&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>((<span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-165"><a href="conf.html#cb8-165" tabindex="-1"></a>                                          <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span> <span class="fu">mean</span>(Qbar_00)) </span>
<span id="cb8-166"><a href="conf.html#cb8-166" tabindex="-1"></a>                                       <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-167"><a href="conf.html#cb8-167" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnINT.m&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>((<span class="fu">mean</span>(Qbar_11) <span class="sc">*</span> <span class="fu">mean</span>(Qbar_00)) <span class="sc">/</span> </span>
<span id="cb8-168"><a href="conf.html#cb8-168" tabindex="-1"></a>                                           (<span class="fu">mean</span>(Qbar_10) <span class="sc">*</span> <span class="fu">mean</span>(Qbar_01)))</span>
<span id="cb8-169"><a href="conf.html#cb8-169" tabindex="-1"></a>    }</span>
<span id="cb8-170"><a href="conf.html#cb8-170" tabindex="-1"></a>    </span>
<span id="cb8-171"><a href="conf.html#cb8-171" tabindex="-1"></a>    <span class="do">## On peut vérifier la normalité des distributions bootstrap avec le script </span></span>
<span id="cb8-172"><a href="conf.html#cb8-172" tabindex="-1"></a>    <span class="do">## proposé en commentaire ci-dessous :</span></span>
<span id="cb8-173"><a href="conf.html#cb8-173" tabindex="-1"></a>    </span>
<span id="cb8-174"><a href="conf.html#cb8-174" tabindex="-1"></a>    <span class="co"># par(mfrow = c(4,4))</span></span>
<span id="cb8-175"><a href="conf.html#cb8-175" tabindex="-1"></a>    <span class="co"># for(c in 1:ncol(bootstrap.est)) {</span></span>
<span id="cb8-176"><a href="conf.html#cb8-176" tabindex="-1"></a>    <span class="co">#   hist(bootstrap.est[,c], freq = FALSE, main = names(bootstrap.est)[c])</span></span>
<span id="cb8-177"><a href="conf.html#cb8-177" tabindex="-1"></a>    <span class="co">#   lines(density(bootstrap.est[,c]), col = 2, lwd = 3)</span></span>
<span id="cb8-178"><a href="conf.html#cb8-178" tabindex="-1"></a>    <span class="co">#   curve(1/sqrt(var(bootstrap.est[,c]) * 2 * pi) *</span></span>
<span id="cb8-179"><a href="conf.html#cb8-179" tabindex="-1"></a>    <span class="co">#           exp(-1/2 * ((x-mean(bootstrap.est[,c])) / sd(bootstrap.est[,c]))^2),</span></span>
<span id="cb8-180"><a href="conf.html#cb8-180" tabindex="-1"></a>    <span class="co">#         col = 1, lwd = 2, lty = 2, add = TRUE)</span></span>
<span id="cb8-181"><a href="conf.html#cb8-181" tabindex="-1"></a>    <span class="co"># par(mfrow = c(1,1))</span></span>
<span id="cb8-182"><a href="conf.html#cb8-182" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb8-183"><a href="conf.html#cb8-183" tabindex="-1"></a>    </span>
<span id="cb8-184"><a href="conf.html#cb8-184" tabindex="-1"></a>    <span class="co"># Les distributions ont bien une allure normale, on peut donc utiliser la </span></span>
<span id="cb8-185"><a href="conf.html#cb8-185" tabindex="-1"></a>    <span class="co"># déviation standard des distributions pour calculer les IC95%.</span></span>
<span id="cb8-186"><a href="conf.html#cb8-186" tabindex="-1"></a>    <span class="co"># En cas de distributions asymétriques, il serait préférable d&#39;utiliser les </span></span>
<span id="cb8-187"><a href="conf.html#cb8-187" tabindex="-1"></a>    <span class="co"># percentiles 2.5% et 97.5% (ou un méthode bootstrap BCa)</span></span>
<span id="cb8-188"><a href="conf.html#cb8-188" tabindex="-1"></a></span>
<span id="cb8-189"><a href="conf.html#cb8-189" tabindex="-1"></a><span class="do">## on calcule les IC95% et on les intègre dans la table de synthèse &#39;int.r&#39;</span></span>
<span id="cb8-190"><a href="conf.html#cb8-190" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb8-191"><a href="conf.html#cb8-191" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb8-192"><a href="conf.html#cb8-192" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is0)</span>
<span id="cb8-193"><a href="conf.html#cb8-193" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb8-194"><a href="conf.html#cb8-194" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is0)</span>
<span id="cb8-195"><a href="conf.html#cb8-195" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb8-196"><a href="conf.html#cb8-196" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb8-197"><a href="conf.html#cb8-197" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is0)</span>
<span id="cb8-198"><a href="conf.html#cb8-198" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb8-199"><a href="conf.html#cb8-199" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is0)</span>
<span id="cb8-200"><a href="conf.html#cb8-200" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb8-201"><a href="conf.html#cb8-201" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-202"><a href="conf.html#cb8-202" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is1)</span>
<span id="cb8-203"><a href="conf.html#cb8-203" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-204"><a href="conf.html#cb8-204" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is1)</span>
<span id="cb8-205"><a href="conf.html#cb8-205" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb8-206"><a href="conf.html#cb8-206" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-207"><a href="conf.html#cb8-207" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is1)</span>
<span id="cb8-208"><a href="conf.html#cb8-208" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-209"><a href="conf.html#cb8-209" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is1)</span>
<span id="cb8-210"><a href="conf.html#cb8-210" tabindex="-1"></a></span>
<span id="cb8-211"><a href="conf.html#cb8-211" tabindex="-1"></a><span class="co"># risk difference</span></span>
<span id="cb8-212"><a href="conf.html#cb8-212" tabindex="-1"></a>    <span class="co"># RD.A1.A2is0</span></span>
<span id="cb8-213"><a href="conf.html#cb8-213" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-214"><a href="conf.html#cb8-214" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb8-215"><a href="conf.html#cb8-215" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is0))</span>
<span id="cb8-216"><a href="conf.html#cb8-216" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-217"><a href="conf.html#cb8-217" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb8-218"><a href="conf.html#cb8-218" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is0))</span>
<span id="cb8-219"><a href="conf.html#cb8-219" tabindex="-1"></a>    <span class="co"># RD.A1.A2is1</span></span>
<span id="cb8-220"><a href="conf.html#cb8-220" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-221"><a href="conf.html#cb8-221" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-222"><a href="conf.html#cb8-222" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is1))</span>
<span id="cb8-223"><a href="conf.html#cb8-223" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-224"><a href="conf.html#cb8-224" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-225"><a href="conf.html#cb8-225" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is1))</span>
<span id="cb8-226"><a href="conf.html#cb8-226" tabindex="-1"></a>    <span class="co"># RD.A2.A1is0</span></span>
<span id="cb8-227"><a href="conf.html#cb8-227" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-228"><a href="conf.html#cb8-228" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-229"><a href="conf.html#cb8-229" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is0))</span>
<span id="cb8-230"><a href="conf.html#cb8-230" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-231"><a href="conf.html#cb8-231" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-232"><a href="conf.html#cb8-232" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is0))</span>
<span id="cb8-233"><a href="conf.html#cb8-233" tabindex="-1"></a>    <span class="co"># RD.A2.A1is1</span></span>
<span id="cb8-234"><a href="conf.html#cb8-234" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-235"><a href="conf.html#cb8-235" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-236"><a href="conf.html#cb8-236" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is1))</span>
<span id="cb8-237"><a href="conf.html#cb8-237" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-238"><a href="conf.html#cb8-238" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-239"><a href="conf.html#cb8-239" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is1))</span>
<span id="cb8-240"><a href="conf.html#cb8-240" tabindex="-1"></a></span>
<span id="cb8-241"><a href="conf.html#cb8-241" tabindex="-1"></a><span class="co"># relative risk</span></span>
<span id="cb8-242"><a href="conf.html#cb8-242" tabindex="-1"></a>    <span class="co"># RR.A1.A2is0</span></span>
<span id="cb8-243"><a href="conf.html#cb8-243" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-244"><a href="conf.html#cb8-244" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb8-245"><a href="conf.html#cb8-245" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-246"><a href="conf.html#cb8-246" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is0))</span>
<span id="cb8-247"><a href="conf.html#cb8-247" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-248"><a href="conf.html#cb8-248" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">+</span></span>
<span id="cb8-249"><a href="conf.html#cb8-249" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-250"><a href="conf.html#cb8-250" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is0))</span>
<span id="cb8-251"><a href="conf.html#cb8-251" tabindex="-1"></a>    <span class="co"># RR.A1.A2is1</span></span>
<span id="cb8-252"><a href="conf.html#cb8-252" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-253"><a href="conf.html#cb8-253" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-254"><a href="conf.html#cb8-254" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-255"><a href="conf.html#cb8-255" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is1))</span>
<span id="cb8-256"><a href="conf.html#cb8-256" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-257"><a href="conf.html#cb8-257" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-258"><a href="conf.html#cb8-258" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-259"><a href="conf.html#cb8-259" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is1))</span>
<span id="cb8-260"><a href="conf.html#cb8-260" tabindex="-1"></a>    <span class="co"># RR.A2.A1is0</span></span>
<span id="cb8-261"><a href="conf.html#cb8-261" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-262"><a href="conf.html#cb8-262" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-263"><a href="conf.html#cb8-263" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-264"><a href="conf.html#cb8-264" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is0))</span>
<span id="cb8-265"><a href="conf.html#cb8-265" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-266"><a href="conf.html#cb8-266" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-267"><a href="conf.html#cb8-267" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-268"><a href="conf.html#cb8-268" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is0))</span>
<span id="cb8-269"><a href="conf.html#cb8-269" tabindex="-1"></a>    <span class="co"># RR.A2.A1is1</span></span>
<span id="cb8-270"><a href="conf.html#cb8-270" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-271"><a href="conf.html#cb8-271" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-272"><a href="conf.html#cb8-272" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-273"><a href="conf.html#cb8-273" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is1))</span>
<span id="cb8-274"><a href="conf.html#cb8-274" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-275"><a href="conf.html#cb8-275" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-276"><a href="conf.html#cb8-276" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-277"><a href="conf.html#cb8-277" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is1))</span>
<span id="cb8-278"><a href="conf.html#cb8-278" tabindex="-1"></a></span>
<span id="cb8-279"><a href="conf.html#cb8-279" tabindex="-1"></a><span class="co"># additive interaction</span></span>
<span id="cb8-280"><a href="conf.html#cb8-280" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-281"><a href="conf.html#cb8-281" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-282"><a href="conf.html#cb8-282" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>INT.a))</span>
<span id="cb8-283"><a href="conf.html#cb8-283" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-284"><a href="conf.html#cb8-284" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-285"><a href="conf.html#cb8-285" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>INT.a))</span>
<span id="cb8-286"><a href="conf.html#cb8-286" tabindex="-1"></a><span class="co"># RERI</span></span>
<span id="cb8-287"><a href="conf.html#cb8-287" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-288"><a href="conf.html#cb8-288" tabindex="-1"></a>                    int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-289"><a href="conf.html#cb8-289" tabindex="-1"></a>                                            <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRERI))</span>
<span id="cb8-290"><a href="conf.html#cb8-290" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-291"><a href="conf.html#cb8-291" tabindex="-1"></a>                    int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-292"><a href="conf.html#cb8-292" tabindex="-1"></a>                                            <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRERI))</span>
<span id="cb8-293"><a href="conf.html#cb8-293" tabindex="-1"></a><span class="co"># multiplicative interaction</span></span>
<span id="cb8-294"><a href="conf.html#cb8-294" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-295"><a href="conf.html#cb8-295" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-296"><a href="conf.html#cb8-296" tabindex="-1"></a>                                             <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnINT.m))</span>
<span id="cb8-297"><a href="conf.html#cb8-297" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-298"><a href="conf.html#cb8-298" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-299"><a href="conf.html#cb8-299" tabindex="-1"></a>                                             <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnINT.m))</span></code></pre></div>
<p>Au final, on a :</p>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="conf.html#cb9-1" tabindex="-1"></a><span class="do">## On peut présenter les différents résultats dans un tableau des effets marginaux</span></span>
<span id="cb9-2"><a href="conf.html#cb9-2" tabindex="-1"></a>    out.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">c1 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>), <span class="at">c2 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>), <span class="at">c3 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>), <span class="at">c4 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb9-3"><a href="conf.html#cb9-3" tabindex="-1"></a>    <span class="fu">names</span>(out.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A2=0&quot;</span>, <span class="st">&quot;A2=1&quot;</span>, <span class="st">&quot;RD.A2|A1&quot;</span>, <span class="st">&quot;RR.A2|A1&quot;</span>)</span>
<span id="cb9-4"><a href="conf.html#cb9-4" tabindex="-1"></a>    <span class="fu">rownames</span>(out.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1=0&quot;</span>, <span class="st">&quot;A1=1&quot;</span>, <span class="st">&quot;RD.A1|A2&quot;</span>, <span class="st">&quot;RR.A1|A2&quot;</span>)</span>
<span id="cb9-5"><a href="conf.html#cb9-5" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb9-6"><a href="conf.html#cb9-6" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{00}$=&quot;</span>,</span>
<span id="cb9-7"><a href="conf.html#cb9-7" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-8"><a href="conf.html#cb9-8" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-9"><a href="conf.html#cb9-9" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-10"><a href="conf.html#cb9-10" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-11"><a href="conf.html#cb9-11" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-12"><a href="conf.html#cb9-12" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-13"><a href="conf.html#cb9-13" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{01}$=&quot;</span>,<span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-14"><a href="conf.html#cb9-14" tabindex="-1"></a>                                                                         int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-15"><a href="conf.html#cb9-15" tabindex="-1"></a>                                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-16"><a href="conf.html#cb9-16" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-17"><a href="conf.html#cb9-17" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-18"><a href="conf.html#cb9-18" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-19"><a href="conf.html#cb9-19" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-20"><a href="conf.html#cb9-20" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{10}$=&quot;</span>,<span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-21"><a href="conf.html#cb9-21" tabindex="-1"></a>                                                                         int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-22"><a href="conf.html#cb9-22" tabindex="-1"></a>                                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-23"><a href="conf.html#cb9-23" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-24"><a href="conf.html#cb9-24" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-25"><a href="conf.html#cb9-25" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-26"><a href="conf.html#cb9-26" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-27"><a href="conf.html#cb9-27" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{11}$=&quot;</span>,<span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-28"><a href="conf.html#cb9-28" tabindex="-1"></a>                                                                         int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-29"><a href="conf.html#cb9-29" tabindex="-1"></a>                                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-30"><a href="conf.html#cb9-30" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-31"><a href="conf.html#cb9-31" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-32"><a href="conf.html#cb9-32" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-33"><a href="conf.html#cb9-33" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-34"><a href="conf.html#cb9-34" tabindex="-1"></a><span class="co"># RD</span></span>
<span id="cb9-35"><a href="conf.html#cb9-35" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;RD.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-36"><a href="conf.html#cb9-36" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-37"><a href="conf.html#cb9-37" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-38"><a href="conf.html#cb9-38" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-39"><a href="conf.html#cb9-39" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-40"><a href="conf.html#cb9-40" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-41"><a href="conf.html#cb9-41" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-42"><a href="conf.html#cb9-42" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-43"><a href="conf.html#cb9-43" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-44"><a href="conf.html#cb9-44" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;RD.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-45"><a href="conf.html#cb9-45" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-46"><a href="conf.html#cb9-46" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-47"><a href="conf.html#cb9-47" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-48"><a href="conf.html#cb9-48" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-49"><a href="conf.html#cb9-49" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-50"><a href="conf.html#cb9-50" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-51"><a href="conf.html#cb9-51" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-52"><a href="conf.html#cb9-52" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-53"><a href="conf.html#cb9-53" tabindex="-1"></a>    out.table[<span class="st">&quot;RD.A1|A2&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-54"><a href="conf.html#cb9-54" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-55"><a href="conf.html#cb9-55" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-56"><a href="conf.html#cb9-56" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-57"><a href="conf.html#cb9-57" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-58"><a href="conf.html#cb9-58" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-59"><a href="conf.html#cb9-59" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-60"><a href="conf.html#cb9-60" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-61"><a href="conf.html#cb9-61" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-62"><a href="conf.html#cb9-62" tabindex="-1"></a>    out.table[<span class="st">&quot;RD.A1|A2&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-63"><a href="conf.html#cb9-63" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-64"><a href="conf.html#cb9-64" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-65"><a href="conf.html#cb9-65" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-66"><a href="conf.html#cb9-66" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-67"><a href="conf.html#cb9-67" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-68"><a href="conf.html#cb9-68" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-69"><a href="conf.html#cb9-69" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-70"><a href="conf.html#cb9-70" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-71"><a href="conf.html#cb9-71" tabindex="-1"></a></span>
<span id="cb9-72"><a href="conf.html#cb9-72" tabindex="-1"></a><span class="co"># RR</span></span>
<span id="cb9-73"><a href="conf.html#cb9-73" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;RR.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-74"><a href="conf.html#cb9-74" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-75"><a href="conf.html#cb9-75" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-76"><a href="conf.html#cb9-76" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-77"><a href="conf.html#cb9-77" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-78"><a href="conf.html#cb9-78" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-79"><a href="conf.html#cb9-79" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-80"><a href="conf.html#cb9-80" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-81"><a href="conf.html#cb9-81" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-82"><a href="conf.html#cb9-82" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;RR.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-83"><a href="conf.html#cb9-83" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-84"><a href="conf.html#cb9-84" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-85"><a href="conf.html#cb9-85" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-86"><a href="conf.html#cb9-86" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-87"><a href="conf.html#cb9-87" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-88"><a href="conf.html#cb9-88" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-89"><a href="conf.html#cb9-89" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-90"><a href="conf.html#cb9-90" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-91"><a href="conf.html#cb9-91" tabindex="-1"></a>    out.table[<span class="st">&quot;RR.A1|A2&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-92"><a href="conf.html#cb9-92" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-93"><a href="conf.html#cb9-93" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-94"><a href="conf.html#cb9-94" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-95"><a href="conf.html#cb9-95" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-96"><a href="conf.html#cb9-96" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-97"><a href="conf.html#cb9-97" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-98"><a href="conf.html#cb9-98" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-99"><a href="conf.html#cb9-99" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-100"><a href="conf.html#cb9-100" tabindex="-1"></a>    out.table[<span class="st">&quot;RR.A1|A2&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-101"><a href="conf.html#cb9-101" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-102"><a href="conf.html#cb9-102" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-103"><a href="conf.html#cb9-103" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-104"><a href="conf.html#cb9-104" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-105"><a href="conf.html#cb9-105" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-106"><a href="conf.html#cb9-106" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-107"><a href="conf.html#cb9-107" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-108"><a href="conf.html#cb9-108" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-109"><a href="conf.html#cb9-109" tabindex="-1"></a>    interaction.effects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;additive Interaction = &quot;</span>,</span>
<span id="cb9-110"><a href="conf.html#cb9-110" tabindex="-1"></a>                                   <span class="fu">round</span>(int.r<span class="sc">$</span>a.INT[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-111"><a href="conf.html#cb9-111" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-112"><a href="conf.html#cb9-112" tabindex="-1"></a>                                   <span class="fu">round</span>(int.r<span class="sc">$</span>a.INT.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-113"><a href="conf.html#cb9-113" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;;&quot;</span>,</span>
<span id="cb9-114"><a href="conf.html#cb9-114" tabindex="-1"></a>                                   <span class="fu">round</span>(int.r<span class="sc">$</span>a.INT.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-115"><a href="conf.html#cb9-115" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb9-116"><a href="conf.html#cb9-116" tabindex="-1"></a>                              <span class="fu">paste0</span>(<span class="st">&quot;RERI = &quot;</span>,</span>
<span id="cb9-117"><a href="conf.html#cb9-117" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>RERI[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-118"><a href="conf.html#cb9-118" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-119"><a href="conf.html#cb9-119" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>RERI.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-120"><a href="conf.html#cb9-120" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;;&quot;</span>,</span>
<span id="cb9-121"><a href="conf.html#cb9-121" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>RERI.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-122"><a href="conf.html#cb9-122" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb9-123"><a href="conf.html#cb9-123" tabindex="-1"></a>                              <span class="fu">paste0</span>(<span class="st">&quot;multiplicative Interaction = &quot;</span>,</span>
<span id="cb9-124"><a href="conf.html#cb9-124" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>m.INT[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-125"><a href="conf.html#cb9-125" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-126"><a href="conf.html#cb9-126" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>m.INT.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-127"><a href="conf.html#cb9-127" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;;&quot;</span>,</span>
<span id="cb9-128"><a href="conf.html#cb9-128" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>m.INT.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-129"><a href="conf.html#cb9-129" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>))</span>
<span id="cb9-130"><a href="conf.html#cb9-130" tabindex="-1"></a></span>
<span id="cb9-131"><a href="conf.html#cb9-131" tabindex="-1"></a>    <span class="fu">library</span>(kableExtra)</span>
<span id="cb9-132"><a href="conf.html#cb9-132" tabindex="-1"></a>    <span class="fu">kbl</span>(out.table) <span class="sc">%&gt;%</span></span>
<span id="cb9-133"><a href="conf.html#cb9-133" tabindex="-1"></a>      <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-134"><a href="conf.html#cb9-134" tabindex="-1"></a>      <span class="fu">footnote</span>(<span class="at">general =</span> interaction.effects)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A2=0
</th>
<th style="text-align:left;">
A2=1
</th>
<th style="text-align:left;">
RD.A2|A1
</th>
<th style="text-align:left;">
RR.A2|A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1=0
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{00}\)</span>=0.104 [0.094,0.113]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{01}\)</span>=0.197 [0.182,0.212]
</td>
<td style="text-align:left;">
0.093 [0.076,0.11]
</td>
<td style="text-align:left;">
1.9 [1.7,2.13]
</td>
</tr>
<tr>
<td style="text-align:left;">
A1=1
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{10}\)</span>=0.4 [0.373,0.427]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{11}\)</span>=0.893 [0.872,0.915]
</td>
<td style="text-align:left;">
0.494 [0.46,0.527]
</td>
<td style="text-align:left;">
2.23 [2.08,2.4]
</td>
</tr>
<tr>
<td style="text-align:left;">
RD.A1|A2
</td>
<td style="text-align:left;">
0.296 [0.268,0.325]
</td>
<td style="text-align:left;">
0.697 [0.67,0.723]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
RR.A1|A2
</td>
<td style="text-align:left;">
3.86 [3.44,4.33]
</td>
<td style="text-align:left;">
4.54 [4.19,4.91]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> additive Interaction = 0.4 [0.362;0.438]
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> RERI = 3.86 [3.45;4.33]
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> multiplicative Interaction = 1.18 [1.03;1.34]
</td>
</tr>
</tfoot>
</table>
</div>
<div id="estimation-par-modèle-structurel-marginal" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Estimation par Modèle Structurel Marginal<a href="conf.html#estimation-par-modèle-structurel-marginal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Les différentes quantités causales d’intérêt dans une analyse d’interaction peuvent être définies à partir des paramètres d’un modèle structurel marginal (<em>marginal structural model</em>, noté MSM).</p>
<p>Un modèle structurel marginal est un modèle qui permet de synthétiser le lien entre les potential outcomes (critères de jugement contrefactuels) et les différentes variables d’exposition d’intérêt. Ils sont particulièrement utiles dès que l’exposition a une dimensionnalité qui est plus grande que la dimensionnalité d’une variable binaire (par exemple si l’exposition est une variable quantitative continue, ou lorsqu’il existe plusieurs variables d’exposition à prendre en compte, comme dans les analyses de la médiation ou les expositions longitudinales répétées dans le temps).</p>
<p>Dans l’analyse d’interaction entre deux variables binaires, on s’intéresse à 4 niveaux d’exposition <span class="math inline">\(\{A_1 = 0, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 1, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 0, A_2 = 1\}\)</span> et <span class="math inline">\(\{A_1 = 1, A_2 = 1\}\)</span>. On peut synthétiser les liens entre le potential outcome <span class="math inline">\(Y_{A_1,A_2}\)</span> et les deux variables d’exposition à l’aide du MSM suivant, défini à partir de 4 paramètres <span class="math inline">\(\beta\)</span> :
<span class="math display" id="eq:MSMinteraction">\[\begin{equation}
  \mathbb{E}(Y_{A_1,A_2}) = \beta_0 + \beta_1 A_1 + \beta_2 A_2 + \beta_3 (A_1 \times A_2) \tag{10.1}
\end{equation}\]</span></p>
<p>On peut redéfinir nos quantités d’intérêt pour l’analyse d’interaction en fonction des paramètres de ce modèles structurel marginal :</p>
<ul>
<li><p>Les moyennes marginales pour chaque case du tableau d’interaction
<span class="math display">\[\begin{align*}
p_{00} &amp;= \beta_0 \\
p_{10} &amp;= \beta_0 + \beta_1 \\
p_{01} &amp;= \beta_0 + \beta_2 \\
p_{11} &amp;= \beta_0 + \beta_1 + \beta_2 + \beta_3
\end{align*}\]</span></p></li>
<li><p>Les différences de risque, risques relatifs et mesures d’interaction peuvent ensuite se calculer comme indiqué précédemment pour la g-computation.</p></li>
</ul>
<p>Les <em>potential outcomes</em> <span class="math inline">\(Y_{A_1,A_2}\)</span> ne peuvent pas être observés directement dans une étude observationnelles, on n’est pas possible d’appliquer directement l’équation <a href="conf.html#eq:MSMinteraction">(10.1)</a> du MSM sur la base de donnée observée pour estimer les paramètres <span class="math inline">\(\beta\)</span>. Différentes méthodes peuvent être appliquées pour estimer ces coefficients <span class="math inline">\(\beta\)</span>, tout en prenant en compte les biais de confusion :</p>
<ul>
<li>estimation par IPTW (<em>Inverse probability of Treatment Weighting</em>), il s’agit probablement de la méthode la plus utilisée dans la littérature. Les biais de confusion sont pris en compte en appliquant une méthode de pondération aux différents participants. La pondération repose sur l’estimation des scores de propension <span class="math inline">\(g(A_1)\)</span> et <span class="math inline">\(g(A_2)\)</span> (les probabilités d’exposition à chaque variable d’intérêt <span class="math inline">\(A_1\)</span> et <span class="math inline">\(A_2\)</span>).</li>
<li>estimation par g-computation. Elle repose sur l’estimation de fonctions <span class="math inline">\(\overline{Q}\)</span> (modèles du critère de jugement)</li>
<li>estimation par TMLE (<em>Targeted maximum likelihood estimation</em>), il s’agit d’une méthode à double robustesse qui repose à la fois l’estimation des fonctions <span class="math inline">\(\overline{Q}\)</span> et des scores de propension (<span class="math inline">\(g(A_1)\)</span> et <span class="math inline">\(g(A_2)\)</span>). Cette méthode sera non-biaisée si au moins les fonctions <span class="math inline">\(\overline{Q}\)</span> ou les fonction <span class="math inline">\(g\)</span> ont été correctement estimées. L’approche par TMLE utilise des méthodes de machine learning pour estimer ces fonctions.</li>
</ul>
<div id="estimation-du-msm-par-g-computation" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Estimation du MSM par g-computation<a href="conf.html#estimation-du-msm-par-g-computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nous pouvons utiliser l’estimation de la fonction <span class="math inline">\(\overline{Q}(A_1,A_2,L)\)</span> réalisée précédemment au paragraphe <a href="conf.html#gcomputation">10.1</a> ainsi que les valeurs estimées sous les 4 scénarios contrefactuels.</p>
<ol style="list-style-type: decimal">
<li>Pour estimer les paramètres d’un MSM par g-computation, il est d’abord nécessaire de constituer une base de données constituée :</li>
</ol>
<ul>
<li>d’une colonne contenant les estimations individuelles de <span class="math inline">\(\mathbb{E}(Y_{A_1=a_1,A_2 = a_2})(i) = \overline{Q}_i(a_1,a_2,L)\)</span> pour chaque scénario <span class="math inline">\(\{A_1 = a_1, A_2 = a_2\}\)</span></li>
<li>d’une colonne pour chaque variable d’exposition d’intérêt. Ici, on a besoin de deux colonnes : une colonne où <span class="math inline">\(A_1 = a_1\)</span> pour tous les individus, et une colonne où <span class="math inline">\(A_2 = a_2\)</span> pour tous les individus.</li>
</ul>
<p>Initialement, la base de données contient 10 000 individus. Les <em>potential outcomes</em> <span class="math inline">\(\overline{Q}_i(a_1,a_2,L)\)</span> ont été estimés à partir de 4 scénarios contrefactuels. On va donc constituer une base de données de 40 000 lignes.</p>
<ol start="2" style="list-style-type: decimal">
<li>On peut ensuite estimer les paramètres <span class="math inline">\(\beta\)</span> du MSM en appliquant directement l’équation <a href="conf.html#eq:MSMinteraction">(10.1)</a> sur la nouvelle base de données de 40000 lignes.</li>
</ol>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="conf.html#cb10-1" tabindex="-1"></a><span class="do">## 1) Constituer la base de données pour estimer les paramètres du MSM</span></span>
<span id="cb10-2"><a href="conf.html#cb10-2" tabindex="-1"></a><span class="co"># On récupère les Qbar_i prédits précédents, que l&#39;on fusionne dans un</span></span>
<span id="cb10-3"><a href="conf.html#cb10-3" tabindex="-1"></a><span class="co"># même vecteur </span></span>
<span id="cb10-4"><a href="conf.html#cb10-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(Qbar_00, Qbar_10, Qbar_01, Qbar_11)</span>
<span id="cb10-5"><a href="conf.html#cb10-5" tabindex="-1"></a><span class="fu">length</span>(Y)</span>
<span id="cb10-6"><a href="conf.html#cb10-6" tabindex="-1"></a><span class="co"># on a un vecteur de 40000 lignes</span></span>
<span id="cb10-7"><a href="conf.html#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="conf.html#cb10-8" tabindex="-1"></a><span class="co"># On récupère les valeurs d&#39;exposition qui ont servi dans les scénarios contrefactuels</span></span>
<span id="cb10-9"><a href="conf.html#cb10-9" tabindex="-1"></a><span class="co"># (garder le même ordre que pour les Qbar)</span></span>
<span id="cb10-10"><a href="conf.html#cb10-10" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">subset</span>(df.A1_0.A2_0, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)), <span class="co"># A1 = 0, A2 = 0</span></span>
<span id="cb10-11"><a href="conf.html#cb10-11" tabindex="-1"></a>           <span class="fu">subset</span>(df.A1_1.A2_0, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)), <span class="co"># A1 = 1, A2 = 0</span></span>
<span id="cb10-12"><a href="conf.html#cb10-12" tabindex="-1"></a>           <span class="fu">subset</span>(df.A1_0.A2_1, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)), <span class="co"># A1 = 0, A2 = 1</span></span>
<span id="cb10-13"><a href="conf.html#cb10-13" tabindex="-1"></a>           <span class="fu">subset</span>(df.A1_1.A2_1, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>))) <span class="co"># A1 = 1, A2 = 1</span></span>
<span id="cb10-14"><a href="conf.html#cb10-14" tabindex="-1"></a><span class="co">#  dim(X) # il s&#39;agit d&#39;une matrice de 40000 lignes et 2 colonnes</span></span>
<span id="cb10-15"><a href="conf.html#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="conf.html#cb10-16" tabindex="-1"></a><span class="do">## 2) Estimer les paramètres du MSM en appliquant l&#39;équation (1.10) sur cette </span></span>
<span id="cb10-17"><a href="conf.html#cb10-17" tabindex="-1"></a><span class="do">##    nouvelle base de donnée &#39;data.frame(Y,X)&#39;</span></span>
<span id="cb10-18"><a href="conf.html#cb10-18" tabindex="-1"></a><span class="co"># Modèle structurel marginal</span></span>
<span id="cb10-19"><a href="conf.html#cb10-19" tabindex="-1"></a>msm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2,</span>
<span id="cb10-20"><a href="conf.html#cb10-20" tabindex="-1"></a>           <span class="at">data =</span> <span class="fu">data.frame</span>(Y,X),</span>
<span id="cb10-21"><a href="conf.html#cb10-21" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>) </span>
<span id="cb10-22"><a href="conf.html#cb10-22" tabindex="-1"></a><span class="co"># note : il n&#39;est pas utile d&#39;ajuster sur les facteurs de confusion L</span></span>
<span id="cb10-23"><a href="conf.html#cb10-23" tabindex="-1"></a><span class="co"># car les Y ont été prédits à partir de modèles qui les déjà ont pris en compte</span></span>
<span id="cb10-24"><a href="conf.html#cb10-24" tabindex="-1"></a>msm</span>
<span id="cb10-25"><a href="conf.html#cb10-25" tabindex="-1"></a></span>
<span id="cb10-26"><a href="conf.html#cb10-26" tabindex="-1"></a><span class="do">## 3) Utilisation des paramètres du MSM afin d&#39;estimer les quantités d&#39;intérêt</span></span>
<span id="cb10-27"><a href="conf.html#cb10-27" tabindex="-1"></a><span class="do">##    pour l&#39;analyse d&#39;interaction</span></span>
<span id="cb10-28"><a href="conf.html#cb10-28" tabindex="-1"></a><span class="co"># présentation des résultats dans un tableau des effets marginaux</span></span>
<span id="cb10-29"><a href="conf.html#cb10-29" tabindex="-1"></a>results.MSM <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb10-30"><a href="conf.html#cb10-30" tabindex="-1"></a><span class="fu">colnames</span>(results.MSM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A2 = 0&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>,</span>
<span id="cb10-31"><a href="conf.html#cb10-31" tabindex="-1"></a>                           <span class="st">&quot;RD within strata of A1&quot;</span>,</span>
<span id="cb10-32"><a href="conf.html#cb10-32" tabindex="-1"></a>                           <span class="st">&quot;RR within strata of A1&quot;</span>)</span>
<span id="cb10-33"><a href="conf.html#cb10-33" tabindex="-1"></a><span class="fu">rownames</span>(results.MSM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;A1 = 1&quot;</span>,</span>
<span id="cb10-34"><a href="conf.html#cb10-34" tabindex="-1"></a>                           <span class="st">&quot;RD within strata of A2&quot;</span>,</span>
<span id="cb10-35"><a href="conf.html#cb10-35" tabindex="-1"></a>                           <span class="st">&quot;RR within strata of A2&quot;</span>)</span>
<span id="cb10-36"><a href="conf.html#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="conf.html#cb10-37" tabindex="-1"></a><span class="co"># Estimation de p_00, p_10, p_01 et p_11 à partir des coefficients du MSM</span></span>
<span id="cb10-38"><a href="conf.html#cb10-38" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> msm<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb10-39"><a href="conf.html#cb10-39" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (msm<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb10-40"><a href="conf.html#cb10-40" tabindex="-1"></a>                                     msm<span class="sc">$</span>coefficients[<span class="st">&quot;A2&quot;</span>])</span>
<span id="cb10-41"><a href="conf.html#cb10-41" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> (msm<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb10-42"><a href="conf.html#cb10-42" tabindex="-1"></a>                                     msm<span class="sc">$</span>coefficients[<span class="st">&quot;A1&quot;</span>])</span>
<span id="cb10-43"><a href="conf.html#cb10-43" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (msm<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb10-44"><a href="conf.html#cb10-44" tabindex="-1"></a>                                     msm<span class="sc">$</span>coefficients[<span class="st">&quot;A2&quot;</span>] <span class="sc">+</span> msm<span class="sc">$</span>coefficients[<span class="st">&quot;A1&quot;</span>] <span class="sc">+</span> </span>
<span id="cb10-45"><a href="conf.html#cb10-45" tabindex="-1"></a>                                     msm<span class="sc">$</span>coefficients[<span class="st">&quot;A1:A2&quot;</span>])</span>
<span id="cb10-46"><a href="conf.html#cb10-46" tabindex="-1"></a></span>
<span id="cb10-47"><a href="conf.html#cb10-47" tabindex="-1"></a><span class="co"># RD et RR dans les strates de A2</span></span>
<span id="cb10-48"><a href="conf.html#cb10-48" tabindex="-1"></a>results.MSM[<span class="st">&quot;RR within strata of A2&quot;</span>, <span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-49"><a href="conf.html#cb10-49" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb10-50"><a href="conf.html#cb10-50" tabindex="-1"></a>results.MSM[<span class="st">&quot;RD within strata of A2&quot;</span>, <span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-51"><a href="conf.html#cb10-51" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb10-52"><a href="conf.html#cb10-52" tabindex="-1"></a>results.MSM[<span class="st">&quot;RR within strata of A2&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-53"><a href="conf.html#cb10-53" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>])</span>
<span id="cb10-54"><a href="conf.html#cb10-54" tabindex="-1"></a>results.MSM[<span class="st">&quot;RD within strata of A2&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-55"><a href="conf.html#cb10-55" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>])</span>
<span id="cb10-56"><a href="conf.html#cb10-56" tabindex="-1"></a></span>
<span id="cb10-57"><a href="conf.html#cb10-57" tabindex="-1"></a><span class="co"># RD et RR dans les strates de A1</span></span>
<span id="cb10-58"><a href="conf.html#cb10-58" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;RR within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-59"><a href="conf.html#cb10-59" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb10-60"><a href="conf.html#cb10-60" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;RD within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-61"><a href="conf.html#cb10-61" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb10-62"><a href="conf.html#cb10-62" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>, <span class="st">&quot;RR within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-63"><a href="conf.html#cb10-63" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb10-64"><a href="conf.html#cb10-64" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>, <span class="st">&quot;RD within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-65"><a href="conf.html#cb10-65" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb10-66"><a href="conf.html#cb10-66" tabindex="-1"></a></span>
<span id="cb10-67"><a href="conf.html#cb10-67" tabindex="-1"></a>results.MSM <span class="ot">&lt;-</span> <span class="fu">round</span>(results.MSM,<span class="dv">3</span>)</span>
<span id="cb10-68"><a href="conf.html#cb10-68" tabindex="-1"></a>RD.interaction <span class="ot">&lt;-</span> msm<span class="sc">$</span>coefficients[<span class="st">&quot;A1:A2&quot;</span>]</span>
<span id="cb10-69"><a href="conf.html#cb10-69" tabindex="-1"></a>RR.interaction <span class="ot">&lt;-</span> ((results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">*</span> results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]) <span class="sc">/</span> </span>
<span id="cb10-70"><a href="conf.html#cb10-70" tabindex="-1"></a>                     (results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">*</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]))</span>
<span id="cb10-71"><a href="conf.html#cb10-71" tabindex="-1"></a>RERI <span class="ot">&lt;-</span> ((results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span> </span>
<span id="cb10-72"><a href="conf.html#cb10-72" tabindex="-1"></a>           results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">+</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>]) <span class="sc">/</span> </span>
<span id="cb10-73"><a href="conf.html#cb10-73" tabindex="-1"></a>           results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span></code></pre></div>
<p>Au final, on a (sans les IC):</p>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
A2 = 0
</th>
<th style="text-align:right;">
A2 = 1
</th>
<th style="text-align:right;">
RD within strata of A1
</th>
<th style="text-align:right;">
RR within strata of A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1 = 0
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
0.198
</td>
<td style="text-align:right;">
0.092
</td>
<td style="text-align:right;">
1.872
</td>
</tr>
<tr>
<td style="text-align:left;">
A1 = 1
</td>
<td style="text-align:right;">
0.404
</td>
<td style="text-align:right;">
0.892
</td>
<td style="text-align:right;">
0.488
</td>
<td style="text-align:right;">
2.206
</td>
</tr>
<tr>
<td style="text-align:left;">
RD within strata of A2
</td>
<td style="text-align:right;">
0.298
</td>
<td style="text-align:right;">
0.694
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
RR within strata of A2
</td>
<td style="text-align:right;">
3.816
</td>
<td style="text-align:right;">
4.498
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> additive Interaction = 0.395
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> RERI = 3.736
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> multiplicative Interaction = 1.18
</td>
</tr>
</tfoot>
</table>
</div>
<div id="estimation-du-msm-par-iptw" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Estimation du MSM par IPTW<a href="conf.html#estimation-du-msm-par-iptw" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les paramètres du MSM de l’équation <a href="conf.html#eq:MSMinteraction">(10.1)</a> peuvent également être estimée par une méthode de pondération inverse (IPTW).</p>
<p>Pour cela, il suffit d’appliquer une régression pondérée correspondant à l’équation <a href="conf.html#eq:MSMinteraction">(10.1)</a>, où chaque individu <span class="math inline">\(i\)</span> est pondéré par <span class="math inline">\(w_i\)</span> le produit l’inverse des scores de propension de l’exposition <span class="math inline">\(A_1\)</span> et de l’exposition <span class="math inline">\(A_2\)</span> (pour rappel, d’après le DAG simulant les données, les parents de <span class="math inline">\(A_1\)</span> sont <span class="math inline">\(L_1\)</span> et <span class="math inline">\(L_2\)</span>, et les parents de <span class="math inline">\(A_2\)</span> sont <span class="math inline">\(L_2\)</span> et <span class="math inline">\(L_3\)</span>) :
<span class="math display">\[\begin{equation*}
  w_i = \frac{g^*(A_{1,i})}{g(A_{1,i} \mid L_1, L_2)} \times \frac{g^*(A_{2,i})}{g(A_{2,i} \mid L_2, L_3)}
\end{equation*}\]</span>
où</p>
<ul>
<li><span class="math inline">\(g^*(A_i)\)</span> sont des fonctions choisies par l’utilisateur, par exemple <span class="math inline">\(g^*(A_i) = 1\)</span> correspondant à une pondération IPTW simple, ou encore <span class="math inline">\(g^*(A_i) = g(A_i)\)</span> qui permet de stabiliser les estimations (<em>stabilized IPTW</em>)</li>
<li><span class="math inline">\(g(A_i \mid L)\)</span> sont les scores de propension : ils modélisent la probabilité d’observer sa propre exposition.</li>
</ul>
<p><span class="math display">\[\begin{equation*}
g(A_i \mid L) = \left\{
  \begin{array}{ll}
    P(A = 1 \mid L_i) &amp; \mbox{ si } A_i = 1 \\
    1 - P(A = 1 \mid L_i) &amp; \mbox{ si } A_i = 0
  \end{array}
\right.
\end{equation*}\]</span></p>
<p>Cette pondération permet de créer une “pseudo-population” dans laquelle les facteurs de confusion des relations <span class="math inline">\(A_1 \rightarrow Y\)</span> et <span class="math inline">\(A_2 \rightarrow Y\)</span> sont équilibrés entre les strates d’exposition.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="conf.html#cb11-1" tabindex="-1"></a><span class="do">### Par exemple pour calculer des poids stabilisés : </span></span>
<span id="cb11-2"><a href="conf.html#cb11-2" tabindex="-1"></a><span class="do">## 1) estimer les fonctions g(A_1)*, g(A_1 | L1, L2), g(A_2*), g(A_2 | L2, L3)</span></span>
<span id="cb11-3"><a href="conf.html#cb11-3" tabindex="-1"></a>model_gA1_star <span class="ot">&lt;-</span> <span class="fu">glm</span>(A1 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb11-4"><a href="conf.html#cb11-4" tabindex="-1"></a>model_gA1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(A1 <span class="sc">~</span> L1 <span class="sc">+</span> L2, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb11-5"><a href="conf.html#cb11-5" tabindex="-1"></a>p_A1is1_star <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_gA1_star, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb11-6"><a href="conf.html#cb11-6" tabindex="-1"></a>p_A1is1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_gA1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb11-7"><a href="conf.html#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="conf.html#cb11-8" tabindex="-1"></a>model_gA2_star <span class="ot">&lt;-</span> <span class="fu">glm</span>(A2 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb11-9"><a href="conf.html#cb11-9" tabindex="-1"></a>model_gA2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(A2 <span class="sc">~</span> L2 <span class="sc">+</span> L3, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb11-10"><a href="conf.html#cb11-10" tabindex="-1"></a>p_A2is1_star <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_gA2_star, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb11-11"><a href="conf.html#cb11-11" tabindex="-1"></a>p_A2is1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_gA2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb11-12"><a href="conf.html#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="conf.html#cb11-13" tabindex="-1"></a>gA1_star <span class="ot">&lt;-</span> gA1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb11-14"><a href="conf.html#cb11-14" tabindex="-1"></a>gA1_star[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> p_A1is1_star[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-15"><a href="conf.html#cb11-15" tabindex="-1"></a>gA1_star[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p_A1is1_star[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-16"><a href="conf.html#cb11-16" tabindex="-1"></a>gA1[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> p_A1is1[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-17"><a href="conf.html#cb11-17" tabindex="-1"></a>gA1[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p_A1is1[df<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-18"><a href="conf.html#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="conf.html#cb11-19" tabindex="-1"></a>gA2_star <span class="ot">&lt;-</span> gA2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb11-20"><a href="conf.html#cb11-20" tabindex="-1"></a>gA2_star[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> p_A2is1_star[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-21"><a href="conf.html#cb11-21" tabindex="-1"></a>gA2_star[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p_A2is1_star[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-22"><a href="conf.html#cb11-22" tabindex="-1"></a>gA2[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> p_A2is1[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-23"><a href="conf.html#cb11-23" tabindex="-1"></a>gA2[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p_A2is1[df<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-24"><a href="conf.html#cb11-24" tabindex="-1"></a></span>
<span id="cb11-25"><a href="conf.html#cb11-25" tabindex="-1"></a><span class="co"># On peut alors calculer les poids individuels stabilisés</span></span>
<span id="cb11-26"><a href="conf.html#cb11-26" tabindex="-1"></a>sw <span class="ot">&lt;-</span> (gA1_star <span class="sc">/</span> gA1) <span class="sc">*</span> (gA2_star <span class="sc">/</span> gA2)</span>
<span id="cb11-27"><a href="conf.html#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="conf.html#cb11-28" tabindex="-1"></a><span class="do">## 2) Estimer les coefficients du MSM à l&#39;aide d&#39;une régression pondérée</span></span>
<span id="cb11-29"><a href="conf.html#cb11-29" tabindex="-1"></a><span class="co"># L&#39;équation (1.10) correspond à un modèle additif, </span></span>
<span id="cb11-30"><a href="conf.html#cb11-30" tabindex="-1"></a><span class="co"># nous allons utiliser une régression linéaire (family = gaussian)</span></span>
<span id="cb11-31"><a href="conf.html#cb11-31" tabindex="-1"></a>msm_iptw <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb11-32"><a href="conf.html#cb11-32" tabindex="-1"></a>                <span class="at">weights =</span> sw)</span>
<span id="cb11-33"><a href="conf.html#cb11-33" tabindex="-1"></a></span>
<span id="cb11-34"><a href="conf.html#cb11-34" tabindex="-1"></a>msm_iptw</span>
<span id="cb11-35"><a href="conf.html#cb11-35" tabindex="-1"></a></span>
<span id="cb11-36"><a href="conf.html#cb11-36" tabindex="-1"></a><span class="do">## 3) Utilisation des paramètres du MSM afin d&#39;estimer les quantités d&#39;intérêt</span></span>
<span id="cb11-37"><a href="conf.html#cb11-37" tabindex="-1"></a><span class="do">##    pour l&#39;analyse d&#39;interaction</span></span>
<span id="cb11-38"><a href="conf.html#cb11-38" tabindex="-1"></a><span class="co"># présentation des résultats dans un tableau des effets marginaux</span></span>
<span id="cb11-39"><a href="conf.html#cb11-39" tabindex="-1"></a>results.MSM <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb11-40"><a href="conf.html#cb11-40" tabindex="-1"></a><span class="fu">colnames</span>(results.MSM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A2 = 0&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>,</span>
<span id="cb11-41"><a href="conf.html#cb11-41" tabindex="-1"></a>                           <span class="st">&quot;RD within strata of A1&quot;</span>,</span>
<span id="cb11-42"><a href="conf.html#cb11-42" tabindex="-1"></a>                           <span class="st">&quot;RR within strata of A1&quot;</span>)</span>
<span id="cb11-43"><a href="conf.html#cb11-43" tabindex="-1"></a><span class="fu">rownames</span>(results.MSM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;A1 = 1&quot;</span>,</span>
<span id="cb11-44"><a href="conf.html#cb11-44" tabindex="-1"></a>                           <span class="st">&quot;RD within strata of A2&quot;</span>,</span>
<span id="cb11-45"><a href="conf.html#cb11-45" tabindex="-1"></a>                           <span class="st">&quot;RR within strata of A2&quot;</span>)</span>
<span id="cb11-46"><a href="conf.html#cb11-46" tabindex="-1"></a></span>
<span id="cb11-47"><a href="conf.html#cb11-47" tabindex="-1"></a><span class="co"># Estimation de p_00, p_10, p_01 et p_11 à partir des coefficients du MSM</span></span>
<span id="cb11-48"><a href="conf.html#cb11-48" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb11-49"><a href="conf.html#cb11-49" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-50"><a href="conf.html#cb11-50" tabindex="-1"></a>                                     msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;A2&quot;</span>])</span>
<span id="cb11-51"><a href="conf.html#cb11-51" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> (msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-52"><a href="conf.html#cb11-52" tabindex="-1"></a>                                     msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;A1&quot;</span>])</span>
<span id="cb11-53"><a href="conf.html#cb11-53" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-54"><a href="conf.html#cb11-54" tabindex="-1"></a>                                     msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;A2&quot;</span>] <span class="sc">+</span> </span>
<span id="cb11-55"><a href="conf.html#cb11-55" tabindex="-1"></a>                                     msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;A1&quot;</span>] <span class="sc">+</span> </span>
<span id="cb11-56"><a href="conf.html#cb11-56" tabindex="-1"></a>                                     msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;A1:A2&quot;</span>])</span>
<span id="cb11-57"><a href="conf.html#cb11-57" tabindex="-1"></a></span>
<span id="cb11-58"><a href="conf.html#cb11-58" tabindex="-1"></a><span class="co"># RD et RR dans les strates de A2</span></span>
<span id="cb11-59"><a href="conf.html#cb11-59" tabindex="-1"></a>results.MSM[<span class="st">&quot;RR within strata of A2&quot;</span>, <span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">/</span></span>
<span id="cb11-60"><a href="conf.html#cb11-60" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb11-61"><a href="conf.html#cb11-61" tabindex="-1"></a>results.MSM[<span class="st">&quot;RD within strata of A2&quot;</span>, <span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span></span>
<span id="cb11-62"><a href="conf.html#cb11-62" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb11-63"><a href="conf.html#cb11-63" tabindex="-1"></a>results.MSM[<span class="st">&quot;RR within strata of A2&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb11-64"><a href="conf.html#cb11-64" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>])</span>
<span id="cb11-65"><a href="conf.html#cb11-65" tabindex="-1"></a>results.MSM[<span class="st">&quot;RD within strata of A2&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb11-66"><a href="conf.html#cb11-66" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>])</span>
<span id="cb11-67"><a href="conf.html#cb11-67" tabindex="-1"></a></span>
<span id="cb11-68"><a href="conf.html#cb11-68" tabindex="-1"></a><span class="co"># RD et RR dans les strates de A1</span></span>
<span id="cb11-69"><a href="conf.html#cb11-69" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;RR within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb11-70"><a href="conf.html#cb11-70" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb11-71"><a href="conf.html#cb11-71" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;RD within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb11-72"><a href="conf.html#cb11-72" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb11-73"><a href="conf.html#cb11-73" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>, <span class="st">&quot;RR within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb11-74"><a href="conf.html#cb11-74" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb11-75"><a href="conf.html#cb11-75" tabindex="-1"></a>results.MSM[<span class="st">&quot;A1 = 1&quot;</span>, <span class="st">&quot;RD within strata of A1&quot;</span>] <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb11-76"><a href="conf.html#cb11-76" tabindex="-1"></a>                                                      results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span>
<span id="cb11-77"><a href="conf.html#cb11-77" tabindex="-1"></a></span>
<span id="cb11-78"><a href="conf.html#cb11-78" tabindex="-1"></a>results.MSM <span class="ot">&lt;-</span> <span class="fu">round</span>(results.MSM,<span class="dv">3</span>)</span>
<span id="cb11-79"><a href="conf.html#cb11-79" tabindex="-1"></a>RD.interaction <span class="ot">&lt;-</span> msm_iptw<span class="sc">$</span>coefficients[<span class="st">&quot;A1:A2&quot;</span>]</span>
<span id="cb11-80"><a href="conf.html#cb11-80" tabindex="-1"></a>RR.interaction <span class="ot">&lt;-</span> ((results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">*</span> results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]) <span class="sc">/</span> </span>
<span id="cb11-81"><a href="conf.html#cb11-81" tabindex="-1"></a>                     (results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">*</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]))</span>
<span id="cb11-82"><a href="conf.html#cb11-82" tabindex="-1"></a>RERI <span class="ot">&lt;-</span> ((results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span> </span>
<span id="cb11-83"><a href="conf.html#cb11-83" tabindex="-1"></a>           results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">+</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>]) <span class="sc">/</span> </span>
<span id="cb11-84"><a href="conf.html#cb11-84" tabindex="-1"></a>           results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>])</span></code></pre></div>
<p>Au final, on a (sans les IC):</p>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
A2 = 0
</th>
<th style="text-align:right;">
A2 = 1
</th>
<th style="text-align:right;">
RD within strata of A1
</th>
<th style="text-align:right;">
RR within strata of A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1 = 0
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
0.199
</td>
<td style="text-align:right;">
0.097
</td>
<td style="text-align:right;">
1.952
</td>
</tr>
<tr>
<td style="text-align:left;">
A1 = 1
</td>
<td style="text-align:right;">
0.409
</td>
<td style="text-align:right;">
0.900
</td>
<td style="text-align:right;">
0.491
</td>
<td style="text-align:right;">
2.202
</td>
</tr>
<tr>
<td style="text-align:left;">
RD within strata of A2
</td>
<td style="text-align:right;">
0.307
</td>
<td style="text-align:right;">
0.701
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
RR within strata of A2
</td>
<td style="text-align:right;">
4.000
</td>
<td style="text-align:right;">
4.514
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> additive Interaction = 0.394
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> RERI = 3.863
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> multiplicative Interaction = 1.13
</td>
</tr>
</tfoot>
</table>
</div>
</div>
<div id="estimation-avec-tmle" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Estimation avec TMLE<a href="conf.html#estimation-avec-tmle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le package R <code>ltmle</code> contient la fonction <code>ltmleMSM</code> qui permet d’estimer les paramètres d’un modèle structurel marginal par TMLE, par IPTW ou par g-computation. Par contre, le MSM utilisé est nécessairement une régression logistique. Les résultats que l’on peut en déduire sont donc des Odds Ratios ou une approximation du RERI, comme cela a été fait au paragraphe <a href="regression.html#regressionlogistique">9.1</a>.</p>
<p>Il est possible d’estimer les différences de risque, risques relatifs, et les différentes mesures d’interaction à partir de ce MSM défini sous forme de régression logistique, mais les calculs manuels sont plus fastidieux. Par ailleurs, les calculs d’intervalles de confiance reposent sur une delta-méthode.</p>
<p>Nous avons développé un package <code>MargIntTmle</code> disponible sur cette <a href="https://github.com/benoitlepage/MargIntTmle">page Github</a>, qui permet de faire ces calculs automatiquement. Vous trouverez la documentation complète du package sur la page.</p>
<p>Ci-dessous nous illustrons l’utilisation du package <code>MargIntTmle</code> pour obtenir des estimations par g-computation, IPTW, ou TMLE.</p>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="conf.html#cb12-1" tabindex="-1"></a><span class="co"># L&#39;installation du package peut se faire depuis la commande </span></span>
<span id="cb12-2"><a href="conf.html#cb12-2" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;benoitlepage/MargIntTmle&quot;)</span></span>
<span id="cb12-3"><a href="conf.html#cb12-3" tabindex="-1"></a><span class="fu">library</span>(MargIntTmle)</span>
<span id="cb12-4"><a href="conf.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="conf.html#cb12-5" tabindex="-1"></a><span class="co"># le package &#39;MargIntTmle&#39; repose sur les package &#39;ltmle&#39; et &#39;SuperLearner&#39;</span></span>
<span id="cb12-6"><a href="conf.html#cb12-6" tabindex="-1"></a><span class="fu">require</span>(ltmle)</span>
<span id="cb12-7"><a href="conf.html#cb12-7" tabindex="-1"></a><span class="fu">require</span>(SuperLearner)</span>
<span id="cb12-8"><a href="conf.html#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="conf.html#cb12-9" tabindex="-1"></a><span class="do">## Parmi les arguments nécessaires, il faut indiquer les fonctions Q et g</span></span>
<span id="cb12-10"><a href="conf.html#cb12-10" tabindex="-1"></a><span class="co"># Fonction Q</span></span>
<span id="cb12-11"><a href="conf.html#cb12-11" tabindex="-1"></a>Q_formulas <span class="ot">=</span> <span class="fu">c</span>(<span class="at">Y=</span><span class="st">&quot;Q.kplus1 ~ A1 + A2 + A1 * A2 + L1 + L2 + L3&quot;</span>)</span>
<span id="cb12-12"><a href="conf.html#cb12-12" tabindex="-1"></a><span class="co"># Les deux fonctions g </span></span>
<span id="cb12-13"><a href="conf.html#cb12-13" tabindex="-1"></a>g_formulas <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A1 ~ L1 + L2&quot;</span>,</span>
<span id="cb12-14"><a href="conf.html#cb12-14" tabindex="-1"></a>               <span class="st">&quot;A2 ~ L2 + L3&quot;</span>)</span>
<span id="cb12-15"><a href="conf.html#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="conf.html#cb12-16" tabindex="-1"></a><span class="do">## Choisir des librairies de machine learning disponibles dans le package &#39;SuperLearner&#39;:</span></span>
<span id="cb12-17"><a href="conf.html#cb12-17" tabindex="-1"></a>SL.library <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Q=</span><span class="fu">list</span>(<span class="st">&quot;SL.glm&quot;</span>),<span class="at">g=</span><span class="fu">list</span>(<span class="st">&quot;SL.glm&quot;</span>))</span>
<span id="cb12-18"><a href="conf.html#cb12-18" tabindex="-1"></a></span>
<span id="cb12-19"><a href="conf.html#cb12-19" tabindex="-1"></a><span class="do">## Utilisation de la fonction &#39;int.ltmleMSM()&#39;</span></span>
<span id="cb12-20"><a href="conf.html#cb12-20" tabindex="-1"></a><span class="co"># Cette fonction va estimer les paramètres du MSM soit par g-computation, </span></span>
<span id="cb12-21"><a href="conf.html#cb12-21" tabindex="-1"></a><span class="co"># soit par TMLE et IPTW</span></span>
<span id="cb12-22"><a href="conf.html#cb12-22" tabindex="-1"></a></span>
<span id="cb12-23"><a href="conf.html#cb12-23" tabindex="-1"></a><span class="co"># Pour obtenir une estimation des paramètres du MSM par TMLE et par IPTW, l&#39;argument </span></span>
<span id="cb12-24"><a href="conf.html#cb12-24" tabindex="-1"></a><span class="co"># &#39;gcomp&#39; doit égal à FALSE</span></span>
<span id="cb12-25"><a href="conf.html#cb12-25" tabindex="-1"></a>interaction.ltmle <span class="ot">&lt;-</span> <span class="fu">int.ltmleMSM</span>(<span class="at">data =</span> df,</span>
<span id="cb12-26"><a href="conf.html#cb12-26" tabindex="-1"></a>                                  <span class="at">Qform =</span> Q_formulas,</span>
<span id="cb12-27"><a href="conf.html#cb12-27" tabindex="-1"></a>                                  <span class="at">gform =</span> g_formulas,</span>
<span id="cb12-28"><a href="conf.html#cb12-28" tabindex="-1"></a>                                  <span class="at">Anodes =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>),</span>
<span id="cb12-29"><a href="conf.html#cb12-29" tabindex="-1"></a>                                  <span class="at">Lnodes =</span> <span class="fu">c</span>(<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;L2&quot;</span>, <span class="st">&quot;L3&quot;</span>),</span>
<span id="cb12-30"><a href="conf.html#cb12-30" tabindex="-1"></a>                                  <span class="at">Ynodes =</span> <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>),</span>
<span id="cb12-31"><a href="conf.html#cb12-31" tabindex="-1"></a>                                  <span class="at">SL.library =</span> SL.library,</span>
<span id="cb12-32"><a href="conf.html#cb12-32" tabindex="-1"></a>                                  <span class="at">gcomp =</span> <span class="cn">FALSE</span>, <span class="co"># pour l&#39;estimation par TMLE et IPTW</span></span>
<span id="cb12-33"><a href="conf.html#cb12-33" tabindex="-1"></a>                                  <span class="at">iptw.only =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-34"><a href="conf.html#cb12-34" tabindex="-1"></a>                                  <span class="at">survivalOutcome =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-35"><a href="conf.html#cb12-35" tabindex="-1"></a>                                  <span class="at">variance.method =</span> <span class="st">&quot;ic&quot;</span>)</span>
<span id="cb12-36"><a href="conf.html#cb12-36" tabindex="-1"></a></span>
<span id="cb12-37"><a href="conf.html#cb12-37" tabindex="-1"></a><span class="co"># Pour obtenir une estimation des paramètres du MSM par g-computation, l&#39;argument</span></span>
<span id="cb12-38"><a href="conf.html#cb12-38" tabindex="-1"></a><span class="co"># &#39;gcomp&#39; doit être égal à TRUE. </span></span>
<span id="cb12-39"><a href="conf.html#cb12-39" tabindex="-1"></a><span class="co"># Les IC95% seront alors estimés par bootstrap, vous pouvez préciser le nombre </span></span>
<span id="cb12-40"><a href="conf.html#cb12-40" tabindex="-1"></a><span class="co"># d&#39;échantillons bootstrap et donner une valeur de seed</span></span>
<span id="cb12-41"><a href="conf.html#cb12-41" tabindex="-1"></a>interaction.gcomp <span class="ot">&lt;-</span> <span class="fu">int.ltmleMSM</span>(<span class="at">data =</span> df,</span>
<span id="cb12-42"><a href="conf.html#cb12-42" tabindex="-1"></a>                                  <span class="at">Qform =</span> Q_formulas,</span>
<span id="cb12-43"><a href="conf.html#cb12-43" tabindex="-1"></a>                                  <span class="at">gform =</span> g_formulas,</span>
<span id="cb12-44"><a href="conf.html#cb12-44" tabindex="-1"></a>                                  <span class="at">Anodes =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>),</span>
<span id="cb12-45"><a href="conf.html#cb12-45" tabindex="-1"></a>                                  <span class="at">Lnodes =</span> <span class="fu">c</span>(<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;L2&quot;</span>, <span class="st">&quot;L3&quot;</span>),</span>
<span id="cb12-46"><a href="conf.html#cb12-46" tabindex="-1"></a>                                  <span class="at">Ynodes =</span> <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>),</span>
<span id="cb12-47"><a href="conf.html#cb12-47" tabindex="-1"></a>                                  <span class="at">SL.library =</span> SL.library,</span>
<span id="cb12-48"><a href="conf.html#cb12-48" tabindex="-1"></a>                                  <span class="at">gcomp =</span> <span class="cn">TRUE</span>, <span class="co"># pour l&#39;estimation par g-computation</span></span>
<span id="cb12-49"><a href="conf.html#cb12-49" tabindex="-1"></a>                                  <span class="at">iptw.only =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-50"><a href="conf.html#cb12-50" tabindex="-1"></a>                                  <span class="at">survivalOutcome =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-51"><a href="conf.html#cb12-51" tabindex="-1"></a>                                  <span class="at">variance.method =</span> <span class="st">&quot;ic&quot;</span>,</span>
<span id="cb12-52"><a href="conf.html#cb12-52" tabindex="-1"></a>                                  <span class="at">B =</span> <span class="dv">1000</span>, <span class="co"># number of bootstrap samples</span></span>
<span id="cb12-53"><a href="conf.html#cb12-53" tabindex="-1"></a>                                  <span class="at">boot.seed =</span> <span class="dv">42</span>) <span class="co"># seed for bootstrap</span></span></code></pre></div>
<pre><code>## [1] &quot;bootstrap number 100&quot;
## [1] &quot;bootstrap number 200&quot;
## [1] &quot;bootstrap number 300&quot;
## [1] &quot;bootstrap number 400&quot;
## [1] &quot;bootstrap number 500&quot;
## [1] &quot;bootstrap number 600&quot;
## [1] &quot;bootstrap number 700&quot;
## [1] &quot;bootstrap number 800&quot;
## [1] &quot;bootstrap number 900&quot;
## [1] &quot;bootstrap number 1000&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="conf.html#cb14-1" tabindex="-1"></a><span class="do">## La fonction &#39;estim.int.effects()&#39; permet d&#39;estimer les différentes quantités </span></span>
<span id="cb14-2"><a href="conf.html#cb14-2" tabindex="-1"></a><span class="do">## d&#39;intérêt pour l&#39;analyse d&#39;interaction à partir du MSM estimé précédemment.</span></span>
<span id="cb14-3"><a href="conf.html#cb14-3" tabindex="-1"></a><span class="co"># Les IC95% sont calculés par Delta méthode pour la TMLE et l&#39;IPTW, et par </span></span>
<span id="cb14-4"><a href="conf.html#cb14-4" tabindex="-1"></a><span class="co"># bootstrap pour la g-computation.</span></span>
<span id="cb14-5"><a href="conf.html#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="conf.html#cb14-6" tabindex="-1"></a><span class="co"># pour obtenir les estimations par TMLE : </span></span>
<span id="cb14-7"><a href="conf.html#cb14-7" tabindex="-1"></a>est.tmle <span class="ot">&lt;-</span> <span class="fu">estim.int.effects</span>(interaction.ltmle, <span class="at">estimator =</span> <span class="st">&quot;tmle&quot;</span>)</span>
<span id="cb14-8"><a href="conf.html#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="conf.html#cb14-9" tabindex="-1"></a><span class="co"># pour obtenir les estimations par IPTW : </span></span>
<span id="cb14-10"><a href="conf.html#cb14-10" tabindex="-1"></a>est.iptw <span class="ot">&lt;-</span> <span class="fu">estim.int.effects</span>(interaction.ltmle, <span class="at">estimator =</span> <span class="st">&quot;iptw&quot;</span>)</span>
<span id="cb14-11"><a href="conf.html#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="conf.html#cb14-12" tabindex="-1"></a><span class="co"># pour obtenir les estimations par g-computation : </span></span>
<span id="cb14-13"><a href="conf.html#cb14-13" tabindex="-1"></a>est.gcomp <span class="ot">&lt;-</span> <span class="fu">estim.int.effects</span>(interaction.gcomp, <span class="at">estimator =</span> <span class="st">&quot;gcomp&quot;</span>)</span>
<span id="cb14-14"><a href="conf.html#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="conf.html#cb14-15" tabindex="-1"></a><span class="do">## Les résultats peuvent ensuite être présentés sous forme de table, en suivant </span></span>
<span id="cb14-16"><a href="conf.html#cb14-16" tabindex="-1"></a><span class="do">## les recommandations de Knol et al. (2012) à l&#39;aide de la fonction &#39;out.int.table()&#39;</span></span>
<span id="cb14-17"><a href="conf.html#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="conf.html#cb14-18" tabindex="-1"></a><span class="co"># par exemple pour les estimations par TMLE : </span></span>
<span id="cb14-19"><a href="conf.html#cb14-19" tabindex="-1"></a>table_inter <span class="ot">&lt;-</span> <span class="fu">out.int.table</span>(<span class="at">int.r =</span> est.tmle)</span>
<span id="cb14-20"><a href="conf.html#cb14-20" tabindex="-1"></a>table_inter<span class="sc">$</span>out.table</span></code></pre></div>
<pre><code>##                                  A2=0                         A2=1
## A1=0     $p_{00}$=0.103 [0.095,0.112] $p_{01}$=0.196 [0.181,0.212]
## A1=1      $p_{10}$=0.411 [0.38,0.442] $p_{11}$=0.898 [0.877,0.919]
## RD.A1|A2           0.308 [0.276,0.34]          0.702 [0.676,0.728]
## RR.A1|A2             3.98 [3.55,4.46]             4.58 [4.22,4.97]
##                     RD.A2|A1         RR.A2|A1
## A1=0      0.093 [0.075,0.11]  1.9 [1.69,2.13]
## A1=1     0.487 [0.449,0.524] 2.18 [2.02,2.36]
## RD.A1|A2                                     
## RR.A1|A2</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="conf.html#cb16-1" tabindex="-1"></a><span class="co"># les mesures d&#39;interaction sont disponible dans l&#39;objet </span></span>
<span id="cb16-2"><a href="conf.html#cb16-2" tabindex="-1"></a>table_inter<span class="sc">$</span>interaction.effects</span></code></pre></div>
<pre><code>## [1] &quot;additive Interaction = 0.394 [0.353;0.435]&quot;
## [2] &quot;RERI = 3.81 [3.38;4.3]&quot;                    
## [3] &quot;multiplicative Interaction = 1.15 [1;1.32]&quot;</code></pre>
<p>On peut également se servir du package <code>KableExtra</code> pour mettre en forme les tables (selon les recommandations Knol et al. <span class="citation">[<a href="#ref-knol_recommendations_2012">11</a>]</span>) :</p>
<p>Effets d’interaction estimés par TMLE :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="conf.html#cb18-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb18-2"><a href="conf.html#cb18-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table_inter<span class="sc">$</span>out.table,) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="conf.html#cb18-3" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="conf.html#cb18-4" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="fu">c</span>(table_inter<span class="sc">$</span>interaction.effects[<span class="dv">1</span>], </span>
<span id="cb18-5"><a href="conf.html#cb18-5" tabindex="-1"></a>                 table_inter<span class="sc">$</span>interaction.effects[<span class="dv">2</span>], </span>
<span id="cb18-6"><a href="conf.html#cb18-6" tabindex="-1"></a>                 table_inter<span class="sc">$</span>interaction.effects[<span class="dv">3</span>]),</span>
<span id="cb18-7"><a href="conf.html#cb18-7" tabindex="-1"></a>               <span class="at">escape =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A2=0
</th>
<th style="text-align:left;">
A2=1
</th>
<th style="text-align:left;">
RD.A2|A1
</th>
<th style="text-align:left;">
RR.A2|A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1=0
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{00}\)</span>=0.103 [0.095,0.112]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{01}\)</span>=0.196 [0.181,0.212]
</td>
<td style="text-align:left;">
0.093 [0.075,0.11]
</td>
<td style="text-align:left;">
1.9 [1.69,2.13]
</td>
</tr>
<tr>
<td style="text-align:left;">
A1=1
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{10}\)</span>=0.411 [0.38,0.442]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{11}\)</span>=0.898 [0.877,0.919]
</td>
<td style="text-align:left;">
0.487 [0.449,0.524]
</td>
<td style="text-align:left;">
2.18 [2.02,2.36]
</td>
</tr>
<tr>
<td style="text-align:left;">
RD.A1|A2
</td>
<td style="text-align:left;">
0.308 [0.276,0.34]
</td>
<td style="text-align:left;">
0.702 [0.676,0.728]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
RR.A1|A2
</td>
<td style="text-align:left;">
3.98 [3.55,4.46]
</td>
<td style="text-align:left;">
4.58 [4.22,4.97]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>a</sup> additive Interaction = 0.394 [0.353;0.435]
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>b</sup> RERI = 3.81 [3.38;4.3]
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>c</sup> multiplicative Interaction = 1.15 [1;1.32]
</td>
</tr>
</tfoot>
</table>
<p>Résultats obtenus en appliquant l’estimation par IPTW :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="conf.html#cb19-1" tabindex="-1"></a>table_inter <span class="ot">&lt;-</span> MargIntTmle<span class="sc">::</span><span class="fu">out.int.table</span>(<span class="at">int.r =</span> est.iptw)</span>
<span id="cb19-2"><a href="conf.html#cb19-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table_inter<span class="sc">$</span>out.table,) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="conf.html#cb19-3" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="conf.html#cb19-4" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="fu">c</span>(table_inter<span class="sc">$</span>interaction.effects[<span class="dv">1</span>], </span>
<span id="cb19-5"><a href="conf.html#cb19-5" tabindex="-1"></a>                 table_inter<span class="sc">$</span>interaction.effects[<span class="dv">2</span>], </span>
<span id="cb19-6"><a href="conf.html#cb19-6" tabindex="-1"></a>                 table_inter<span class="sc">$</span>interaction.effects[<span class="dv">3</span>]),</span>
<span id="cb19-7"><a href="conf.html#cb19-7" tabindex="-1"></a>               <span class="at">escape =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A2=0
</th>
<th style="text-align:left;">
A2=1
</th>
<th style="text-align:left;">
RD.A2|A1
</th>
<th style="text-align:left;">
RR.A2|A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1=0
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{00}\)</span>=0.102 [0.093,0.111]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{01}\)</span>=0.199 [0.184,0.215]
</td>
<td style="text-align:left;">
0.097 [0.079,0.115]
</td>
<td style="text-align:left;">
1.95 [1.74,2.19]
</td>
</tr>
<tr>
<td style="text-align:left;">
A1=1
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{10}\)</span>=0.409 [0.378,0.44]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{11}\)</span>=0.9 [0.879,0.921]
</td>
<td style="text-align:left;">
0.491 [0.454,0.529]
</td>
<td style="text-align:left;">
2.2 [2.03,2.38]
</td>
</tr>
<tr>
<td style="text-align:left;">
RD.A1|A2
</td>
<td style="text-align:left;">
0.307 [0.274,0.339]
</td>
<td style="text-align:left;">
0.701 [0.675,0.727]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
RR.A1|A2
</td>
<td style="text-align:left;">
4 [3.57,4.48]
</td>
<td style="text-align:left;">
4.51 [4.16,4.89]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>a</sup> additive Interaction = 0.394 [0.353;0.436]
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>b</sup> RERI = 3.86 [3.42;4.35]
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>c</sup> multiplicative Interaction = 1.13 [0.98;1.3]
</td>
</tr>
</tfoot>
</table>
<p>Résultats obtenus en appliquant l’estimation par g-computation :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="conf.html#cb20-1" tabindex="-1"></a>table_inter <span class="ot">&lt;-</span> MargIntTmle<span class="sc">::</span><span class="fu">out.int.table</span>(<span class="at">int.r =</span> est.gcomp)</span>
<span id="cb20-2"><a href="conf.html#cb20-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table_inter<span class="sc">$</span>out.table,) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="conf.html#cb20-3" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="conf.html#cb20-4" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="fu">c</span>(table_inter<span class="sc">$</span>interaction.effects[<span class="dv">1</span>], </span>
<span id="cb20-5"><a href="conf.html#cb20-5" tabindex="-1"></a>                 table_inter<span class="sc">$</span>interaction.effects[<span class="dv">2</span>], </span>
<span id="cb20-6"><a href="conf.html#cb20-6" tabindex="-1"></a>                 table_inter<span class="sc">$</span>interaction.effects[<span class="dv">3</span>]),</span>
<span id="cb20-7"><a href="conf.html#cb20-7" tabindex="-1"></a>               <span class="at">escape =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A2=0
</th>
<th style="text-align:left;">
A2=1
</th>
<th style="text-align:left;">
RD.A2|A1
</th>
<th style="text-align:left;">
RR.A2|A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1=0
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{00}\)</span>=0.104 [0.095,0.112]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{01}\)</span>=0.197 [0.183,0.211]
</td>
<td style="text-align:left;">
0.093 [0.076,0.11]
</td>
<td style="text-align:left;">
1.9 [1.7,2.13]
</td>
</tr>
<tr>
<td style="text-align:left;">
A1=1
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{10}\)</span>=0.4 [0.372,0.427]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{11}\)</span>=0.893 [0.872,0.915]
</td>
<td style="text-align:left;">
0.494 [0.458,0.529]
</td>
<td style="text-align:left;">
2.23 [2.08,2.4]
</td>
</tr>
<tr>
<td style="text-align:left;">
RD.A1|A2
</td>
<td style="text-align:left;">
0.296 [0.267,0.326]
</td>
<td style="text-align:left;">
0.697 [0.67,0.723]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
RR.A1|A2
</td>
<td style="text-align:left;">
3.86 [3.45,4.32]
</td>
<td style="text-align:left;">
4.54 [4.2,4.9]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>a</sup> additive Interaction = 0.4 [0.361;0.439]
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>b</sup> RERI = 3.86 [3.46;4.32]
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>c</sup> multiplicative Interaction = 1.18 [1.03;1.35]
</td>
</tr>
</tfoot>
</table>

</div>
</div>
<h3> Références<a href="références.html#références" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-knol_recommendations_2012" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">Knol MJ, VanderWeele TJ. Recommendations for presenting analyses of effect modification and interaction. International Journal of Epidemiology 2012;41:514–20. <a href="https://doi.org/10.1093/ije/dyr218">https://doi.org/10.1093/ije/dyr218</a>.</div>
</div>
<div id="ref-hernan2020causal" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">Hernán MA, Robins JM. Causal inference: What if - PREPRINT. Chapman &amp; Hall/CRC Boca Raton, FL; 2020.</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graph.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-analyse_confirmatoire.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
