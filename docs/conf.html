<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 10 Approches causales | Interactions et modifications d’effet   en Epidémiologie</title>
  <meta name="description" content="." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 10 Approches causales | Interactions et modifications d’effet   en Epidémiologie" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="." />
  <meta name="github-repo" content="interaction" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 10 Approches causales | Interactions et modifications d’effet   en Epidémiologie" />
  
  <meta name="twitter:description" content="." />
  

<meta name="author" content="CERPOP, INSERM, EQUITY Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="graph.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Interactions</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Présentation</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#quand-étudier-les-interactions"><i class="fa fa-check"></i><b>2.1</b> Quand étudier les interactions ?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#prediction-versus-causalité"><i class="fa fa-check"></i><b>2.1.1</b> <em>Prediction</em> versus <em>causalité</em></a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction.html"><a href="introduction.html#types-dobjectifs"><i class="fa fa-check"></i><b>2.1.2</b> Types d’objectifs</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#les-points-les-plus-importants"><i class="fa fa-check"></i><b>2.2</b> Les points les plus importants</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#avertissement"><i class="fa fa-check"></i><b>2.3</b> Avertissement</a></li>
</ul></li>
<li class="part"><span><b>I Synthèse de la littérature</b></span></li>
<li class="chapter" data-level="3" data-path="définitions-préalables.html"><a href="définitions-préalables.html"><i class="fa fa-check"></i><b>3</b> Définitions préalables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="définitions-préalables.html"><a href="définitions-préalables.html#variables-et-probabilités"><i class="fa fa-check"></i><b>3.1</b> Variables et probabilités</a></li>
<li class="chapter" data-level="3.2" data-path="définitions-préalables.html"><a href="définitions-préalables.html#mesures-deffets"><i class="fa fa-check"></i><b>3.2</b> Mesures d’effets</a>
<ul>
<li class="chapter" data-level="" data-path="définitions-préalables.html"><a href="définitions-préalables.html#concernant-les-différences-de-risques-dr-effets-additifs"><i class="fa fa-check"></i>Concernant les différences de risques (DR, effets additifs)</a></li>
<li class="chapter" data-level="" data-path="définitions-préalables.html"><a href="définitions-préalables.html#concernant-les-rapports-de-risques-rr-effets-multiplicatifs"><i class="fa fa-check"></i>Concernant les rapports de risques (RR, effets multiplicatifs)</a></li>
<li class="chapter" data-level="" data-path="définitions-préalables.html"><a href="définitions-préalables.html#une-autre-échelle-multiplicative-fréquemment-utilisée-est-léchelle-des-odds-ratios-or"><i class="fa fa-check"></i>Une autre échelle multiplicative fréquemment utilisée est l’échelle des odds-ratios (OR)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="définitions-préalables.html"><a href="définitions-préalables.html#effets-conditionnels-et-marginaux"><i class="fa fa-check"></i><b>3.3</b> Effets conditionnels et marginaux</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intmodif.html"><a href="intmodif.html"><i class="fa fa-check"></i><b>4</b> Interaction ou modification d’effets</a>
<ul>
<li class="chapter" data-level="4.1" data-path="intmodif.html"><a href="intmodif.html#modification-deffets"><i class="fa fa-check"></i><b>4.1</b> Modification d’effets</a></li>
<li class="chapter" data-level="4.2" data-path="intmodif.html"><a href="intmodif.html#interaction"><i class="fa fa-check"></i><b>4.2</b> Interaction</a></li>
<li class="chapter" data-level="4.3" data-path="intmodif.html"><a href="intmodif.html#synthèse"><i class="fa fa-check"></i><b>4.3</b> Synthèse</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="echelle.html"><a href="echelle.html"><i class="fa fa-check"></i><b>5</b> La question des échelles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="echelle.html"><a href="echelle.html#mesures-des-interactions"><i class="fa fa-check"></i><b>5.1</b> Mesures des interactions</a>
<ul>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#echelle-additive"><i class="fa fa-check"></i>Echelle additive</a></li>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#echelle-multiplicative"><i class="fa fa-check"></i>Echelle multiplicative</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="echelle.html"><a href="echelle.html#lien-entre-les-deux-échelles"><i class="fa fa-check"></i><b>5.2</b> Lien entre les deux échelles</a>
<ul>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#un-apparent-paradoxe"><i class="fa fa-check"></i>Un apparent paradoxe</a></li>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#le-continuum"><i class="fa fa-check"></i>Le continuum</a></li>
<li class="chapter" data-level="" data-path="echelle.html"><a href="echelle.html#interactions-pures-et-qualitatives-interactions-inversées"><i class="fa fa-check"></i>Interactions pures et qualitatives, interactions inversées</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="echelle.html"><a href="echelle.html#synthèse-1"><i class="fa fa-check"></i><b>5.3</b> Synthèse</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="param.html"><a href="param.html"><i class="fa fa-check"></i><b>6</b> Types de paramètres</a>
<ul>
<li class="chapter" data-level="6.1" data-path="param.html"><a href="param.html#sur-léchelle-multiplicative"><i class="fa fa-check"></i><b>6.1</b> Sur l’échelle multiplicative</a>
<ul>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#avec-les-risques-relatifs-mi"><i class="fa fa-check"></i>Avec les risques relatifs (MI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#avec-les-odds-ratio-mi"><i class="fa fa-check"></i>Avec les Odds Ratio (MI)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="param.html"><a href="param.html#sur-léchelle-additive"><i class="fa fa-check"></i><b>6.2</b> Sur l’échelle additive</a>
<ul>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#avec-les-différences-de-risques-ai"><i class="fa fa-check"></i>Avec les différences de risques (AI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#excès-de-risque-à-partir-des-rr-reri"><i class="fa fa-check"></i>Excès de risque, à partir des RR (RERI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#le-synergie-index-si"><i class="fa fa-check"></i>Le “Synergie index” (SI)</a></li>
<li class="chapter" data-level="" data-path="param.html"><a href="param.html#proportion-attribuable-ap"><i class="fa fa-check"></i>Proportion attribuable (AP)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Estimations, Interprétations, Présentations</b></span></li>
<li class="chapter" data-level="7" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html"><i class="fa fa-check"></i><b>7</b> Présentation des résultats</a>
<ul>
<li class="chapter" data-level="7.1" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#recommandations"><i class="fa fa-check"></i><b>7.1</b> Recommandations</a>
<ul>
<li class="chapter" data-level="" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#pour-une-analyse-dune-modification-deffet-de-small-x-sur-small-y-par-small-v"><i class="fa fa-check"></i>Pour une analyse d’une modification d’effet de <span class="math inline">\(\small X\)</span> sur <span class="math inline">\(\small Y\)</span> par <span class="math inline">\(\small V\)</span></a></li>
<li class="chapter" data-level="" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#interaction-small-xv-sur-small-y"><i class="fa fa-check"></i>Interaction <span class="math inline">\(\small X*V\)</span> sur <span class="math inline">\(\small Y\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="présentation-des-résultats.html"><a href="présentation-des-résultats.html#proposition"><i class="fa fa-check"></i><b>7.2</b> Proposition</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>8</b> Simulations</a></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> A partir de modèles de régression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#régression-logistique"><i class="fa fa-check"></i><b>9.1</b> Régression logistique</a></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#régression-lineaire"><i class="fa fa-check"></i><b>9.2</b> Régression lineaire</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conf.html"><a href="conf.html"><i class="fa fa-check"></i><b>10</b> Approches causales</a>
<ul>
<li class="chapter" data-level="10.1" data-path="conf.html"><a href="conf.html#gcomputation"><i class="fa fa-check"></i><b>10.1</b> Estimation par G-computation</a></li>
<li class="chapter" data-level="10.2" data-path="conf.html"><a href="conf.html#estimation-par-modèle-structurel-marginal"><i class="fa fa-check"></i><b>10.2</b> Estimation par Modèle Structurel Marginal</a></li>
<li class="chapter" data-level="10.3" data-path="conf.html"><a href="conf.html#estimation-avec-tmle"><i class="fa fa-check"></i><b>10.3</b> Estimation avec TMLE</a>
<ul>
<li class="chapter" data-level="" data-path="conf.html"><a href="conf.html#tmle"><i class="fa fa-check"></i>TMLE</a></li>
<li class="chapter" data-level="" data-path="conf.html"><a href="conf.html#iptw"><i class="fa fa-check"></i>IPTW</a></li>
<li class="chapter" data-level="" data-path="conf.html"><a href="conf.html#g-computation"><i class="fa fa-check"></i>G-computation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>11</b> Représentations graphiques</a></li>
<li class="part"><span><b>III En pratique</b></span></li>
<li class="chapter" data-level="12" data-path="proposition-détapes.html"><a href="proposition-détapes.html"><i class="fa fa-check"></i><b>12</b> Proposition d’étapes</a></li>
<li class="chapter" data-level="13" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html"><i class="fa fa-check"></i><b>13</b> Exemple 1 - Y binaire</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#formuler-les-objectifs"><i class="fa fa-check"></i><b>13.1</b> Formuler les objectifs</a></li>
<li class="chapter" data-level="13.2" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#stratégies-et-méthodes"><i class="fa fa-check"></i><b>13.2</b> Stratégies et méthodes</a></li>
<li class="chapter" data-level="13.3" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#analyse-descriptive"><i class="fa fa-check"></i><b>13.3</b> Analyse descriptive</a></li>
<li class="chapter" data-level="13.4" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#analyse-exploratoire"><i class="fa fa-check"></i><b>13.4</b> Analyse exploratoire</a></li>
<li class="chapter" data-level="13.5" data-path="exemple-1---y-binaire.html"><a href="exemple-1---y-binaire.html#analyse-confirmatoire"><i class="fa fa-check"></i><b>13.5</b> Analyse confirmatoire</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html"><i class="fa fa-check"></i><b>14</b> Exemple 2 - Y quantitatif</a>
<ul>
<li class="chapter" data-level="14.1" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#formuler-les-objectifs-1"><i class="fa fa-check"></i><b>14.1</b> Formuler les objectifs</a></li>
<li class="chapter" data-level="14.2" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#stratégies-et-méthodes-1"><i class="fa fa-check"></i><b>14.2</b> Stratégies et méthodes</a></li>
<li class="chapter" data-level="14.3" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#analyse-descriptive-1"><i class="fa fa-check"></i><b>14.3</b> Analyse descriptive</a></li>
<li class="chapter" data-level="14.4" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#analyse-exploratoire-1"><i class="fa fa-check"></i><b>14.4</b> Analyse exploratoire</a></li>
<li class="chapter" data-level="14.5" data-path="exemple-2---y-quantitatif.html"><a href="exemple-2---y-quantitatif.html#analyse-confirmatoire-1"><i class="fa fa-check"></i><b>14.5</b> Analyse confirmatoire</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html"><i class="fa fa-check"></i><b>15</b> Exemple 4 - X quantitatif</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#formuler-les-objectifs-2"><i class="fa fa-check"></i><b>15.1</b> Formuler les objectifs</a></li>
<li class="chapter" data-level="15.2" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#stratégies-et-méthodes-2"><i class="fa fa-check"></i><b>15.2</b> Stratégies et méthodes</a></li>
<li class="chapter" data-level="15.3" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#analyse-descriptive-2"><i class="fa fa-check"></i><b>15.3</b> Analyse descriptive</a></li>
<li class="chapter" data-level="15.4" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#analyse-exploratoire-2"><i class="fa fa-check"></i><b>15.4</b> Analyse exploratoire</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#régression-logistique-1"><i class="fa fa-check"></i><b>15.4.1</b> Régression logistique</a></li>
<li class="chapter" data-level="15.4.2" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#régression-linéaire"><i class="fa fa-check"></i><b>15.4.2</b> Régression linéaire</a></li>
<li class="chapter" data-level="15.4.3" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#effets-prédits"><i class="fa fa-check"></i><b>15.4.3</b> Effets prédits</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exemple-4---x-quantitatif.html"><a href="exemple-4---x-quantitatif.html#analyse-confirmatoire-2"><i class="fa fa-check"></i><b>15.5</b> Analyse confirmatoire</a></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="16" data-path="synthèse-générale.html"><a href="synthèse-générale.html"><i class="fa fa-check"></i><b>16</b> Synthèse générale</a></li>
<li class="chapter" data-level="17" data-path="plusloin.html"><a href="plusloin.html"><i class="fa fa-check"></i><b>17</b> Pour aller plus loin…</a>
<ul>
<li class="chapter" data-level="17.1" data-path="plusloin.html"><a href="plusloin.html#ajouter-de-la-complexité"><i class="fa fa-check"></i><b>17.1</b> Ajouter de la complexité</a></li>
<li class="chapter" data-level="17.2" data-path="plusloin.html"><a href="plusloin.html#interaction-avec-confusion-intermédiaire"><i class="fa fa-check"></i><b>17.2</b> Interaction avec confusion intermédiaire</a></li>
<li class="chapter" data-level="17.3" data-path="plusloin.html"><a href="plusloin.html#interaction-et-médiation"><i class="fa fa-check"></i><b>17.3</b> Interaction et médiation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i><b>18</b> Références</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactions et modifications d’effet <br> en Epidémiologie</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conf" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapitre 10</span> Approches causales<a href="conf.html#conf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="gcomputation" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Estimation par G-computation<a href="conf.html#gcomputation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il s’agit d’une “G-méthode” qui peut être décrite comme une “standardisation” par régression (Hernàn <span class="citation">[<a href="#ref-hernan2020causal">12</a>]</span>).
Le principe est le suivant :</p>
<ol style="list-style-type: lower-roman">
<li>Modéliser le critère de jugement en fonction des deux expositions d’intérêt, de leur interaction et des facteurs de confusion
<span class="math display">\[\begin{equation*}
  \overline{Q}(A_1,A_2,L) = \mathbb{E}(Y | A_1, A_2, L_1,L_2,L_3)
\end{equation*}\]</span></li>
<li>A partir de ce modèle <span class="math inline">\(\overline{Q}\)</span>, estimer pour chaque individu <span class="math inline">\(i\)</span> les valeurs moyennes attendues (contrefactuelles) <span class="math inline">\(\overline{Q}_i(0,0,L)\)</span>, <span class="math inline">\(\overline{Q}_i(1,0,L)\)</span>, <span class="math inline">\(\overline{Q}_i(0,1,L)\)</span> et <span class="math inline">\(\overline{Q}_i(1,1,L)\)</span>, sous les 4 scénarios possibles <span class="math inline">\(\{A_1 = 0, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 1, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 0, A_2 = 1\}\)</span> et <span class="math inline">\(\{A_1 = 1, A_2 = 1\}\)</span>.</li>
<li>Utiliser les moyennes contrefactuelles estimées pour calculer les différents indicateurs d’intérêt pour l’analyse d’interaction :</li>
</ol>
<ul>
<li><p>Les moyennes marginales pour chaque case du tableau d’interaction
<span class="math display">\[\begin{align*}
p_{00} &amp;= \frac{1}{n} \sum \overline{Q}_i(0,0,L) \\
p_{10} &amp;= \frac{1}{n} \sum \overline{Q}_i(1,0,L) \\
p_{01} &amp;= \frac{1}{n} \sum \overline{Q}_i(0,1,L) \\
p_{11} &amp;= \frac{1}{n} \sum \overline{Q}_i(1,1,L)
\end{align*}\]</span></p></li>
<li><p>Les différences de risques marginales
<span class="math display">\[\begin{align*}
DR(A_1, A_2 = 0) &amp;= p_{10} - p_{00} \\
DR(A_1, A_2 = 1) &amp;= p_{11} - p_{01} \\
DR(A_2, A_1 = 0) &amp;= p_{01} - p_{00} \\
DR(A_2, A_1 = 1) &amp;= p_{11} - p_{10}
\end{align*}\]</span></p></li>
<li><p>Les risques relatifs marginaux
<span class="math display">\[\begin{align*}
RR(A_1, A_2 = 0) &amp;= p_{10} / p_{00} \\
RR(A_1, A_2 = 1) &amp;= p_{11} / p_{01} \\
RR(A_2, A_1 = 0) &amp;= p_{01} / p_{00} \\
RR(A_2, A_1 = 1) &amp;= p_{11} / p_{10}
\end{align*}\]</span></p></li>
<li><p>Les mesures d’interaction
<span class="math display">\[\begin{align*}
MI &amp;= \frac{p_{11} \times p_{00}}{p_{10} \times p_{01}} \\
AI &amp;= p_{11} - p_{10} - p_{01} + p_{00} \\
RERI &amp;= \frac{p_{11} - p_{10} - p_{01} + p_{00}}{p_{00}}
\end{align*}\]</span></p></li>
</ul>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="conf.html#cb8-1" tabindex="-1"></a><span class="do">## i) Modéliser le critère de jugement en fonction des deux expositions d&#39;intérêt, </span></span>
<span id="cb8-2"><a href="conf.html#cb8-2" tabindex="-1"></a><span class="do">##    de leur interaction et des facteurs de confusion</span></span>
<span id="cb8-3"><a href="conf.html#cb8-3" tabindex="-1"></a>    model.Y <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> L1 <span class="sc">+</span> L2 <span class="sc">+</span> L3 <span class="sc">+</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2, <span class="at">data =</span> df, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb8-4"><a href="conf.html#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="conf.html#cb8-5" tabindex="-1"></a>    <span class="co"># dans cette exemple, les données étaient simulées à partir d&#39;un modèle additif, </span></span>
<span id="cb8-6"><a href="conf.html#cb8-6" tabindex="-1"></a>    <span class="co"># le modèle plus adapté serait donc plutôt le suivant : </span></span>
<span id="cb8-7"><a href="conf.html#cb8-7" tabindex="-1"></a>    <span class="co"># model.Y &lt;- glm(Y ~ L1 + L2 + L3 + A1 + A2 + A1:A2, data = df,</span></span>
<span id="cb8-8"><a href="conf.html#cb8-8" tabindex="-1"></a>    <span class="co">#                family = &quot;gaussian&quot;) </span></span>
<span id="cb8-9"><a href="conf.html#cb8-9" tabindex="-1"></a>    <span class="co"># (en pratique, on ne connaît pas la nature du modèle générateur des données)</span></span>
<span id="cb8-10"><a href="conf.html#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="conf.html#cb8-11" tabindex="-1"></a><span class="do">## ii) Estimer les valeurs attendues sous les 4 scenarios contrefactuels</span></span>
<span id="cb8-12"><a href="conf.html#cb8-12" tabindex="-1"></a><span class="do">## ii.a) on crée 4 bases de données correspondant aux 4 scenarios contrefactuels</span></span>
<span id="cb8-13"><a href="conf.html#cb8-13" tabindex="-1"></a>    df.A1_0.A2_0 <span class="ot">&lt;-</span> df.A1_1.A2_0 <span class="ot">&lt;-</span> df.A1_0.A2_1 <span class="ot">&lt;-</span> df.A1_1.A2_1 <span class="ot">&lt;-</span> df</span>
<span id="cb8-14"><a href="conf.html#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="conf.html#cb8-15" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 0, A2 = 0) pour toute la population</span></span>
<span id="cb8-16"><a href="conf.html#cb8-16" tabindex="-1"></a>    df.A1_0.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> df.A1_0.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-17"><a href="conf.html#cb8-17" tabindex="-1"></a>    </span>
<span id="cb8-18"><a href="conf.html#cb8-18" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 1, A2 = 0) pour toute la population</span></span>
<span id="cb8-19"><a href="conf.html#cb8-19" tabindex="-1"></a>    df.A1_1.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-20"><a href="conf.html#cb8-20" tabindex="-1"></a>    df.A1_1.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-21"><a href="conf.html#cb8-21" tabindex="-1"></a>    </span>
<span id="cb8-22"><a href="conf.html#cb8-22" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 0, A2 = 1) pour toute la population</span></span>
<span id="cb8-23"><a href="conf.html#cb8-23" tabindex="-1"></a>    df.A1_0.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-24"><a href="conf.html#cb8-24" tabindex="-1"></a>    df.A1_0.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-25"><a href="conf.html#cb8-25" tabindex="-1"></a></span>
<span id="cb8-26"><a href="conf.html#cb8-26" tabindex="-1"></a>    <span class="co"># scénario do(A1 = 1, A2 = 1) pour toute la population</span></span>
<span id="cb8-27"><a href="conf.html#cb8-27" tabindex="-1"></a>    df.A1_1.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> df.A1_1.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-28"><a href="conf.html#cb8-28" tabindex="-1"></a></span>
<span id="cb8-29"><a href="conf.html#cb8-29" tabindex="-1"></a><span class="do">## ii.b) on prédit le critère de jugement sous les scenarios contrefactuels</span></span>
<span id="cb8-30"><a href="conf.html#cb8-30" tabindex="-1"></a>    Qbar_00 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_0.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-31"><a href="conf.html#cb8-31" tabindex="-1"></a>    Qbar_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_1.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-32"><a href="conf.html#cb8-32" tabindex="-1"></a>    Qbar_01 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_0.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-33"><a href="conf.html#cb8-33" tabindex="-1"></a>    Qbar_11 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> df.A1_1.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-34"><a href="conf.html#cb8-34" tabindex="-1"></a></span>
<span id="cb8-35"><a href="conf.html#cb8-35" tabindex="-1"></a>    </span>
<span id="cb8-36"><a href="conf.html#cb8-36" tabindex="-1"></a><span class="do">## iii) Utiliser les moyennes contrefactuelles estimées pour calculer les différents </span></span>
<span id="cb8-37"><a href="conf.html#cb8-37" tabindex="-1"></a><span class="do">##      indicateurs d&#39;intérêt pour l&#39;analyse d&#39;interaction</span></span>
<span id="cb8-38"><a href="conf.html#cb8-38" tabindex="-1"></a><span class="do">## iii.a) on va enregistrer l&#39;ensemble des résultats pertinents dans une table &#39;int.r&#39;</span></span>
<span id="cb8-39"><a href="conf.html#cb8-39" tabindex="-1"></a><span class="do">##        de longueur 2 x 2</span></span>
<span id="cb8-40"><a href="conf.html#cb8-40" tabindex="-1"></a>    int.r <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,</span>
<span id="cb8-41"><a href="conf.html#cb8-41" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">26</span>,</span>
<span id="cb8-42"><a href="conf.html#cb8-42" tabindex="-1"></a>                    <span class="at">nrow =</span> <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>A1)) <span class="sc">*</span> <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>A2)))</span>
<span id="cb8-43"><a href="conf.html#cb8-43" tabindex="-1"></a>    int.r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(int.r)</span>
<span id="cb8-44"><a href="conf.html#cb8-44" tabindex="-1"></a>    <span class="fu">names</span>(int.r) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>,<span class="st">&quot;p&quot;</span>,<span class="st">&quot;p.lo&quot;</span>,<span class="st">&quot;p.up&quot;</span>,</span>
<span id="cb8-45"><a href="conf.html#cb8-45" tabindex="-1"></a>                      <span class="st">&quot;RD.A1&quot;</span>,<span class="st">&quot;RD.A1.lo&quot;</span>,<span class="st">&quot;RD.A1.up&quot;</span>,<span class="st">&quot;RD.A2&quot;</span>,<span class="st">&quot;RD.A2.lo&quot;</span>,<span class="st">&quot;RD.A2.up&quot;</span>,</span>
<span id="cb8-46"><a href="conf.html#cb8-46" tabindex="-1"></a>                      <span class="st">&quot;RR.A1&quot;</span>,<span class="st">&quot;RR.A1.lo&quot;</span>,<span class="st">&quot;RR.A1.up&quot;</span>,<span class="st">&quot;RR.A2&quot;</span>,<span class="st">&quot;RR.A2.lo&quot;</span>,<span class="st">&quot;RR.A2.up&quot;</span>,</span>
<span id="cb8-47"><a href="conf.html#cb8-47" tabindex="-1"></a>                      <span class="st">&quot;a.INT&quot;</span>, <span class="st">&quot;a.INT.lo&quot;</span>, <span class="st">&quot;a.INT.up&quot;</span>,<span class="st">&quot;RERI&quot;</span>,<span class="st">&quot;RERI.lo&quot;</span>,<span class="st">&quot;RERI.up&quot;</span>,</span>
<span id="cb8-48"><a href="conf.html#cb8-48" tabindex="-1"></a>                      <span class="st">&quot;m.INT&quot;</span>, <span class="st">&quot;m.INT.lo&quot;</span>, <span class="st">&quot;m.INT.up&quot;</span> )</span>
<span id="cb8-49"><a href="conf.html#cb8-49" tabindex="-1"></a>    int.r[,<span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb8-50"><a href="conf.html#cb8-50" tabindex="-1"></a></span>
<span id="cb8-51"><a href="conf.html#cb8-51" tabindex="-1"></a><span class="do">## iii.b) Les moyennes marginales pour chaque case du tableau d’interaction</span></span>
<span id="cb8-52"><a href="conf.html#cb8-52" tabindex="-1"></a><span class="co"># dans chaque case de la table 2 x 2</span></span>
<span id="cb8-53"><a href="conf.html#cb8-53" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb8-54"><a href="conf.html#cb8-54" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-55"><a href="conf.html#cb8-55" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb8-56"><a href="conf.html#cb8-56" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-57"><a href="conf.html#cb8-57" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb8-58"><a href="conf.html#cb8-58" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-59"><a href="conf.html#cb8-59" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb8-60"><a href="conf.html#cb8-60" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11)</span>
<span id="cb8-61"><a href="conf.html#cb8-61" tabindex="-1"></a></span>
<span id="cb8-62"><a href="conf.html#cb8-62" tabindex="-1"></a><span class="do">## iii.c) Les différences de risques marginales</span></span>
<span id="cb8-63"><a href="conf.html#cb8-63" tabindex="-1"></a>    <span class="co"># RD.A1.A2is0</span></span>
<span id="cb8-64"><a href="conf.html#cb8-64" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-65"><a href="conf.html#cb8-65" tabindex="-1"></a>    <span class="co"># RD.A1.A2is1</span></span>
<span id="cb8-66"><a href="conf.html#cb8-66" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-67"><a href="conf.html#cb8-67" tabindex="-1"></a>    <span class="co"># RD.A2.A1is0</span></span>
<span id="cb8-68"><a href="conf.html#cb8-68" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-69"><a href="conf.html#cb8-69" tabindex="-1"></a>    <span class="co"># RD.A2.A1is1</span></span>
<span id="cb8-70"><a href="conf.html#cb8-70" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-71"><a href="conf.html#cb8-71" tabindex="-1"></a></span>
<span id="cb8-72"><a href="conf.html#cb8-72" tabindex="-1"></a><span class="do">## iii.d) Les risques relatifs marginaux</span></span>
<span id="cb8-73"><a href="conf.html#cb8-73" tabindex="-1"></a>    <span class="co"># RR.A1.A2is0</span></span>
<span id="cb8-74"><a href="conf.html#cb8-74" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-75"><a href="conf.html#cb8-75" tabindex="-1"></a>    <span class="co"># RR.A1.A2is1</span></span>
<span id="cb8-76"><a href="conf.html#cb8-76" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-77"><a href="conf.html#cb8-77" tabindex="-1"></a>    <span class="co"># RR.A2.A1is0</span></span>
<span id="cb8-78"><a href="conf.html#cb8-78" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-79"><a href="conf.html#cb8-79" tabindex="-1"></a>    <span class="co"># RR.A2.A1is1</span></span>
<span id="cb8-80"><a href="conf.html#cb8-80" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-81"><a href="conf.html#cb8-81" tabindex="-1"></a></span>
<span id="cb8-82"><a href="conf.html#cb8-82" tabindex="-1"></a><span class="do">## iii.e) Les mesures d&#39;interaction</span></span>
<span id="cb8-83"><a href="conf.html#cb8-83" tabindex="-1"></a>    <span class="co"># additive interaction</span></span>
<span id="cb8-84"><a href="conf.html#cb8-84" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-85"><a href="conf.html#cb8-85" tabindex="-1"></a>                                                  <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span></span>
<span id="cb8-86"><a href="conf.html#cb8-86" tabindex="-1"></a>                                                  <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span></span>
<span id="cb8-87"><a href="conf.html#cb8-87" tabindex="-1"></a>                                                  <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-88"><a href="conf.html#cb8-88" tabindex="-1"></a>    <span class="co"># RERI</span></span>
<span id="cb8-89"><a href="conf.html#cb8-89" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-90"><a href="conf.html#cb8-90" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span></span>
<span id="cb8-91"><a href="conf.html#cb8-91" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span></span>
<span id="cb8-92"><a href="conf.html#cb8-92" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_00)) <span class="sc">/</span></span>
<span id="cb8-93"><a href="conf.html#cb8-93" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-94"><a href="conf.html#cb8-94" tabindex="-1"></a>    <span class="co"># multiplicative interaction</span></span>
<span id="cb8-95"><a href="conf.html#cb8-95" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(Qbar_11) <span class="sc">*</span></span>
<span id="cb8-96"><a href="conf.html#cb8-96" tabindex="-1"></a>                                                   <span class="fu">mean</span>(Qbar_00)) <span class="sc">/</span></span>
<span id="cb8-97"><a href="conf.html#cb8-97" tabindex="-1"></a>                                                   (<span class="fu">mean</span>(Qbar_10) <span class="sc">*</span></span>
<span id="cb8-98"><a href="conf.html#cb8-98" tabindex="-1"></a>                                                    <span class="fu">mean</span>(Qbar_01))</span>
<span id="cb8-99"><a href="conf.html#cb8-99" tabindex="-1"></a></span>
<span id="cb8-100"><a href="conf.html#cb8-100" tabindex="-1"></a></span>
<span id="cb8-101"><a href="conf.html#cb8-101" tabindex="-1"></a><span class="do">## iii.f) Calcul des intervalles de confiance </span></span>
<span id="cb8-102"><a href="conf.html#cb8-102" tabindex="-1"></a>    <span class="co"># Le script ci-dessous présente une méthode de bootstrap </span></span>
<span id="cb8-103"><a href="conf.html#cb8-103" tabindex="-1"></a>    <span class="co"># pour calculer les intervalles de confiance à 95% des différents indicateurs</span></span>
<span id="cb8-104"><a href="conf.html#cb8-104" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">5678</span>)</span>
<span id="cb8-105"><a href="conf.html#cb8-105" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># on utilise 1000 échantillons boostrap dans cet exemple</span></span>
<span id="cb8-106"><a href="conf.html#cb8-106" tabindex="-1"></a>    bootstrap.est <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> B, <span class="at">ncol =</span> <span class="dv">15</span>))</span>
<span id="cb8-107"><a href="conf.html#cb8-107" tabindex="-1"></a>    <span class="fu">colnames</span>(bootstrap.est) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p.A1is0.A2is0&quot;</span>, <span class="st">&quot;p.A1is1.A2is0&quot;</span>, </span>
<span id="cb8-108"><a href="conf.html#cb8-108" tabindex="-1"></a>                                 <span class="st">&quot;p.A1is0.A2is1&quot;</span>, <span class="st">&quot;p.A1is1.A2is1&quot;</span>,</span>
<span id="cb8-109"><a href="conf.html#cb8-109" tabindex="-1"></a>                                 <span class="st">&quot;RD.A1.A2is0&quot;</span>, <span class="st">&quot;RD.A1.A2is1&quot;</span>, </span>
<span id="cb8-110"><a href="conf.html#cb8-110" tabindex="-1"></a>                                 <span class="st">&quot;RD.A2.A1is0&quot;</span>, <span class="st">&quot;RD.A2.A1is1&quot;</span>,</span>
<span id="cb8-111"><a href="conf.html#cb8-111" tabindex="-1"></a>                                 <span class="st">&quot;lnRR.A1.A2is0&quot;</span>, <span class="st">&quot;lnRR.A1.A2is1&quot;</span>, </span>
<span id="cb8-112"><a href="conf.html#cb8-112" tabindex="-1"></a>                                 <span class="st">&quot;lnRR.A2.A1is0&quot;</span>, <span class="st">&quot;lnRR.A2.A1is1&quot;</span>,</span>
<span id="cb8-113"><a href="conf.html#cb8-113" tabindex="-1"></a>                                 <span class="st">&quot;INT.a&quot;</span>, <span class="st">&quot;lnRERI&quot;</span>, <span class="st">&quot;lnINT.m&quot;</span>)</span>
<span id="cb8-114"><a href="conf.html#cb8-114" tabindex="-1"></a></span>
<span id="cb8-115"><a href="conf.html#cb8-115" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){ <span class="co"># on refait toute l&#39;analyse dans chaque échantillon bootstrap</span></span>
<span id="cb8-116"><a href="conf.html#cb8-116" tabindex="-1"></a>      <span class="co"># constituer un échantillon bootstrap (échantillonnage avec remise)</span></span>
<span id="cb8-117"><a href="conf.html#cb8-117" tabindex="-1"></a>      bootIndices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df), <span class="at">replace=</span>T)</span>
<span id="cb8-118"><a href="conf.html#cb8-118" tabindex="-1"></a>      bootData <span class="ot">&lt;-</span> df[bootIndices,]</span>
<span id="cb8-119"><a href="conf.html#cb8-119" tabindex="-1"></a></span>
<span id="cb8-120"><a href="conf.html#cb8-120" tabindex="-1"></a>      <span class="cf">if</span> ( <span class="fu">round</span>(b<span class="sc">/</span><span class="dv">100</span>, <span class="dv">0</span>) <span class="sc">==</span> b<span class="sc">/</span><span class="dv">100</span> ) <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;bootstrap number &quot;</span>,b))</span>
<span id="cb8-121"><a href="conf.html#cb8-121" tabindex="-1"></a></span>
<span id="cb8-122"><a href="conf.html#cb8-122" tabindex="-1"></a>      <span class="co"># étape (i) de modélisation du critère de jugement</span></span>
<span id="cb8-123"><a href="conf.html#cb8-123" tabindex="-1"></a>      model.Y <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> L1 <span class="sc">+</span> L2 <span class="sc">+</span> L3 <span class="sc">+</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2,</span>
<span id="cb8-124"><a href="conf.html#cb8-124" tabindex="-1"></a>                     <span class="at">data =</span> bootData,                    <span class="co"># use BootData here +++</span></span>
<span id="cb8-125"><a href="conf.html#cb8-125" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb8-126"><a href="conf.html#cb8-126" tabindex="-1"></a></span>
<span id="cb8-127"><a href="conf.html#cb8-127" tabindex="-1"></a>      <span class="co"># étape (ii) d&#39;estimation des valeurs attendus sous les 4 scénarios contrefactuels</span></span>
<span id="cb8-128"><a href="conf.html#cb8-128" tabindex="-1"></a>      boot.A1_0.A2_0 <span class="ot">&lt;-</span> boot.A1_1.A2_0 <span class="ot">&lt;-</span> boot.A1_0.A2_1 <span class="ot">&lt;-</span> boot.A1_1.A2_1 <span class="ot">&lt;-</span> bootData</span>
<span id="cb8-129"><a href="conf.html#cb8-129" tabindex="-1"></a>      boot.A1_0.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> boot.A1_0.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-130"><a href="conf.html#cb8-130" tabindex="-1"></a>      boot.A1_1.A2_0<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-131"><a href="conf.html#cb8-131" tabindex="-1"></a>      boot.A1_1.A2_0<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-132"><a href="conf.html#cb8-132" tabindex="-1"></a>      boot.A1_0.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-133"><a href="conf.html#cb8-133" tabindex="-1"></a>      boot.A1_0.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-134"><a href="conf.html#cb8-134" tabindex="-1"></a>      boot.A1_1.A2_1<span class="sc">$</span>A1 <span class="ot">&lt;-</span> boot.A1_1.A2_1<span class="sc">$</span>A2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb8-135"><a href="conf.html#cb8-135" tabindex="-1"></a></span>
<span id="cb8-136"><a href="conf.html#cb8-136" tabindex="-1"></a>      <span class="co"># prédire les résultats contrefactuels sous les différents scénarios</span></span>
<span id="cb8-137"><a href="conf.html#cb8-137" tabindex="-1"></a>      Qbar_00 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_0.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-138"><a href="conf.html#cb8-138" tabindex="-1"></a>      Qbar_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_1.A2_0, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-139"><a href="conf.html#cb8-139" tabindex="-1"></a>      Qbar_01 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_0.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-140"><a href="conf.html#cb8-140" tabindex="-1"></a>      Qbar_11 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.Y, <span class="at">newdata =</span> boot.A1_1.A2_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-141"><a href="conf.html#cb8-141" tabindex="-1"></a></span>
<span id="cb8-142"><a href="conf.html#cb8-142" tabindex="-1"></a>      <span class="co"># étape (iii) de calcul des différents indicateurs d&#39;intérêt</span></span>
<span id="cb8-143"><a href="conf.html#cb8-143" tabindex="-1"></a>      <span class="co"># on sauve les résultats dans la table bootstrap.est</span></span>
<span id="cb8-144"><a href="conf.html#cb8-144" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is0.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-145"><a href="conf.html#cb8-145" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is1.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-146"><a href="conf.html#cb8-146" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is0.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-147"><a href="conf.html#cb8-147" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;p.A1is1.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11)</span>
<span id="cb8-148"><a href="conf.html#cb8-148" tabindex="-1"></a></span>
<span id="cb8-149"><a href="conf.html#cb8-149" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A1.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-150"><a href="conf.html#cb8-150" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A1.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01)</span>
<span id="cb8-151"><a href="conf.html#cb8-151" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A2.A1is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_00)</span>
<span id="cb8-152"><a href="conf.html#cb8-152" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;RD.A2.A1is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Qbar_11) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_10)</span>
<span id="cb8-153"><a href="conf.html#cb8-153" tabindex="-1"></a>      </span>
<span id="cb8-154"><a href="conf.html#cb8-154" tabindex="-1"></a>      <span class="co"># les Ic95% des RR sont d&#39;abord calculés sur une échelle logarithmique</span></span>
<span id="cb8-155"><a href="conf.html#cb8-155" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A1.A2is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_10) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-156"><a href="conf.html#cb8-156" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A1.A2is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_01))</span>
<span id="cb8-157"><a href="conf.html#cb8-157" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A2.A1is0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_01) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-158"><a href="conf.html#cb8-158" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRR.A2.A1is1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">mean</span>(Qbar_11) <span class="sc">/</span> <span class="fu">mean</span>(Qbar_10))</span>
<span id="cb8-159"><a href="conf.html#cb8-159" tabindex="-1"></a></span>
<span id="cb8-160"><a href="conf.html#cb8-160" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;INT.a&quot;</span>] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-161"><a href="conf.html#cb8-161" tabindex="-1"></a>                                     <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-162"><a href="conf.html#cb8-162" tabindex="-1"></a>      <span class="co"># les IC95% du RERI et de l&#39;interaction multiplicative sont d&#39;abord calculés</span></span>
<span id="cb8-163"><a href="conf.html#cb8-163" tabindex="-1"></a>      <span class="co"># sur une échelle logarithmique</span></span>
<span id="cb8-164"><a href="conf.html#cb8-164" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnRERI&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>((<span class="fu">mean</span>(Qbar_11) <span class="sc">-</span></span>
<span id="cb8-165"><a href="conf.html#cb8-165" tabindex="-1"></a>                                          <span class="fu">mean</span>(Qbar_10) <span class="sc">-</span> <span class="fu">mean</span>(Qbar_01) <span class="sc">+</span> <span class="fu">mean</span>(Qbar_00)) </span>
<span id="cb8-166"><a href="conf.html#cb8-166" tabindex="-1"></a>                                       <span class="sc">/</span> <span class="fu">mean</span>(Qbar_00))</span>
<span id="cb8-167"><a href="conf.html#cb8-167" tabindex="-1"></a>      bootstrap.est[b,<span class="st">&quot;lnINT.m&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>((<span class="fu">mean</span>(Qbar_11) <span class="sc">*</span> <span class="fu">mean</span>(Qbar_00)) <span class="sc">/</span> </span>
<span id="cb8-168"><a href="conf.html#cb8-168" tabindex="-1"></a>                                           (<span class="fu">mean</span>(Qbar_10) <span class="sc">*</span> <span class="fu">mean</span>(Qbar_01)))</span>
<span id="cb8-169"><a href="conf.html#cb8-169" tabindex="-1"></a>    }</span>
<span id="cb8-170"><a href="conf.html#cb8-170" tabindex="-1"></a>    </span>
<span id="cb8-171"><a href="conf.html#cb8-171" tabindex="-1"></a>    <span class="do">## On peut vérifier la normalité des distributions bootstrap avec le script </span></span>
<span id="cb8-172"><a href="conf.html#cb8-172" tabindex="-1"></a>    <span class="do">## proposé en commentaire ci-dessous :</span></span>
<span id="cb8-173"><a href="conf.html#cb8-173" tabindex="-1"></a>    </span>
<span id="cb8-174"><a href="conf.html#cb8-174" tabindex="-1"></a>    <span class="co"># par(mfrow = c(4,4))</span></span>
<span id="cb8-175"><a href="conf.html#cb8-175" tabindex="-1"></a>    <span class="co"># for(c in 1:ncol(bootstrap.est)) {</span></span>
<span id="cb8-176"><a href="conf.html#cb8-176" tabindex="-1"></a>    <span class="co">#   hist(bootstrap.est[,c], freq = FALSE, main = names(bootstrap.est)[c])</span></span>
<span id="cb8-177"><a href="conf.html#cb8-177" tabindex="-1"></a>    <span class="co">#   lines(density(bootstrap.est[,c]), col = 2, lwd = 3)</span></span>
<span id="cb8-178"><a href="conf.html#cb8-178" tabindex="-1"></a>    <span class="co">#   curve(1/sqrt(var(bootstrap.est[,c]) * 2 * pi) *</span></span>
<span id="cb8-179"><a href="conf.html#cb8-179" tabindex="-1"></a>    <span class="co">#           exp(-1/2 * ((x-mean(bootstrap.est[,c])) / sd(bootstrap.est[,c]))^2),</span></span>
<span id="cb8-180"><a href="conf.html#cb8-180" tabindex="-1"></a>    <span class="co">#         col = 1, lwd = 2, lty = 2, add = TRUE)</span></span>
<span id="cb8-181"><a href="conf.html#cb8-181" tabindex="-1"></a>    <span class="co"># par(mfrow = c(1,1))</span></span>
<span id="cb8-182"><a href="conf.html#cb8-182" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb8-183"><a href="conf.html#cb8-183" tabindex="-1"></a>    </span>
<span id="cb8-184"><a href="conf.html#cb8-184" tabindex="-1"></a>    <span class="co"># Les distributions ont bien une allure normale, on peut donc utiliser la </span></span>
<span id="cb8-185"><a href="conf.html#cb8-185" tabindex="-1"></a>    <span class="co"># déviation standard des distributions pour calculer les IC95%.</span></span>
<span id="cb8-186"><a href="conf.html#cb8-186" tabindex="-1"></a>    <span class="co"># En cas de distributions asymétriques, il serait préférable d&#39;utiliser les </span></span>
<span id="cb8-187"><a href="conf.html#cb8-187" tabindex="-1"></a>    <span class="co"># percentiles 2.5% et 97.5% (ou un méthode bootstrap BCa)</span></span>
<span id="cb8-188"><a href="conf.html#cb8-188" tabindex="-1"></a></span>
<span id="cb8-189"><a href="conf.html#cb8-189" tabindex="-1"></a><span class="do">## on calcule les IC95% et on les intègre dans la table de synthèse &#39;int.r&#39;</span></span>
<span id="cb8-190"><a href="conf.html#cb8-190" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb8-191"><a href="conf.html#cb8-191" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb8-192"><a href="conf.html#cb8-192" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is0)</span>
<span id="cb8-193"><a href="conf.html#cb8-193" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb8-194"><a href="conf.html#cb8-194" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is0)</span>
<span id="cb8-195"><a href="conf.html#cb8-195" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb8-196"><a href="conf.html#cb8-196" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb8-197"><a href="conf.html#cb8-197" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is0)</span>
<span id="cb8-198"><a href="conf.html#cb8-198" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb8-199"><a href="conf.html#cb8-199" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is0)</span>
<span id="cb8-200"><a href="conf.html#cb8-200" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb8-201"><a href="conf.html#cb8-201" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-202"><a href="conf.html#cb8-202" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is1)</span>
<span id="cb8-203"><a href="conf.html#cb8-203" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-204"><a href="conf.html#cb8-204" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is0.A2is1)</span>
<span id="cb8-205"><a href="conf.html#cb8-205" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb8-206"><a href="conf.html#cb8-206" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-207"><a href="conf.html#cb8-207" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is1)</span>
<span id="cb8-208"><a href="conf.html#cb8-208" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-209"><a href="conf.html#cb8-209" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>p.A1is1.A2is1)</span>
<span id="cb8-210"><a href="conf.html#cb8-210" tabindex="-1"></a></span>
<span id="cb8-211"><a href="conf.html#cb8-211" tabindex="-1"></a><span class="co"># risk difference</span></span>
<span id="cb8-212"><a href="conf.html#cb8-212" tabindex="-1"></a>    <span class="co"># RD.A1.A2is0</span></span>
<span id="cb8-213"><a href="conf.html#cb8-213" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-214"><a href="conf.html#cb8-214" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb8-215"><a href="conf.html#cb8-215" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is0))</span>
<span id="cb8-216"><a href="conf.html#cb8-216" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-217"><a href="conf.html#cb8-217" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb8-218"><a href="conf.html#cb8-218" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is0))</span>
<span id="cb8-219"><a href="conf.html#cb8-219" tabindex="-1"></a>    <span class="co"># RD.A1.A2is1</span></span>
<span id="cb8-220"><a href="conf.html#cb8-220" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-221"><a href="conf.html#cb8-221" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-222"><a href="conf.html#cb8-222" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is1))</span>
<span id="cb8-223"><a href="conf.html#cb8-223" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-224"><a href="conf.html#cb8-224" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-225"><a href="conf.html#cb8-225" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A1.A2is1))</span>
<span id="cb8-226"><a href="conf.html#cb8-226" tabindex="-1"></a>    <span class="co"># RD.A2.A1is0</span></span>
<span id="cb8-227"><a href="conf.html#cb8-227" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-228"><a href="conf.html#cb8-228" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-229"><a href="conf.html#cb8-229" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is0))</span>
<span id="cb8-230"><a href="conf.html#cb8-230" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-231"><a href="conf.html#cb8-231" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-232"><a href="conf.html#cb8-232" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is0))</span>
<span id="cb8-233"><a href="conf.html#cb8-233" tabindex="-1"></a>    <span class="co"># RD.A2.A1is1</span></span>
<span id="cb8-234"><a href="conf.html#cb8-234" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-235"><a href="conf.html#cb8-235" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-236"><a href="conf.html#cb8-236" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is1))</span>
<span id="cb8-237"><a href="conf.html#cb8-237" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-238"><a href="conf.html#cb8-238" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-239"><a href="conf.html#cb8-239" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>RD.A2.A1is1))</span>
<span id="cb8-240"><a href="conf.html#cb8-240" tabindex="-1"></a></span>
<span id="cb8-241"><a href="conf.html#cb8-241" tabindex="-1"></a><span class="co"># relative risk</span></span>
<span id="cb8-242"><a href="conf.html#cb8-242" tabindex="-1"></a>    <span class="co"># RR.A1.A2is0</span></span>
<span id="cb8-243"><a href="conf.html#cb8-243" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-244"><a href="conf.html#cb8-244" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb8-245"><a href="conf.html#cb8-245" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-246"><a href="conf.html#cb8-246" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is0))</span>
<span id="cb8-247"><a href="conf.html#cb8-247" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-248"><a href="conf.html#cb8-248" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">+</span></span>
<span id="cb8-249"><a href="conf.html#cb8-249" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-250"><a href="conf.html#cb8-250" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is0))</span>
<span id="cb8-251"><a href="conf.html#cb8-251" tabindex="-1"></a>    <span class="co"># RR.A1.A2is1</span></span>
<span id="cb8-252"><a href="conf.html#cb8-252" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-253"><a href="conf.html#cb8-253" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-254"><a href="conf.html#cb8-254" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-255"><a href="conf.html#cb8-255" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is1))</span>
<span id="cb8-256"><a href="conf.html#cb8-256" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-257"><a href="conf.html#cb8-257" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-258"><a href="conf.html#cb8-258" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-259"><a href="conf.html#cb8-259" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A1.A2is1))</span>
<span id="cb8-260"><a href="conf.html#cb8-260" tabindex="-1"></a>    <span class="co"># RR.A2.A1is0</span></span>
<span id="cb8-261"><a href="conf.html#cb8-261" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-262"><a href="conf.html#cb8-262" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-263"><a href="conf.html#cb8-263" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-264"><a href="conf.html#cb8-264" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is0))</span>
<span id="cb8-265"><a href="conf.html#cb8-265" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb8-266"><a href="conf.html#cb8-266" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-267"><a href="conf.html#cb8-267" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-268"><a href="conf.html#cb8-268" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is0))</span>
<span id="cb8-269"><a href="conf.html#cb8-269" tabindex="-1"></a>    <span class="co"># RR.A2.A1is1</span></span>
<span id="cb8-270"><a href="conf.html#cb8-270" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-271"><a href="conf.html#cb8-271" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-272"><a href="conf.html#cb8-272" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-273"><a href="conf.html#cb8-273" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is1))</span>
<span id="cb8-274"><a href="conf.html#cb8-274" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-275"><a href="conf.html#cb8-275" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-276"><a href="conf.html#cb8-276" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> </span>
<span id="cb8-277"><a href="conf.html#cb8-277" tabindex="-1"></a>                                             <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRR.A2.A1is1))</span>
<span id="cb8-278"><a href="conf.html#cb8-278" tabindex="-1"></a></span>
<span id="cb8-279"><a href="conf.html#cb8-279" tabindex="-1"></a><span class="co"># additive interaction</span></span>
<span id="cb8-280"><a href="conf.html#cb8-280" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-281"><a href="conf.html#cb8-281" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb8-282"><a href="conf.html#cb8-282" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>INT.a))</span>
<span id="cb8-283"><a href="conf.html#cb8-283" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-284"><a href="conf.html#cb8-284" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> (int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb8-285"><a href="conf.html#cb8-285" tabindex="-1"></a>                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>INT.a))</span>
<span id="cb8-286"><a href="conf.html#cb8-286" tabindex="-1"></a><span class="co"># RERI</span></span>
<span id="cb8-287"><a href="conf.html#cb8-287" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-288"><a href="conf.html#cb8-288" tabindex="-1"></a>                    int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-289"><a href="conf.html#cb8-289" tabindex="-1"></a>                                            <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRERI))</span>
<span id="cb8-290"><a href="conf.html#cb8-290" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-291"><a href="conf.html#cb8-291" tabindex="-1"></a>                    int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-292"><a href="conf.html#cb8-292" tabindex="-1"></a>                                            <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnRERI))</span>
<span id="cb8-293"><a href="conf.html#cb8-293" tabindex="-1"></a><span class="co"># multiplicative interaction</span></span>
<span id="cb8-294"><a href="conf.html#cb8-294" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-295"><a href="conf.html#cb8-295" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb8-296"><a href="conf.html#cb8-296" tabindex="-1"></a>                                             <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnINT.m))</span>
<span id="cb8-297"><a href="conf.html#cb8-297" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb8-298"><a href="conf.html#cb8-298" tabindex="-1"></a>                     int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb8-299"><a href="conf.html#cb8-299" tabindex="-1"></a>                                             <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> <span class="fu">sd</span>(bootstrap.est<span class="sc">$</span>lnINT.m))</span></code></pre></div>
<p>Au final, on a :</p>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="conf.html#cb9-1" tabindex="-1"></a><span class="do">## On peut présenter les différents résultats dans un tableau des effets marginaux</span></span>
<span id="cb9-2"><a href="conf.html#cb9-2" tabindex="-1"></a>    out.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">c1 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>), <span class="at">c2 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>), <span class="at">c3 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>), <span class="at">c4 =</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb9-3"><a href="conf.html#cb9-3" tabindex="-1"></a>    <span class="fu">names</span>(out.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A2=0&quot;</span>, <span class="st">&quot;A2=1&quot;</span>, <span class="st">&quot;RD.A2|A1&quot;</span>, <span class="st">&quot;RR.A2|A1&quot;</span>)</span>
<span id="cb9-4"><a href="conf.html#cb9-4" tabindex="-1"></a>    <span class="fu">rownames</span>(out.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1=0&quot;</span>, <span class="st">&quot;A1=1&quot;</span>, <span class="st">&quot;RD.A1|A2&quot;</span>, <span class="st">&quot;RR.A1|A2&quot;</span>)</span>
<span id="cb9-5"><a href="conf.html#cb9-5" tabindex="-1"></a><span class="co"># p</span></span>
<span id="cb9-6"><a href="conf.html#cb9-6" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{00}$=&quot;</span>,</span>
<span id="cb9-7"><a href="conf.html#cb9-7" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-8"><a href="conf.html#cb9-8" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-9"><a href="conf.html#cb9-9" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-10"><a href="conf.html#cb9-10" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-11"><a href="conf.html#cb9-11" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-12"><a href="conf.html#cb9-12" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-13"><a href="conf.html#cb9-13" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{01}$=&quot;</span>,<span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-14"><a href="conf.html#cb9-14" tabindex="-1"></a>                                                                         int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-15"><a href="conf.html#cb9-15" tabindex="-1"></a>                                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-16"><a href="conf.html#cb9-16" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-17"><a href="conf.html#cb9-17" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-18"><a href="conf.html#cb9-18" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-19"><a href="conf.html#cb9-19" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-20"><a href="conf.html#cb9-20" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{10}$=&quot;</span>,<span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-21"><a href="conf.html#cb9-21" tabindex="-1"></a>                                                                         int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-22"><a href="conf.html#cb9-22" tabindex="-1"></a>                                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-23"><a href="conf.html#cb9-23" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-24"><a href="conf.html#cb9-24" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-25"><a href="conf.html#cb9-25" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb9-26"><a href="conf.html#cb9-26" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-27"><a href="conf.html#cb9-27" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;$p_{11}$=&quot;</span>,<span class="fu">round</span>(int.r<span class="sc">$</span>p[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-28"><a href="conf.html#cb9-28" tabindex="-1"></a>                                                                         int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-29"><a href="conf.html#cb9-29" tabindex="-1"></a>                                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-30"><a href="conf.html#cb9-30" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-31"><a href="conf.html#cb9-31" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-32"><a href="conf.html#cb9-32" tabindex="-1"></a>                                       <span class="fu">round</span>(int.r<span class="sc">$</span>p.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-33"><a href="conf.html#cb9-33" tabindex="-1"></a>                                             <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-34"><a href="conf.html#cb9-34" tabindex="-1"></a><span class="co"># RD</span></span>
<span id="cb9-35"><a href="conf.html#cb9-35" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;RD.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-36"><a href="conf.html#cb9-36" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-37"><a href="conf.html#cb9-37" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-38"><a href="conf.html#cb9-38" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-39"><a href="conf.html#cb9-39" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-40"><a href="conf.html#cb9-40" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-41"><a href="conf.html#cb9-41" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-42"><a href="conf.html#cb9-42" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-43"><a href="conf.html#cb9-43" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-44"><a href="conf.html#cb9-44" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;RD.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-45"><a href="conf.html#cb9-45" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-46"><a href="conf.html#cb9-46" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-47"><a href="conf.html#cb9-47" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-48"><a href="conf.html#cb9-48" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-49"><a href="conf.html#cb9-49" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-50"><a href="conf.html#cb9-50" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-51"><a href="conf.html#cb9-51" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-52"><a href="conf.html#cb9-52" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-53"><a href="conf.html#cb9-53" tabindex="-1"></a>    out.table[<span class="st">&quot;RD.A1|A2&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-54"><a href="conf.html#cb9-54" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-55"><a href="conf.html#cb9-55" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-56"><a href="conf.html#cb9-56" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-57"><a href="conf.html#cb9-57" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-58"><a href="conf.html#cb9-58" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-59"><a href="conf.html#cb9-59" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-60"><a href="conf.html#cb9-60" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-61"><a href="conf.html#cb9-61" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-62"><a href="conf.html#cb9-62" tabindex="-1"></a>    out.table[<span class="st">&quot;RD.A1|A2&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-63"><a href="conf.html#cb9-63" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-64"><a href="conf.html#cb9-64" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-65"><a href="conf.html#cb9-65" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-66"><a href="conf.html#cb9-66" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-67"><a href="conf.html#cb9-67" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-68"><a href="conf.html#cb9-68" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RD.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-69"><a href="conf.html#cb9-69" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-70"><a href="conf.html#cb9-70" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-71"><a href="conf.html#cb9-71" tabindex="-1"></a></span>
<span id="cb9-72"><a href="conf.html#cb9-72" tabindex="-1"></a><span class="co"># RR</span></span>
<span id="cb9-73"><a href="conf.html#cb9-73" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=0&quot;</span>,<span class="st">&quot;RR.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-74"><a href="conf.html#cb9-74" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-75"><a href="conf.html#cb9-75" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-76"><a href="conf.html#cb9-76" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-77"><a href="conf.html#cb9-77" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-78"><a href="conf.html#cb9-78" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-79"><a href="conf.html#cb9-79" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb9-80"><a href="conf.html#cb9-80" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-81"><a href="conf.html#cb9-81" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-82"><a href="conf.html#cb9-82" tabindex="-1"></a>    out.table[<span class="st">&quot;A1=1&quot;</span>,<span class="st">&quot;RR.A2|A1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-83"><a href="conf.html#cb9-83" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-84"><a href="conf.html#cb9-84" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-85"><a href="conf.html#cb9-85" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-86"><a href="conf.html#cb9-86" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-87"><a href="conf.html#cb9-87" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-88"><a href="conf.html#cb9-88" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A2.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-89"><a href="conf.html#cb9-89" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-90"><a href="conf.html#cb9-90" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-91"><a href="conf.html#cb9-91" tabindex="-1"></a>    out.table[<span class="st">&quot;RR.A1|A2&quot;</span>,<span class="st">&quot;A2=0&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-92"><a href="conf.html#cb9-92" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-93"><a href="conf.html#cb9-93" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-94"><a href="conf.html#cb9-94" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-95"><a href="conf.html#cb9-95" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-96"><a href="conf.html#cb9-96" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-97"><a href="conf.html#cb9-97" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-98"><a href="conf.html#cb9-98" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">0</span>)],</span>
<span id="cb9-99"><a href="conf.html#cb9-99" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-100"><a href="conf.html#cb9-100" tabindex="-1"></a>    out.table[<span class="st">&quot;RR.A1|A2&quot;</span>,<span class="st">&quot;A2=1&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-101"><a href="conf.html#cb9-101" tabindex="-1"></a>                                                                     int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-102"><a href="conf.html#cb9-102" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-103"><a href="conf.html#cb9-103" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-104"><a href="conf.html#cb9-104" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-105"><a href="conf.html#cb9-105" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>,</span>
<span id="cb9-106"><a href="conf.html#cb9-106" tabindex="-1"></a>                                           <span class="fu">round</span>(int.r<span class="sc">$</span>RR.A1.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb9-107"><a href="conf.html#cb9-107" tabindex="-1"></a>                                                                        int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb9-108"><a href="conf.html#cb9-108" tabindex="-1"></a>                                                 <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb9-109"><a href="conf.html#cb9-109" tabindex="-1"></a>    interaction.effects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;additive Interaction = &quot;</span>,</span>
<span id="cb9-110"><a href="conf.html#cb9-110" tabindex="-1"></a>                                   <span class="fu">round</span>(int.r<span class="sc">$</span>a.INT[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-111"><a href="conf.html#cb9-111" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-112"><a href="conf.html#cb9-112" tabindex="-1"></a>                                   <span class="fu">round</span>(int.r<span class="sc">$</span>a.INT.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-113"><a href="conf.html#cb9-113" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;;&quot;</span>,</span>
<span id="cb9-114"><a href="conf.html#cb9-114" tabindex="-1"></a>                                   <span class="fu">round</span>(int.r<span class="sc">$</span>a.INT.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-115"><a href="conf.html#cb9-115" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb9-116"><a href="conf.html#cb9-116" tabindex="-1"></a>                              <span class="fu">paste0</span>(<span class="st">&quot;RERI = &quot;</span>,</span>
<span id="cb9-117"><a href="conf.html#cb9-117" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>RERI[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-118"><a href="conf.html#cb9-118" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-119"><a href="conf.html#cb9-119" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>RERI.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-120"><a href="conf.html#cb9-120" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;;&quot;</span>,</span>
<span id="cb9-121"><a href="conf.html#cb9-121" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>RERI.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-122"><a href="conf.html#cb9-122" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb9-123"><a href="conf.html#cb9-123" tabindex="-1"></a>                              <span class="fu">paste0</span>(<span class="st">&quot;multiplicative Interaction = &quot;</span>,</span>
<span id="cb9-124"><a href="conf.html#cb9-124" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>m.INT[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-125"><a href="conf.html#cb9-125" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot; [&quot;</span>,</span>
<span id="cb9-126"><a href="conf.html#cb9-126" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>m.INT.lo[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-127"><a href="conf.html#cb9-127" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;;&quot;</span>,</span>
<span id="cb9-128"><a href="conf.html#cb9-128" tabindex="-1"></a>                                     <span class="fu">round</span>(int.r<span class="sc">$</span>m.INT.up[<span class="fu">which</span>(int.r<span class="sc">$</span>A1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb9-129"><a href="conf.html#cb9-129" tabindex="-1"></a>                                           <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;]&quot;</span>))</span>
<span id="cb9-130"><a href="conf.html#cb9-130" tabindex="-1"></a></span>
<span id="cb9-131"><a href="conf.html#cb9-131" tabindex="-1"></a>    <span class="fu">library</span>(kableExtra)</span>
<span id="cb9-132"><a href="conf.html#cb9-132" tabindex="-1"></a>    <span class="fu">kbl</span>(out.table) <span class="sc">%&gt;%</span></span>
<span id="cb9-133"><a href="conf.html#cb9-133" tabindex="-1"></a>      <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-134"><a href="conf.html#cb9-134" tabindex="-1"></a>      <span class="fu">footnote</span>(<span class="at">general =</span> interaction.effects)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A2=0
</th>
<th style="text-align:left;">
A2=1
</th>
<th style="text-align:left;">
RD.A2|A1
</th>
<th style="text-align:left;">
RR.A2|A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1=0
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{00}\)</span>=0.104 [0.094,0.113]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{01}\)</span>=0.197 [0.182,0.212]
</td>
<td style="text-align:left;">
0.093 [0.076,0.11]
</td>
<td style="text-align:left;">
1.9 [1.7,2.13]
</td>
</tr>
<tr>
<td style="text-align:left;">
A1=1
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{10}\)</span>=0.4 [0.373,0.427]
</td>
<td style="text-align:left;">
<span class="math inline">\(p_{11}\)</span>=0.893 [0.872,0.915]
</td>
<td style="text-align:left;">
0.494 [0.46,0.527]
</td>
<td style="text-align:left;">
2.23 [2.08,2.4]
</td>
</tr>
<tr>
<td style="text-align:left;">
RD.A1|A2
</td>
<td style="text-align:left;">
0.296 [0.268,0.325]
</td>
<td style="text-align:left;">
0.697 [0.67,0.723]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
RR.A1|A2
</td>
<td style="text-align:left;">
3.86 [3.44,4.33]
</td>
<td style="text-align:left;">
4.54 [4.19,4.91]
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> additive Interaction = 0.4 [0.362;0.438]
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> RERI = 3.86 [3.45;4.33]
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> multiplicative Interaction = 1.18 [1.03;1.34]
</td>
</tr>
</tfoot>
</table>
</div>
<div id="estimation-par-modèle-structurel-marginal" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Estimation par Modèle Structurel Marginal<a href="conf.html#estimation-par-modèle-structurel-marginal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Les différentes quantités causales d’intérêt dans une analyse d’interaction peuvent être définies à partir des paramètres d’un modèle structurel marginal (<em>marginal structural model</em>, noté MSM).</p>
<p>Un modèle structurel marginal est un modèle qui permet de synthétiser le lien entre les potential outcomes (critères de jugement contrefactuels) et les différentes variables d’exposition d’intérêt. Ils sont particulièrement utiles dès que l’exposition a une dimensionnalité qui est plus grande que la dimensionnalité d’une variable binaire (par exemple si l’exposition est une variable quantitative continue, ou lorsqu’il existe plusieurs variables d’exposition à prendre en compte, comme dans les analyses de la médiation ou les expositions longitudinales répétées dans le temps).</p>
<p>Dans l’analyse d’interaction entre deux variables binaires, on s’intéresse à 4 niveaux d’exposition <span class="math inline">\(\{A_1 = 0, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 1, A_2 = 0\}\)</span>, <span class="math inline">\(\{A_1 = 0, A_2 = 1\}\)</span> et <span class="math inline">\(\{A_1 = 1, A_2 = 1\}\)</span>. On peut synthétiser les liens entre le potential outcome <span class="math inline">\(Y_{A_1,A_2}\)</span> et les deux variables d’exposition à l’aide du MSM suivant, défini à partir de 4 paramètres <span class="math inline">\(\beta\)</span> :
<span class="math display" id="eq:MSMinteraction">\[\begin{equation}
  \mathbb{E}(Y_{A_1,A_2}) = \beta_0 + \beta_1 A_1 + \beta_2 A_2 + \beta_3 (A_1 \times A_2) \tag{10.1}
\end{equation}\]</span></p>
<p>On peut redéfinir nos quantités d’intérêt pour l’analyse d’interaction en fonction des paramètres de ce modèles structurel marginal :</p>
<ul>
<li><p>Les moyennes marginales pour chaque case du tableau d’interaction
<span class="math display">\[\begin{align*}
p_{00} &amp;= \beta_0 \\
p_{10} &amp;= \beta_0 + \beta_1 \\
p_{01} &amp;= \beta_0 + \beta_2 \\
p_{11} &amp;= \beta_0 + \beta_1 + \beta_2 + \beta_3
\end{align*}\]</span></p></li>
<li><p>Les différences de risque, risques relatifs et mesures d’interaction peuvent ensuite se calculer comme indiqué précédemment pour la g-computation.</p></li>
</ul>
<p>Les potential outcomes <span class="math inline">\(Y_{A_1,A_2}\)</span> ne peuvent pas être observés directement dans une étude observationnelles, on ne peut pas appliquer directement l’équation <a href="conf.html#eq:MSMinteraction">(10.1)</a> du MSM pour estimer les paramètres <span class="math inline">\(\beta\)</span>. Différentes méthodes peuvent être appliquées pour estimer ces coefficients <span class="math inline">\(\beta\)</span>, tout en prenant en compte les biais de confusion :</p>
<ul>
<li>estimation par IPTW (<em>Inverse probability of Treatment Weighting</em>), il s’agit probablement de la méthode la plus utilisée dans la littérature. Les biais de confusion sont pris en compte en appliquant une méthode de pondération aux différents participants. La pondération repose sur l’estimation des scores de propension <span class="math inline">\(g(A_1)\)</span> et <span class="math inline">\(g(A_2)\)</span> (les probabilités d’exposition à chaque variable d’intérêt <span class="math inline">\(A_1\)</span> et <span class="math inline">\(A_2\)</span>).</li>
<li>estimation par g-computation. Elle repose sur l’estimation de fonctions <span class="math inline">\(\overline{Q}\)</span> (modèles du critère de jugement)</li>
<li>estimation par TMLE (<em>Targeted maximum likelihood estimation</em>), il s’agit d’une méthode à double robustesse qui repose à la fois l’estimation des fonctions <span class="math inline">\(\overline{Q}\)</span> et des scores de propension (<span class="math inline">\(g(A_1)\)</span> et <span class="math inline">\(g(A_2)\)</span>). Cette méthode sera non-biaisée si au moins les fonctions <span class="math inline">\(\overline{Q}\)</span> ou les fonction <span class="math inline">\(g\)</span> ont été correctement estimées. L’approche par TMLE utilise des méthodes de machine learning pour estimer ces fonctions.</li>
</ul>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="conf.html#cb10-1" tabindex="-1"></a> <span class="co"># On récupère les Y prédit précédents, que l&#39;on fusionne</span></span>
<span id="cb10-2"><a href="conf.html#cb10-2" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">c</span>(Y.A1_0.A2_0, Y.A1_1.A2_0, Y.A1_0.A2_1, Y.A1_1.A2_1)</span>
<span id="cb10-3"><a href="conf.html#cb10-3" tabindex="-1"></a>    <span class="fu">length</span>(Y)</span>
<span id="cb10-4"><a href="conf.html#cb10-4" tabindex="-1"></a>    <span class="co"># on aura une base de données de 40000 lignes</span></span>
<span id="cb10-5"><a href="conf.html#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="conf.html#cb10-6" tabindex="-1"></a><span class="co"># On récupère les valeurs d&#39;exposition qui ont servi dans les scénarios contrefactuels</span></span>
<span id="cb10-7"><a href="conf.html#cb10-7" tabindex="-1"></a>    <span class="co"># (garder le même ordre que pour les Y.A1.A2)</span></span>
<span id="cb10-8"><a href="conf.html#cb10-8" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">subset</span>(df.A1_0.A2_0, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)),</span>
<span id="cb10-9"><a href="conf.html#cb10-9" tabindex="-1"></a>               <span class="fu">subset</span>(df.A1_1.A2_0, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)),</span>
<span id="cb10-10"><a href="conf.html#cb10-10" tabindex="-1"></a>               <span class="fu">subset</span>(df.A1_0.A2_1, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)),</span>
<span id="cb10-11"><a href="conf.html#cb10-11" tabindex="-1"></a>               <span class="fu">subset</span>(df.A1_1.A2_1, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>)))</span>
<span id="cb10-12"><a href="conf.html#cb10-12" tabindex="-1"></a>   <span class="co">#  dim(X)</span></span>
<span id="cb10-13"><a href="conf.html#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="conf.html#cb10-14" tabindex="-1"></a><span class="do">## Modèle structurel marginal</span></span>
<span id="cb10-15"><a href="conf.html#cb10-15" tabindex="-1"></a>    msm.RD <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> A1 <span class="sc">+</span> A2 <span class="sc">+</span> A1<span class="sc">:</span>A2,</span>
<span id="cb10-16"><a href="conf.html#cb10-16" tabindex="-1"></a>                  <span class="at">data =</span> <span class="fu">data.frame</span>(Y,X),</span>
<span id="cb10-17"><a href="conf.html#cb10-17" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>) <span class="co"># ne pas ajuster sur les facteurs de confusion</span></span>
<span id="cb10-18"><a href="conf.html#cb10-18" tabindex="-1"></a>    msm.RD</span>
<span id="cb10-19"><a href="conf.html#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="conf.html#cb10-20" tabindex="-1"></a><span class="do">## tableau des effets marignaux</span></span>
<span id="cb10-21"><a href="conf.html#cb10-21" tabindex="-1"></a>    results.MSM <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb10-22"><a href="conf.html#cb10-22" tabindex="-1"></a>    <span class="fu">colnames</span>(results.MSM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A2 = 0&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>,</span>
<span id="cb10-23"><a href="conf.html#cb10-23" tabindex="-1"></a>                               <span class="st">&quot;RD within strata of A1&quot;</span>,</span>
<span id="cb10-24"><a href="conf.html#cb10-24" tabindex="-1"></a>                               <span class="st">&quot;RR within strata of A1&quot;</span>)</span>
<span id="cb10-25"><a href="conf.html#cb10-25" tabindex="-1"></a>    <span class="fu">rownames</span>(results.MSM) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;A1 = 1&quot;</span>,</span>
<span id="cb10-26"><a href="conf.html#cb10-26" tabindex="-1"></a>                               <span class="st">&quot;RD within strata of A2&quot;</span>,</span>
<span id="cb10-27"><a href="conf.html#cb10-27" tabindex="-1"></a>                               <span class="st">&quot;RR within strata of A2&quot;</span>)</span>
<span id="cb10-28"><a href="conf.html#cb10-28" tabindex="-1"></a></span>
<span id="cb10-29"><a href="conf.html#cb10-29" tabindex="-1"></a><span class="co"># 4 risques marginaux</span></span>
<span id="cb10-30"><a href="conf.html#cb10-30" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb10-31"><a href="conf.html#cb10-31" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb10-32"><a href="conf.html#cb10-32" tabindex="-1"></a>      msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;A2&quot;</span>]</span>
<span id="cb10-33"><a href="conf.html#cb10-33" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb10-34"><a href="conf.html#cb10-34" tabindex="-1"></a>      msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;A1&quot;</span>]</span>
<span id="cb10-35"><a href="conf.html#cb10-35" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb10-36"><a href="conf.html#cb10-36" tabindex="-1"></a>      msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;A2&quot;</span>] <span class="sc">+</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;A1&quot;</span>] <span class="sc">+</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;A1:A2&quot;</span>]</span>
<span id="cb10-37"><a href="conf.html#cb10-37" tabindex="-1"></a></span>
<span id="cb10-38"><a href="conf.html#cb10-38" tabindex="-1"></a><span class="co"># within strata of A2</span></span>
<span id="cb10-39"><a href="conf.html#cb10-39" tabindex="-1"></a>    results.MSM[<span class="st">&quot;RR within strata of A2&quot;</span>, <span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-40"><a href="conf.html#cb10-40" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]</span>
<span id="cb10-41"><a href="conf.html#cb10-41" tabindex="-1"></a>    results.MSM[<span class="st">&quot;RD within strata of A2&quot;</span>, <span class="st">&quot;A2 = 0&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-42"><a href="conf.html#cb10-42" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]</span>
<span id="cb10-43"><a href="conf.html#cb10-43" tabindex="-1"></a>    results.MSM[<span class="st">&quot;RR within strata of A2&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-44"><a href="conf.html#cb10-44" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>]</span>
<span id="cb10-45"><a href="conf.html#cb10-45" tabindex="-1"></a>    results.MSM[<span class="st">&quot;RD within strata of A2&quot;</span>, <span class="st">&quot;A2 = 1&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-46"><a href="conf.html#cb10-46" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>]</span>
<span id="cb10-47"><a href="conf.html#cb10-47" tabindex="-1"></a></span>
<span id="cb10-48"><a href="conf.html#cb10-48" tabindex="-1"></a><span class="co"># within strata of A1</span></span>
<span id="cb10-49"><a href="conf.html#cb10-49" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;RR within strata of A1&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-50"><a href="conf.html#cb10-50" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]</span>
<span id="cb10-51"><a href="conf.html#cb10-51" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 0&quot;</span>, <span class="st">&quot;RD within strata of A1&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-52"><a href="conf.html#cb10-52" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]</span>
<span id="cb10-53"><a href="conf.html#cb10-53" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 1&quot;</span>, <span class="st">&quot;RR within strata of A1&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">/</span></span>
<span id="cb10-54"><a href="conf.html#cb10-54" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]</span>
<span id="cb10-55"><a href="conf.html#cb10-55" tabindex="-1"></a>    results.MSM[<span class="st">&quot;A1 = 1&quot;</span>, <span class="st">&quot;RD within strata of A1&quot;</span>] <span class="ot">&lt;-</span> results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">-</span></span>
<span id="cb10-56"><a href="conf.html#cb10-56" tabindex="-1"></a>      results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]</span>
<span id="cb10-57"><a href="conf.html#cb10-57" tabindex="-1"></a></span>
<span id="cb10-58"><a href="conf.html#cb10-58" tabindex="-1"></a>    results.MSM <span class="ot">&lt;-</span> <span class="fu">round</span>(results.MSM,<span class="dv">3</span>)</span>
<span id="cb10-59"><a href="conf.html#cb10-59" tabindex="-1"></a>    RD.interaction <span class="ot">&lt;-</span> msm.RD<span class="sc">$</span>coefficients[<span class="st">&quot;A1:A2&quot;</span>]</span>
<span id="cb10-60"><a href="conf.html#cb10-60" tabindex="-1"></a>    RR.interaction <span class="ot">&lt;-</span> (results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">*</span></span>
<span id="cb10-61"><a href="conf.html#cb10-61" tabindex="-1"></a>                         results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>]) <span class="sc">/</span></span>
<span id="cb10-62"><a href="conf.html#cb10-62" tabindex="-1"></a>                      ( results.MSM[<span class="st">&quot;A1 = 0&quot;</span>,<span class="st">&quot;A2 = 1&quot;</span>] <span class="sc">*</span></span>
<span id="cb10-63"><a href="conf.html#cb10-63" tabindex="-1"></a>                          results.MSM[<span class="st">&quot;A1 = 1&quot;</span>,<span class="st">&quot;A2 = 0&quot;</span>] )</span></code></pre></div>
<p>Au final, on a (sans les IC):</p>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
A2 = 0
</th>
<th style="text-align:right;">
A2 = 1
</th>
<th style="text-align:right;">
RD within strata of A1
</th>
<th style="text-align:right;">
RR within strata of A1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A1 = 0
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
0.198
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
1.851
</td>
</tr>
<tr>
<td style="text-align:left;">
A1 = 1
</td>
<td style="text-align:right;">
0.411
</td>
<td style="text-align:right;">
0.889
</td>
<td style="text-align:right;">
0.478
</td>
<td style="text-align:right;">
2.164
</td>
</tr>
<tr>
<td style="text-align:left;">
RD within strata of A2
</td>
<td style="text-align:right;">
0.303
</td>
<td style="text-align:right;">
0.690
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
RR within strata of A2
</td>
<td style="text-align:right;">
3.834
</td>
<td style="text-align:right;">
4.483
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> additive Interaction = 0.387
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> multiplicative Interaction = 1.17
</td>
</tr>
</tfoot>
</table>
</div>
<div id="estimation-avec-tmle" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Estimation avec TMLE<a href="conf.html#estimation-avec-tmle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: static; top: 1%; left: 2%; z-index: 200"></input>')

</script>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="conf.html#cb11-1" tabindex="-1"></a><span class="do">## 3- int.ltmleMSM()          pour estimer les différentes quantités d&#39;intérêt,</span></span>
<span id="cb11-2"><a href="conf.html#cb11-2" tabindex="-1"></a><span class="do">###                           par gcomputation, IPTW ou tmle</span></span>
<span id="cb11-3"><a href="conf.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="conf.html#cb11-4" tabindex="-1"></a>int.ltmleMSM <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> data,</span>
<span id="cb11-5"><a href="conf.html#cb11-5" tabindex="-1"></a>                         <span class="at">Q_formulas =</span> Q_formulas,</span>
<span id="cb11-6"><a href="conf.html#cb11-6" tabindex="-1"></a>                         <span class="at">g_formulas =</span> g_formulas,</span>
<span id="cb11-7"><a href="conf.html#cb11-7" tabindex="-1"></a>                         <span class="at">Anodes =</span> Anodes,</span>
<span id="cb11-8"><a href="conf.html#cb11-8" tabindex="-1"></a>                         <span class="at">Lnodes =</span> Lnodes,</span>
<span id="cb11-9"><a href="conf.html#cb11-9" tabindex="-1"></a>                         <span class="at">Ynodes =</span> Ynodes,</span>
<span id="cb11-10"><a href="conf.html#cb11-10" tabindex="-1"></a>                         <span class="at">final.Ynodes =</span> final.Ynodes,</span>
<span id="cb11-11"><a href="conf.html#cb11-11" tabindex="-1"></a>                         <span class="at">SL.library =</span> <span class="fu">list</span>(<span class="at">Q=</span><span class="st">&quot;SL.glm&quot;</span>,</span>
<span id="cb11-12"><a href="conf.html#cb11-12" tabindex="-1"></a>                                           <span class="at">g=</span><span class="st">&quot;SL.glm&quot;</span>),</span>
<span id="cb11-13"><a href="conf.html#cb11-13" tabindex="-1"></a>                         <span class="at">gcomp =</span> gcomp,</span>
<span id="cb11-14"><a href="conf.html#cb11-14" tabindex="-1"></a>                         <span class="at">iptw.only =</span> iptw.only,</span>
<span id="cb11-15"><a href="conf.html#cb11-15" tabindex="-1"></a>                         <span class="at">survivalOutcome =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-16"><a href="conf.html#cb11-16" tabindex="-1"></a>                         <span class="at">variance.method =</span> <span class="st">&quot;ic&quot;</span>,</span>
<span id="cb11-17"><a href="conf.html#cb11-17" tabindex="-1"></a>                         <span class="at">B =</span> <span class="dv">2000</span>,</span>
<span id="cb11-18"><a href="conf.html#cb11-18" tabindex="-1"></a>                         <span class="at">boot.seed =</span> <span class="dv">12345</span>) {</span>
<span id="cb11-19"><a href="conf.html#cb11-19" tabindex="-1"></a>  <span class="co"># regime=</span></span>
<span id="cb11-20"><a href="conf.html#cb11-20" tabindex="-1"></a>  <span class="co"># binary array: n x numAnodes x numRegimes of counterfactual treatment or a list of &#39;rule&#39; functions</span></span>
<span id="cb11-21"><a href="conf.html#cb11-21" tabindex="-1"></a>  regimes.MSM <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(data), <span class="dv">2</span>, <span class="dv">4</span>)) <span class="co"># 2 variables d&#39;exposition (A1, A2), 4 régimes d&#39;exposition (0,0) (1,0) (0,1) (1,1)</span></span>
<span id="cb11-22"><a href="conf.html#cb11-22" tabindex="-1"></a>  regimes.MSM[,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data), <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># exposé ni à A1, ni à A2</span></span>
<span id="cb11-23"><a href="conf.html#cb11-23" tabindex="-1"></a>  regimes.MSM[,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data), <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># exposé à A1 uniquement</span></span>
<span id="cb11-24"><a href="conf.html#cb11-24" tabindex="-1"></a>  regimes.MSM[,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data), <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># exposé à A2 uniquement</span></span>
<span id="cb11-25"><a href="conf.html#cb11-25" tabindex="-1"></a>  regimes.MSM[,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data), <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># exposé à A1 et à A2</span></span>
<span id="cb11-26"><a href="conf.html#cb11-26" tabindex="-1"></a></span>
<span id="cb11-27"><a href="conf.html#cb11-27" tabindex="-1"></a>  <span class="co"># summary.measures = valeurs des coefficients du MSM associés à chaque régime</span></span>
<span id="cb11-28"><a href="conf.html#cb11-28" tabindex="-1"></a>  <span class="co"># array: num.regimes x num.summary.measures x num.final.Ynodes -</span></span>
<span id="cb11-29"><a href="conf.html#cb11-29" tabindex="-1"></a>  <span class="co"># measures summarizing the regimes that will be used on the right hand side of working.msm</span></span>
<span id="cb11-30"><a href="conf.html#cb11-30" tabindex="-1"></a>  <span class="co"># (baseline covariates may also be used in the right hand side of working.msm and do not need to be included in summary.measures)</span></span>
<span id="cb11-31"><a href="conf.html#cb11-31" tabindex="-1"></a>  summary.measures.reg <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb11-32"><a href="conf.html#cb11-32" tabindex="-1"></a>  summary.measures.reg[,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="co"># aucun effet ni de A1, ni de A2</span></span>
<span id="cb11-33"><a href="conf.html#cb11-33" tabindex="-1"></a>                                        <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="co"># effet de A1 isolé</span></span>
<span id="cb11-34"><a href="conf.html#cb11-34" tabindex="-1"></a>                                        <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="co"># effet de A2 isolé</span></span>
<span id="cb11-35"><a href="conf.html#cb11-35" tabindex="-1"></a>                                        <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="co"># effet de A1 + A2 + A1:A2</span></span>
<span id="cb11-36"><a href="conf.html#cb11-36" tabindex="-1"></a>                                      <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-37"><a href="conf.html#cb11-37" tabindex="-1"></a>  <span class="fu">colnames</span>(summary.measures.reg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;A1:A2&quot;</span>)</span>
<span id="cb11-38"><a href="conf.html#cb11-38" tabindex="-1"></a></span>
<span id="cb11-39"><a href="conf.html#cb11-39" tabindex="-1"></a>  <span class="cf">if</span>(gcomp <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb11-40"><a href="conf.html#cb11-40" tabindex="-1"></a>    <span class="co"># test length SL.library$Q</span></span>
<span id="cb11-41"><a href="conf.html#cb11-41" tabindex="-1"></a>    SL.library<span class="sc">$</span>Q <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(SL.library<span class="sc">$</span>Q) <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="st">&quot;SL.glm&quot;</span>, SL.library<span class="sc">$</span>Q)</span>
<span id="cb11-42"><a href="conf.html#cb11-42" tabindex="-1"></a></span>
<span id="cb11-43"><a href="conf.html#cb11-43" tabindex="-1"></a>    <span class="co"># simplify SL.library$g because g functions are useless with g-computation</span></span>
<span id="cb11-44"><a href="conf.html#cb11-44" tabindex="-1"></a>    SL.library<span class="sc">$</span>g <span class="ot">&lt;-</span> <span class="st">&quot;SL.mean&quot;</span></span>
<span id="cb11-45"><a href="conf.html#cb11-45" tabindex="-1"></a></span>
<span id="cb11-46"><a href="conf.html#cb11-46" tabindex="-1"></a>    iptw.only <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb11-47"><a href="conf.html#cb11-47" tabindex="-1"></a>  }</span>
<span id="cb11-48"><a href="conf.html#cb11-48" tabindex="-1"></a></span>
<span id="cb11-49"><a href="conf.html#cb11-49" tabindex="-1"></a></span>
<span id="cb11-50"><a href="conf.html#cb11-50" tabindex="-1"></a>  ltmle_MSM <span class="ot">&lt;-</span> <span class="fu">ltmleMSM</span>(<span class="at">data =</span> data,</span>
<span id="cb11-51"><a href="conf.html#cb11-51" tabindex="-1"></a>                        <span class="at">Anodes =</span> Anodes,</span>
<span id="cb11-52"><a href="conf.html#cb11-52" tabindex="-1"></a>                        <span class="at">Lnodes =</span> Lnodes,</span>
<span id="cb11-53"><a href="conf.html#cb11-53" tabindex="-1"></a>                        <span class="at">Ynodes =</span> Ynodes,</span>
<span id="cb11-54"><a href="conf.html#cb11-54" tabindex="-1"></a>                        <span class="at">Qform =</span> Q_formulas,</span>
<span id="cb11-55"><a href="conf.html#cb11-55" tabindex="-1"></a>                        <span class="at">gform =</span> g_formulas,</span>
<span id="cb11-56"><a href="conf.html#cb11-56" tabindex="-1"></a>                        <span class="co">#deterministic.g.function = det.g,</span></span>
<span id="cb11-57"><a href="conf.html#cb11-57" tabindex="-1"></a>                        <span class="at">regimes =</span> regimes.MSM, <span class="co"># à la place de abar</span></span>
<span id="cb11-58"><a href="conf.html#cb11-58" tabindex="-1"></a>                        <span class="at">working.msm=</span> <span class="st">&quot;Y ~ A1 + A2 + A1:A2&quot;</span>,</span>
<span id="cb11-59"><a href="conf.html#cb11-59" tabindex="-1"></a>                        <span class="at">summary.measures =</span> summary.measures.reg,</span>
<span id="cb11-60"><a href="conf.html#cb11-60" tabindex="-1"></a>                        <span class="at">final.Ynodes =</span> final.Ynodes,</span>
<span id="cb11-61"><a href="conf.html#cb11-61" tabindex="-1"></a>                        <span class="at">msm.weights =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-62"><a href="conf.html#cb11-62" tabindex="-1"></a>                        <span class="at">SL.library =</span> SL.library,</span>
<span id="cb11-63"><a href="conf.html#cb11-63" tabindex="-1"></a>                        <span class="at">gcomp =</span> gcomp,</span>
<span id="cb11-64"><a href="conf.html#cb11-64" tabindex="-1"></a>                        <span class="at">iptw.only =</span> iptw.only,</span>
<span id="cb11-65"><a href="conf.html#cb11-65" tabindex="-1"></a>                        <span class="at">survivalOutcome =</span> survivalOutcome,</span>
<span id="cb11-66"><a href="conf.html#cb11-66" tabindex="-1"></a>                        <span class="at">estimate.time =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-67"><a href="conf.html#cb11-67" tabindex="-1"></a>                        <span class="at">variance.method =</span> variance.method)</span>
<span id="cb11-68"><a href="conf.html#cb11-68" tabindex="-1"></a></span>
<span id="cb11-69"><a href="conf.html#cb11-69" tabindex="-1"></a>  bootstrap.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;beta.Intercept&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B),</span>
<span id="cb11-70"><a href="conf.html#cb11-70" tabindex="-1"></a>                              <span class="st">&quot;beta.A1&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B),</span>
<span id="cb11-71"><a href="conf.html#cb11-71" tabindex="-1"></a>                              <span class="st">&quot;beta.A2&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B),</span>
<span id="cb11-72"><a href="conf.html#cb11-72" tabindex="-1"></a>                              <span class="st">&quot;beta.A1A2&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B))</span>
<span id="cb11-73"><a href="conf.html#cb11-73" tabindex="-1"></a></span>
<span id="cb11-74"><a href="conf.html#cb11-74" tabindex="-1"></a>  <span class="cf">if</span>(gcomp <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb11-75"><a href="conf.html#cb11-75" tabindex="-1"></a>    set.seed <span class="ot">&lt;-</span> boot.seed</span>
<span id="cb11-76"><a href="conf.html#cb11-76" tabindex="-1"></a></span>
<span id="cb11-77"><a href="conf.html#cb11-77" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb11-78"><a href="conf.html#cb11-78" tabindex="-1"></a>      <span class="co"># sample the indices 1 to n with replacement</span></span>
<span id="cb11-79"><a href="conf.html#cb11-79" tabindex="-1"></a>      bootIndices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">replace=</span>T)</span>
<span id="cb11-80"><a href="conf.html#cb11-80" tabindex="-1"></a>      bootData <span class="ot">&lt;-</span> data[bootIndices,]</span>
<span id="cb11-81"><a href="conf.html#cb11-81" tabindex="-1"></a></span>
<span id="cb11-82"><a href="conf.html#cb11-82" tabindex="-1"></a>      <span class="cf">if</span> ( <span class="fu">round</span>(b<span class="sc">/</span><span class="dv">100</span>, <span class="dv">0</span>) <span class="sc">==</span> b<span class="sc">/</span><span class="dv">100</span> ) <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;bootstrap number &quot;</span>,b))</span>
<span id="cb11-83"><a href="conf.html#cb11-83" tabindex="-1"></a></span>
<span id="cb11-84"><a href="conf.html#cb11-84" tabindex="-1"></a>      boot_ltmle_MSM <span class="ot">&lt;-</span> <span class="fu">ltmleMSM</span>(<span class="at">data =</span> bootData,</span>
<span id="cb11-85"><a href="conf.html#cb11-85" tabindex="-1"></a>                                 <span class="at">Anodes =</span> Anodes,</span>
<span id="cb11-86"><a href="conf.html#cb11-86" tabindex="-1"></a>                                 <span class="at">Lnodes =</span> Lnodes,</span>
<span id="cb11-87"><a href="conf.html#cb11-87" tabindex="-1"></a>                                 <span class="at">Ynodes =</span> Ynodes,</span>
<span id="cb11-88"><a href="conf.html#cb11-88" tabindex="-1"></a>                                 <span class="at">Qform =</span> Q_formulas,</span>
<span id="cb11-89"><a href="conf.html#cb11-89" tabindex="-1"></a>                                 <span class="at">gform =</span> g_formulas,</span>
<span id="cb11-90"><a href="conf.html#cb11-90" tabindex="-1"></a>                                 <span class="co">#deterministic.g.function = det.g,</span></span>
<span id="cb11-91"><a href="conf.html#cb11-91" tabindex="-1"></a>                                 <span class="at">regimes =</span> regimes.MSM, <span class="co"># à la place de abar</span></span>
<span id="cb11-92"><a href="conf.html#cb11-92" tabindex="-1"></a>                                 <span class="at">working.msm=</span> <span class="st">&quot;Y ~ A1 + A2 + A1:A2&quot;</span>,</span>
<span id="cb11-93"><a href="conf.html#cb11-93" tabindex="-1"></a>                                 <span class="at">summary.measures =</span> summary.measures.reg,</span>
<span id="cb11-94"><a href="conf.html#cb11-94" tabindex="-1"></a>                                 <span class="at">final.Ynodes =</span> final.Ynodes,</span>
<span id="cb11-95"><a href="conf.html#cb11-95" tabindex="-1"></a>                                 <span class="at">msm.weights =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-96"><a href="conf.html#cb11-96" tabindex="-1"></a>                                 <span class="at">SL.library =</span> SL.library,</span>
<span id="cb11-97"><a href="conf.html#cb11-97" tabindex="-1"></a>                                 <span class="at">gcomp =</span> gcomp,</span>
<span id="cb11-98"><a href="conf.html#cb11-98" tabindex="-1"></a>                                 <span class="at">iptw.only =</span> iptw.only,</span>
<span id="cb11-99"><a href="conf.html#cb11-99" tabindex="-1"></a>                                 <span class="at">survivalOutcome =</span> survivalOutcome,</span>
<span id="cb11-100"><a href="conf.html#cb11-100" tabindex="-1"></a>                                 <span class="at">estimate.time =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-101"><a href="conf.html#cb11-101" tabindex="-1"></a>                                 <span class="at">variance.method =</span> variance.method)</span>
<span id="cb11-102"><a href="conf.html#cb11-102" tabindex="-1"></a></span>
<span id="cb11-103"><a href="conf.html#cb11-103" tabindex="-1"></a>      bootstrap.res<span class="sc">$</span>beta.Intercept[b] <span class="ot">&lt;-</span> boot_ltmle_MSM<span class="sc">$</span>beta[<span class="st">&quot;(Intercept)&quot;</span>]</span>
<span id="cb11-104"><a href="conf.html#cb11-104" tabindex="-1"></a>      bootstrap.res<span class="sc">$</span>beta.A1[b] <span class="ot">&lt;-</span> boot_ltmle_MSM<span class="sc">$</span>beta[<span class="st">&quot;A1&quot;</span>]</span>
<span id="cb11-105"><a href="conf.html#cb11-105" tabindex="-1"></a>      bootstrap.res<span class="sc">$</span>beta.A2[b] <span class="ot">&lt;-</span> boot_ltmle_MSM<span class="sc">$</span>beta[<span class="st">&quot;A2&quot;</span>]</span>
<span id="cb11-106"><a href="conf.html#cb11-106" tabindex="-1"></a>      bootstrap.res<span class="sc">$</span>beta.A1A2[b] <span class="ot">&lt;-</span> boot_ltmle_MSM<span class="sc">$</span>beta[<span class="st">&quot;A1:A2&quot;</span>]</span>
<span id="cb11-107"><a href="conf.html#cb11-107" tabindex="-1"></a>    }</span>
<span id="cb11-108"><a href="conf.html#cb11-108" tabindex="-1"></a>  }</span>
<span id="cb11-109"><a href="conf.html#cb11-109" tabindex="-1"></a></span>
<span id="cb11-110"><a href="conf.html#cb11-110" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ltmle_MSM =</span> ltmle_MSM,</span>
<span id="cb11-111"><a href="conf.html#cb11-111" tabindex="-1"></a>              <span class="at">bootstrap.res =</span> bootstrap.res))</span>
<span id="cb11-112"><a href="conf.html#cb11-112" tabindex="-1"></a>}</span>
<span id="cb11-113"><a href="conf.html#cb11-113" tabindex="-1"></a></span>
<span id="cb11-114"><a href="conf.html#cb11-114" tabindex="-1"></a></span>
<span id="cb11-115"><a href="conf.html#cb11-115" tabindex="-1"></a><span class="do">### 4- summary.int()    pour enregistrer l&#39;ensemble des estimations</span></span>
<span id="cb11-116"><a href="conf.html#cb11-116" tabindex="-1"></a></span>
<span id="cb11-117"><a href="conf.html#cb11-117" tabindex="-1"></a>summary.int <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> data,</span>
<span id="cb11-118"><a href="conf.html#cb11-118" tabindex="-1"></a>                        <span class="at">ltmle_MSM =</span> ltmle_MSM,</span>
<span id="cb11-119"><a href="conf.html#cb11-119" tabindex="-1"></a>                        <span class="at">estimator =</span> <span class="fu">c</span>(<span class="st">&quot;gcomp&quot;</span>, <span class="st">&quot;iptw&quot;</span>, <span class="st">&quot;tmle&quot;</span>)) {</span>
<span id="cb11-120"><a href="conf.html#cb11-120" tabindex="-1"></a></span>
<span id="cb11-121"><a href="conf.html#cb11-121" tabindex="-1"></a>  <span class="cf">if</span>(estimator <span class="sc">==</span> <span class="st">&quot;gcomp&quot;</span>) {</span>
<span id="cb11-122"><a href="conf.html#cb11-122" tabindex="-1"></a>    <span class="fu">try</span>(<span class="cf">if</span>(ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>gcomp <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-123"><a href="conf.html#cb11-123" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;The ltmle function did not use the gcomp estimator, but the iptw +/- tmle estimator&quot;</span>))</span>
<span id="cb11-124"><a href="conf.html#cb11-124" tabindex="-1"></a></span>
<span id="cb11-125"><a href="conf.html#cb11-125" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>beta</span>
<span id="cb11-126"><a href="conf.html#cb11-126" tabindex="-1"></a>  }</span>
<span id="cb11-127"><a href="conf.html#cb11-127" tabindex="-1"></a></span>
<span id="cb11-128"><a href="conf.html#cb11-128" tabindex="-1"></a>  <span class="cf">if</span>(estimator <span class="sc">==</span> <span class="st">&quot;iptw&quot;</span>) {</span>
<span id="cb11-129"><a href="conf.html#cb11-129" tabindex="-1"></a>    <span class="fu">try</span>(<span class="cf">if</span>(ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>gcomp <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-130"><a href="conf.html#cb11-130" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;The ltmle function used the gcomp estimator, iptw is not available&quot;</span>))</span>
<span id="cb11-131"><a href="conf.html#cb11-131" tabindex="-1"></a></span>
<span id="cb11-132"><a href="conf.html#cb11-132" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>beta.iptw</span>
<span id="cb11-133"><a href="conf.html#cb11-133" tabindex="-1"></a>    IC <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>IC.iptw</span>
<span id="cb11-134"><a href="conf.html#cb11-134" tabindex="-1"></a>  }</span>
<span id="cb11-135"><a href="conf.html#cb11-135" tabindex="-1"></a></span>
<span id="cb11-136"><a href="conf.html#cb11-136" tabindex="-1"></a>  <span class="cf">if</span>(estimator <span class="sc">==</span> <span class="st">&quot;tmle&quot;</span>) {</span>
<span id="cb11-137"><a href="conf.html#cb11-137" tabindex="-1"></a>    <span class="fu">try</span>(<span class="cf">if</span>(ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>gcomp <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="fu">stop</span>(<span class="st">&quot;The ltmle function used the gcomp estimator, tmle is not available&quot;</span>))</span>
<span id="cb11-138"><a href="conf.html#cb11-138" tabindex="-1"></a></span>
<span id="cb11-139"><a href="conf.html#cb11-139" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>beta</span>
<span id="cb11-140"><a href="conf.html#cb11-140" tabindex="-1"></a>    IC <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>ltmle_MSM<span class="sc">$</span>IC</span>
<span id="cb11-141"><a href="conf.html#cb11-141" tabindex="-1"></a>  }</span>
<span id="cb11-142"><a href="conf.html#cb11-142" tabindex="-1"></a></span>
<span id="cb11-143"><a href="conf.html#cb11-143" tabindex="-1"></a>  <span class="co"># on va enregitrer l&#39;ensemble des résultats pertinent dans une table de longueur k1 x k2</span></span>
<span id="cb11-144"><a href="conf.html#cb11-144" tabindex="-1"></a>  int.r <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,</span>
<span id="cb11-145"><a href="conf.html#cb11-145" tabindex="-1"></a>                  <span class="at">ncol =</span> <span class="dv">34</span>,</span>
<span id="cb11-146"><a href="conf.html#cb11-146" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(data<span class="sc">$</span>A1)) <span class="sc">*</span> <span class="fu">nlevels</span>(<span class="fu">as.factor</span>(data<span class="sc">$</span>A2)))</span>
<span id="cb11-147"><a href="conf.html#cb11-147" tabindex="-1"></a>  int.r <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(int.r)</span>
<span id="cb11-148"><a href="conf.html#cb11-148" tabindex="-1"></a>  <span class="fu">names</span>(int.r) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>,<span class="st">&quot;p&quot;</span>,<span class="st">&quot;sd.p&quot;</span>,<span class="st">&quot;p.lo&quot;</span>,<span class="st">&quot;p.up&quot;</span>,</span>
<span id="cb11-149"><a href="conf.html#cb11-149" tabindex="-1"></a>                    <span class="st">&quot;RD.A1&quot;</span>,<span class="st">&quot;sd.RD.A1&quot;</span>,<span class="st">&quot;RD.A1.lo&quot;</span>,<span class="st">&quot;RD.A1.up&quot;</span>,</span>
<span id="cb11-150"><a href="conf.html#cb11-150" tabindex="-1"></a>                    <span class="st">&quot;RD.A2&quot;</span>,<span class="st">&quot;sd.RD.A2&quot;</span>,<span class="st">&quot;RD.A2.lo&quot;</span>,<span class="st">&quot;RD.A2.up&quot;</span>,</span>
<span id="cb11-151"><a href="conf.html#cb11-151" tabindex="-1"></a>                    <span class="st">&quot;RR.A1&quot;</span>,<span class="st">&quot;sd.lnRR.A1&quot;</span>,<span class="st">&quot;RR.A1.lo&quot;</span>,<span class="st">&quot;RR.A1.up&quot;</span>,</span>
<span id="cb11-152"><a href="conf.html#cb11-152" tabindex="-1"></a>                    <span class="st">&quot;RR.A2&quot;</span>,<span class="st">&quot;sd.lnRR.A2&quot;</span>,<span class="st">&quot;RR.A2.lo&quot;</span>,<span class="st">&quot;RR.A2.up&quot;</span>,</span>
<span id="cb11-153"><a href="conf.html#cb11-153" tabindex="-1"></a>                    <span class="st">&quot;a.INT&quot;</span>, <span class="st">&quot;sd.a.INT&quot;</span>, <span class="st">&quot;a.INT.lo&quot;</span>, <span class="st">&quot;a.INT.up&quot;</span>,<span class="st">&quot;RERI&quot;</span>,<span class="st">&quot;sd.lnRERI&quot;</span>,<span class="st">&quot;RERI.lo&quot;</span>,<span class="st">&quot;RERI.up&quot;</span>,</span>
<span id="cb11-154"><a href="conf.html#cb11-154" tabindex="-1"></a>                    <span class="st">&quot;m.INT&quot;</span>, <span class="st">&quot;sd.ln.m.INT&quot;</span>, <span class="st">&quot;m.INT.lo&quot;</span>, <span class="st">&quot;m.INT.up&quot;</span> )</span>
<span id="cb11-155"><a href="conf.html#cb11-155" tabindex="-1"></a>  int.r[,<span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>,<span class="st">&quot;A2&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb11-156"><a href="conf.html#cb11-156" tabindex="-1"></a></span>
<span id="cb11-157"><a href="conf.html#cb11-157" tabindex="-1"></a>  <span class="co"># on peut retrouver les IC95% par delta method</span></span>
<span id="cb11-158"><a href="conf.html#cb11-158" tabindex="-1"></a>  <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb11-159"><a href="conf.html#cb11-159" tabindex="-1"></a>  int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">plogis</span>(beta[<span class="st">&quot;(Intercept)&quot;</span>])</span>
<span id="cb11-160"><a href="conf.html#cb11-160" tabindex="-1"></a></span>
<span id="cb11-161"><a href="conf.html#cb11-161" tabindex="-1"></a>  <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb11-162"><a href="conf.html#cb11-162" tabindex="-1"></a>  int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">plogis</span>(beta[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-163"><a href="conf.html#cb11-163" tabindex="-1"></a>                                                     beta[<span class="st">&quot;A1&quot;</span>])</span>
<span id="cb11-164"><a href="conf.html#cb11-164" tabindex="-1"></a></span>
<span id="cb11-165"><a href="conf.html#cb11-165" tabindex="-1"></a>  <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb11-166"><a href="conf.html#cb11-166" tabindex="-1"></a>  int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">plogis</span>(beta[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-167"><a href="conf.html#cb11-167" tabindex="-1"></a>                                                     beta[<span class="st">&quot;A2&quot;</span>])</span>
<span id="cb11-168"><a href="conf.html#cb11-168" tabindex="-1"></a></span>
<span id="cb11-169"><a href="conf.html#cb11-169" tabindex="-1"></a>  <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb11-170"><a href="conf.html#cb11-170" tabindex="-1"></a>  int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">plogis</span>(beta[<span class="st">&quot;(Intercept)&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-171"><a href="conf.html#cb11-171" tabindex="-1"></a>                                                     beta[<span class="st">&quot;A1&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-172"><a href="conf.html#cb11-172" tabindex="-1"></a>                                                     beta[<span class="st">&quot;A2&quot;</span>] <span class="sc">+</span></span>
<span id="cb11-173"><a href="conf.html#cb11-173" tabindex="-1"></a>                                                     beta[<span class="st">&quot;A1:A2&quot;</span>])</span>
<span id="cb11-174"><a href="conf.html#cb11-174" tabindex="-1"></a></span>
<span id="cb11-175"><a href="conf.html#cb11-175" tabindex="-1"></a>  <span class="co"># RD.A1.A2is0</span></span>
<span id="cb11-176"><a href="conf.html#cb11-176" tabindex="-1"></a>  int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-177"><a href="conf.html#cb11-177" tabindex="-1"></a></span>
<span id="cb11-178"><a href="conf.html#cb11-178" tabindex="-1"></a>  <span class="co"># RD.A1.A2is1</span></span>
<span id="cb11-179"><a href="conf.html#cb11-179" tabindex="-1"></a>  int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-180"><a href="conf.html#cb11-180" tabindex="-1"></a></span>
<span id="cb11-181"><a href="conf.html#cb11-181" tabindex="-1"></a>  <span class="co"># RD.A2.A1is0</span></span>
<span id="cb11-182"><a href="conf.html#cb11-182" tabindex="-1"></a>  int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-183"><a href="conf.html#cb11-183" tabindex="-1"></a></span>
<span id="cb11-184"><a href="conf.html#cb11-184" tabindex="-1"></a>  <span class="co"># RD.A2.A1is1</span></span>
<span id="cb11-185"><a href="conf.html#cb11-185" tabindex="-1"></a>  int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-186"><a href="conf.html#cb11-186" tabindex="-1"></a></span>
<span id="cb11-187"><a href="conf.html#cb11-187" tabindex="-1"></a>  <span class="co"># RR.A1.A2is0</span></span>
<span id="cb11-188"><a href="conf.html#cb11-188" tabindex="-1"></a>  int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span> <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb11-189"><a href="conf.html#cb11-189" tabindex="-1"></a></span>
<span id="cb11-190"><a href="conf.html#cb11-190" tabindex="-1"></a>  <span class="co"># RR.A1.A2is1</span></span>
<span id="cb11-191"><a href="conf.html#cb11-191" tabindex="-1"></a>  int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]))</span>
<span id="cb11-192"><a href="conf.html#cb11-192" tabindex="-1"></a></span>
<span id="cb11-193"><a href="conf.html#cb11-193" tabindex="-1"></a>  <span class="co"># RR.A2.A1is0</span></span>
<span id="cb11-194"><a href="conf.html#cb11-194" tabindex="-1"></a>  int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb11-195"><a href="conf.html#cb11-195" tabindex="-1"></a></span>
<span id="cb11-196"><a href="conf.html#cb11-196" tabindex="-1"></a>  <span class="co"># RR.A2.A1is1</span></span>
<span id="cb11-197"><a href="conf.html#cb11-197" tabindex="-1"></a>  int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb11-198"><a href="conf.html#cb11-198" tabindex="-1"></a></span>
<span id="cb11-199"><a href="conf.html#cb11-199" tabindex="-1"></a>  <span class="co"># additive interaction</span></span>
<span id="cb11-200"><a href="conf.html#cb11-200" tabindex="-1"></a>  int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-201"><a href="conf.html#cb11-201" tabindex="-1"></a>    int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-202"><a href="conf.html#cb11-202" tabindex="-1"></a></span>
<span id="cb11-203"><a href="conf.html#cb11-203" tabindex="-1"></a>  <span class="co"># RERI</span></span>
<span id="cb11-204"><a href="conf.html#cb11-204" tabindex="-1"></a>  int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-205"><a href="conf.html#cb11-205" tabindex="-1"></a>                                                         int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-206"><a href="conf.html#cb11-206" tabindex="-1"></a>                                                     <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb11-207"><a href="conf.html#cb11-207" tabindex="-1"></a></span>
<span id="cb11-208"><a href="conf.html#cb11-208" tabindex="-1"></a>  <span class="co"># multiplicative interaction</span></span>
<span id="cb11-209"><a href="conf.html#cb11-209" tabindex="-1"></a>  int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-210"><a href="conf.html#cb11-210" tabindex="-1"></a>                                                      <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">log</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb11-211"><a href="conf.html#cb11-211" tabindex="-1"></a></span>
<span id="cb11-212"><a href="conf.html#cb11-212" tabindex="-1"></a>  <span class="do">## IC95%</span></span>
<span id="cb11-213"><a href="conf.html#cb11-213" tabindex="-1"></a>  <span class="cf">if</span>(estimator <span class="sc">==</span> <span class="st">&quot;iptw&quot;</span> <span class="sc">|</span> estimator <span class="sc">==</span> <span class="st">&quot;tmle&quot;</span>) {</span>
<span id="cb11-214"><a href="conf.html#cb11-214" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb11-215"><a href="conf.html#cb11-215" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb11-216"><a href="conf.html#cb11-216" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-217"><a href="conf.html#cb11-217" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-218"><a href="conf.html#cb11-218" tabindex="-1"></a></span>
<span id="cb11-219"><a href="conf.html#cb11-219" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-220"><a href="conf.html#cb11-220" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-221"><a href="conf.html#cb11-221" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb11-222"><a href="conf.html#cb11-222" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-223"><a href="conf.html#cb11-223" tabindex="-1"></a></span>
<span id="cb11-224"><a href="conf.html#cb11-224" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb11-225"><a href="conf.html#cb11-225" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-226"><a href="conf.html#cb11-226" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb11-227"><a href="conf.html#cb11-227" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-228"><a href="conf.html#cb11-228" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-229"><a href="conf.html#cb11-229" tabindex="-1"></a></span>
<span id="cb11-230"><a href="conf.html#cb11-230" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-231"><a href="conf.html#cb11-231" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-232"><a href="conf.html#cb11-232" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb11-233"><a href="conf.html#cb11-233" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-234"><a href="conf.html#cb11-234" tabindex="-1"></a></span>
<span id="cb11-235"><a href="conf.html#cb11-235" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb11-236"><a href="conf.html#cb11-236" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]), <span class="dv">0</span>,</span>
<span id="cb11-237"><a href="conf.html#cb11-237" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb11-238"><a href="conf.html#cb11-238" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-239"><a href="conf.html#cb11-239" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-240"><a href="conf.html#cb11-240" tabindex="-1"></a></span>
<span id="cb11-241"><a href="conf.html#cb11-241" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-242"><a href="conf.html#cb11-242" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-243"><a href="conf.html#cb11-243" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-244"><a href="conf.html#cb11-244" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-245"><a href="conf.html#cb11-245" tabindex="-1"></a></span>
<span id="cb11-246"><a href="conf.html#cb11-246" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb11-247"><a href="conf.html#cb11-247" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">rep</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]), <span class="dv">4</span>)</span>
<span id="cb11-248"><a href="conf.html#cb11-248" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-249"><a href="conf.html#cb11-249" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-250"><a href="conf.html#cb11-250" tabindex="-1"></a></span>
<span id="cb11-251"><a href="conf.html#cb11-251" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-252"><a href="conf.html#cb11-252" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-253"><a href="conf.html#cb11-253" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-254"><a href="conf.html#cb11-254" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-255"><a href="conf.html#cb11-255" tabindex="-1"></a></span>
<span id="cb11-256"><a href="conf.html#cb11-256" tabindex="-1"></a>    <span class="co"># RD.A1.A2is0</span></span>
<span id="cb11-257"><a href="conf.html#cb11-257" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-258"><a href="conf.html#cb11-258" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-259"><a href="conf.html#cb11-259" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]), <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb11-260"><a href="conf.html#cb11-260" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-261"><a href="conf.html#cb11-261" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-262"><a href="conf.html#cb11-262" tabindex="-1"></a></span>
<span id="cb11-263"><a href="conf.html#cb11-263" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-264"><a href="conf.html#cb11-264" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-265"><a href="conf.html#cb11-265" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb11-266"><a href="conf.html#cb11-266" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-267"><a href="conf.html#cb11-267" tabindex="-1"></a></span>
<span id="cb11-268"><a href="conf.html#cb11-268" tabindex="-1"></a>    <span class="co"># RD.A1.A2is1</span></span>
<span id="cb11-269"><a href="conf.html#cb11-269" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-270"><a href="conf.html#cb11-270" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb11-271"><a href="conf.html#cb11-271" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb11-272"><a href="conf.html#cb11-272" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-273"><a href="conf.html#cb11-273" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb11-274"><a href="conf.html#cb11-274" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) )</span>
<span id="cb11-275"><a href="conf.html#cb11-275" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-276"><a href="conf.html#cb11-276" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-277"><a href="conf.html#cb11-277" tabindex="-1"></a></span>
<span id="cb11-278"><a href="conf.html#cb11-278" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-279"><a href="conf.html#cb11-279" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-280"><a href="conf.html#cb11-280" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-281"><a href="conf.html#cb11-281" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-282"><a href="conf.html#cb11-282" tabindex="-1"></a></span>
<span id="cb11-283"><a href="conf.html#cb11-283" tabindex="-1"></a>    <span class="co"># RD.A2.A1is0</span></span>
<span id="cb11-284"><a href="conf.html#cb11-284" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-285"><a href="conf.html#cb11-285" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]), <span class="dv">0</span>,</span>
<span id="cb11-286"><a href="conf.html#cb11-286" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]), <span class="dv">0</span> )</span>
<span id="cb11-287"><a href="conf.html#cb11-287" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-288"><a href="conf.html#cb11-288" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-289"><a href="conf.html#cb11-289" tabindex="-1"></a></span>
<span id="cb11-290"><a href="conf.html#cb11-290" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-291"><a href="conf.html#cb11-291" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-292"><a href="conf.html#cb11-292" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-293"><a href="conf.html#cb11-293" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-294"><a href="conf.html#cb11-294" tabindex="-1"></a></span>
<span id="cb11-295"><a href="conf.html#cb11-295" tabindex="-1"></a>    <span class="co"># RD.A2.A1is1</span></span>
<span id="cb11-296"><a href="conf.html#cb11-296" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-297"><a href="conf.html#cb11-297" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-298"><a href="conf.html#cb11-298" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-299"><a href="conf.html#cb11-299" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-300"><a href="conf.html#cb11-300" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb11-301"><a href="conf.html#cb11-301" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]))</span>
<span id="cb11-302"><a href="conf.html#cb11-302" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-303"><a href="conf.html#cb11-303" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-304"><a href="conf.html#cb11-304" tabindex="-1"></a></span>
<span id="cb11-305"><a href="conf.html#cb11-305" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-306"><a href="conf.html#cb11-306" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-307"><a href="conf.html#cb11-307" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-308"><a href="conf.html#cb11-308" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-309"><a href="conf.html#cb11-309" tabindex="-1"></a></span>
<span id="cb11-310"><a href="conf.html#cb11-310" tabindex="-1"></a>    <span class="co"># RR.A1.A2is0</span></span>
<span id="cb11-311"><a href="conf.html#cb11-311" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>],</span>
<span id="cb11-312"><a href="conf.html#cb11-312" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>], <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb11-313"><a href="conf.html#cb11-313" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-314"><a href="conf.html#cb11-314" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-315"><a href="conf.html#cb11-315" tabindex="-1"></a></span>
<span id="cb11-316"><a href="conf.html#cb11-316" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-317"><a href="conf.html#cb11-317" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb11-318"><a href="conf.html#cb11-318" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">+</span></span>
<span id="cb11-319"><a href="conf.html#cb11-319" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb11-320"><a href="conf.html#cb11-320" tabindex="-1"></a></span>
<span id="cb11-321"><a href="conf.html#cb11-321" tabindex="-1"></a>    <span class="co"># RR.A1.A2is1</span></span>
<span id="cb11-322"><a href="conf.html#cb11-322" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-323"><a href="conf.html#cb11-323" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-324"><a href="conf.html#cb11-324" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-325"><a href="conf.html#cb11-325" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] )</span>
<span id="cb11-326"><a href="conf.html#cb11-326" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-327"><a href="conf.html#cb11-327" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-328"><a href="conf.html#cb11-328" tabindex="-1"></a></span>
<span id="cb11-329"><a href="conf.html#cb11-329" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-330"><a href="conf.html#cb11-330" tabindex="-1"></a>                                                               <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]))</span>
<span id="cb11-331"><a href="conf.html#cb11-331" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-332"><a href="conf.html#cb11-332" tabindex="-1"></a>                                                               <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]))</span>
<span id="cb11-333"><a href="conf.html#cb11-333" tabindex="-1"></a></span>
<span id="cb11-334"><a href="conf.html#cb11-334" tabindex="-1"></a>    <span class="co"># RR.A2.A1is0</span></span>
<span id="cb11-335"><a href="conf.html#cb11-335" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>], <span class="dv">0</span>,</span>
<span id="cb11-336"><a href="conf.html#cb11-336" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>], <span class="dv">0</span> )</span>
<span id="cb11-337"><a href="conf.html#cb11-337" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-338"><a href="conf.html#cb11-338" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-339"><a href="conf.html#cb11-339" tabindex="-1"></a></span>
<span id="cb11-340"><a href="conf.html#cb11-340" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-341"><a href="conf.html#cb11-341" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-342"><a href="conf.html#cb11-342" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-343"><a href="conf.html#cb11-343" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-344"><a href="conf.html#cb11-344" tabindex="-1"></a></span>
<span id="cb11-345"><a href="conf.html#cb11-345" tabindex="-1"></a>    <span class="co"># RR.A2.A1is1</span></span>
<span id="cb11-346"><a href="conf.html#cb11-346" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-347"><a href="conf.html#cb11-347" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-348"><a href="conf.html#cb11-348" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-349"><a href="conf.html#cb11-349" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-350"><a href="conf.html#cb11-350" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-351"><a href="conf.html#cb11-351" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-352"><a href="conf.html#cb11-352" tabindex="-1"></a></span>
<span id="cb11-353"><a href="conf.html#cb11-353" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-354"><a href="conf.html#cb11-354" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-355"><a href="conf.html#cb11-355" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-356"><a href="conf.html#cb11-356" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-357"><a href="conf.html#cb11-357" tabindex="-1"></a></span>
<span id="cb11-358"><a href="conf.html#cb11-358" tabindex="-1"></a>    <span class="co"># additive interaction</span></span>
<span id="cb11-359"><a href="conf.html#cb11-359" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-360"><a href="conf.html#cb11-360" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-361"><a href="conf.html#cb11-361" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-362"><a href="conf.html#cb11-362" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-363"><a href="conf.html#cb11-363" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-364"><a href="conf.html#cb11-364" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-365"><a href="conf.html#cb11-365" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-366"><a href="conf.html#cb11-366" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb11-367"><a href="conf.html#cb11-367" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) )</span>
<span id="cb11-368"><a href="conf.html#cb11-368" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-369"><a href="conf.html#cb11-369" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-370"><a href="conf.html#cb11-370" tabindex="-1"></a></span>
<span id="cb11-371"><a href="conf.html#cb11-371" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-372"><a href="conf.html#cb11-372" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-373"><a href="conf.html#cb11-373" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-374"><a href="conf.html#cb11-374" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-375"><a href="conf.html#cb11-375" tabindex="-1"></a></span>
<span id="cb11-376"><a href="conf.html#cb11-376" tabindex="-1"></a>    <span class="co"># RERI</span></span>
<span id="cb11-377"><a href="conf.html#cb11-377" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>((int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-378"><a href="conf.html#cb11-378" tabindex="-1"></a>                 int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-379"><a href="conf.html#cb11-379" tabindex="-1"></a>                 int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-380"><a href="conf.html#cb11-380" tabindex="-1"></a>                 int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>])) <span class="sc">/</span></span>
<span id="cb11-381"><a href="conf.html#cb11-381" tabindex="-1"></a>                (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-382"><a href="conf.html#cb11-382" tabindex="-1"></a>                   int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-383"><a href="conf.html#cb11-383" tabindex="-1"></a>                (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-384"><a href="conf.html#cb11-384" tabindex="-1"></a>              (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-385"><a href="conf.html#cb11-385" tabindex="-1"></a>                 int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>])) <span class="sc">/</span></span>
<span id="cb11-386"><a href="conf.html#cb11-386" tabindex="-1"></a>                (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-387"><a href="conf.html#cb11-387" tabindex="-1"></a>                   int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-388"><a href="conf.html#cb11-388" tabindex="-1"></a>              (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-389"><a href="conf.html#cb11-389" tabindex="-1"></a>                 int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])) <span class="sc">/</span></span>
<span id="cb11-390"><a href="conf.html#cb11-390" tabindex="-1"></a>                (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-391"><a href="conf.html#cb11-391" tabindex="-1"></a>                   int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb11-392"><a href="conf.html#cb11-392" tabindex="-1"></a>              (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])) <span class="sc">/</span></span>
<span id="cb11-393"><a href="conf.html#cb11-393" tabindex="-1"></a>                (int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-394"><a href="conf.html#cb11-394" tabindex="-1"></a>                   int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) )</span>
<span id="cb11-395"><a href="conf.html#cb11-395" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-396"><a href="conf.html#cb11-396" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-397"><a href="conf.html#cb11-397" tabindex="-1"></a></span>
<span id="cb11-398"><a href="conf.html#cb11-398" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-399"><a href="conf.html#cb11-399" tabindex="-1"></a>                                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-400"><a href="conf.html#cb11-400" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-401"><a href="conf.html#cb11-401" tabindex="-1"></a>                                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-402"><a href="conf.html#cb11-402" tabindex="-1"></a></span>
<span id="cb11-403"><a href="conf.html#cb11-403" tabindex="-1"></a>    <span class="co"># multiplicative interaction</span></span>
<span id="cb11-404"><a href="conf.html#cb11-404" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">c</span>(int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-405"><a href="conf.html#cb11-405" tabindex="-1"></a>                int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>],</span>
<span id="cb11-406"><a href="conf.html#cb11-406" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-407"><a href="conf.html#cb11-407" tabindex="-1"></a>              int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb11-408"><a href="conf.html#cb11-408" tabindex="-1"></a>              <span class="dv">1</span> <span class="sc">-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-409"><a href="conf.html#cb11-409" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(grad) <span class="sc">%*%</span> <span class="fu">var</span>(IC) <span class="sc">%*%</span> grad</span>
<span id="cb11-410"><a href="conf.html#cb11-410" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.ln.m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> <span class="fu">nrow</span>(data))</span>
<span id="cb11-411"><a href="conf.html#cb11-411" tabindex="-1"></a></span>
<span id="cb11-412"><a href="conf.html#cb11-412" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-413"><a href="conf.html#cb11-413" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.ln.m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-414"><a href="conf.html#cb11-414" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-415"><a href="conf.html#cb11-415" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.ln.m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-416"><a href="conf.html#cb11-416" tabindex="-1"></a></span>
<span id="cb11-417"><a href="conf.html#cb11-417" tabindex="-1"></a>    bootstrap.res <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res</span>
<span id="cb11-418"><a href="conf.html#cb11-418" tabindex="-1"></a>  }</span>
<span id="cb11-419"><a href="conf.html#cb11-419" tabindex="-1"></a></span>
<span id="cb11-420"><a href="conf.html#cb11-420" tabindex="-1"></a>  <span class="cf">if</span>(estimator <span class="sc">==</span> <span class="st">&quot;gcomp&quot;</span>) {</span>
<span id="cb11-421"><a href="conf.html#cb11-421" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.Intercept)</span>
<span id="cb11-422"><a href="conf.html#cb11-422" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.Intercept <span class="sc">+</span></span>
<span id="cb11-423"><a href="conf.html#cb11-423" tabindex="-1"></a>                                              ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.A1)</span>
<span id="cb11-424"><a href="conf.html#cb11-424" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.Intercept <span class="sc">+</span></span>
<span id="cb11-425"><a href="conf.html#cb11-425" tabindex="-1"></a>                                              ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.A2)</span>
<span id="cb11-426"><a href="conf.html#cb11-426" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="ot">&lt;-</span> <span class="fu">plogis</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.Intercept <span class="sc">+</span></span>
<span id="cb11-427"><a href="conf.html#cb11-427" tabindex="-1"></a>                                              ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.A1 <span class="sc">+</span></span>
<span id="cb11-428"><a href="conf.html#cb11-428" tabindex="-1"></a>                                              ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.A2 <span class="sc">+</span></span>
<span id="cb11-429"><a href="conf.html#cb11-429" tabindex="-1"></a>                                              ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>beta.A1A2)</span>
<span id="cb11-430"><a href="conf.html#cb11-430" tabindex="-1"></a></span>
<span id="cb11-431"><a href="conf.html#cb11-431" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A1.A2_0 <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0 <span class="sc">-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0</span>
<span id="cb11-432"><a href="conf.html#cb11-432" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A1.A2_1 <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1</span>
<span id="cb11-433"><a href="conf.html#cb11-433" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A2.A1_0 <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1 <span class="sc">-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0</span>
<span id="cb11-434"><a href="conf.html#cb11-434" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A2.A1_1 <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0</span>
<span id="cb11-435"><a href="conf.html#cb11-435" tabindex="-1"></a></span>
<span id="cb11-436"><a href="conf.html#cb11-436" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A1.A2_0 <span class="ot">&lt;-</span> <span class="fu">log</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0 <span class="sc">/</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0)</span>
<span id="cb11-437"><a href="conf.html#cb11-437" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A1.A2_1 <span class="ot">&lt;-</span> <span class="fu">log</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">/</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1)</span>
<span id="cb11-438"><a href="conf.html#cb11-438" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A2.A1_0 <span class="ot">&lt;-</span> <span class="fu">log</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1 <span class="sc">/</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0)</span>
<span id="cb11-439"><a href="conf.html#cb11-439" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A2.A1_1 <span class="ot">&lt;-</span> <span class="fu">log</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">/</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0)</span>
<span id="cb11-440"><a href="conf.html#cb11-440" tabindex="-1"></a></span>
<span id="cb11-441"><a href="conf.html#cb11-441" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>a.INT <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">-</span></span>
<span id="cb11-442"><a href="conf.html#cb11-442" tabindex="-1"></a>                                        ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0 <span class="sc">-</span></span>
<span id="cb11-443"><a href="conf.html#cb11-443" tabindex="-1"></a>                                        ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1 <span class="sc">+</span></span>
<span id="cb11-444"><a href="conf.html#cb11-444" tabindex="-1"></a>                                        ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0</span>
<span id="cb11-445"><a href="conf.html#cb11-445" tabindex="-1"></a></span>
<span id="cb11-446"><a href="conf.html#cb11-446" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRERI <span class="ot">&lt;-</span> <span class="fu">log</span>((ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">-</span></span>
<span id="cb11-447"><a href="conf.html#cb11-447" tabindex="-1"></a>                                             ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0 <span class="sc">-</span></span>
<span id="cb11-448"><a href="conf.html#cb11-448" tabindex="-1"></a>                                             ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1 <span class="sc">+</span></span>
<span id="cb11-449"><a href="conf.html#cb11-449" tabindex="-1"></a>                                             ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0) <span class="sc">/</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0)</span>
<span id="cb11-450"><a href="conf.html#cb11-450" tabindex="-1"></a></span>
<span id="cb11-451"><a href="conf.html#cb11-451" tabindex="-1"></a>    ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>ln.m.INT <span class="ot">&lt;-</span> <span class="fu">log</span>((ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1 <span class="sc">*</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0) <span class="sc">/</span></span>
<span id="cb11-452"><a href="conf.html#cb11-452" tabindex="-1"></a>                                              (ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0 <span class="sc">*</span> ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1))</span>
<span id="cb11-453"><a href="conf.html#cb11-453" tabindex="-1"></a></span>
<span id="cb11-454"><a href="conf.html#cb11-454" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 0</span></span>
<span id="cb11-455"><a href="conf.html#cb11-455" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_0)</span>
<span id="cb11-456"><a href="conf.html#cb11-456" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-457"><a href="conf.html#cb11-457" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-458"><a href="conf.html#cb11-458" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb11-459"><a href="conf.html#cb11-459" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-460"><a href="conf.html#cb11-460" tabindex="-1"></a></span>
<span id="cb11-461"><a href="conf.html#cb11-461" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 0</span></span>
<span id="cb11-462"><a href="conf.html#cb11-462" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_0)</span>
<span id="cb11-463"><a href="conf.html#cb11-463" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-464"><a href="conf.html#cb11-464" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-465"><a href="conf.html#cb11-465" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb11-466"><a href="conf.html#cb11-466" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-467"><a href="conf.html#cb11-467" tabindex="-1"></a></span>
<span id="cb11-468"><a href="conf.html#cb11-468" tabindex="-1"></a>    <span class="co"># A1 = 0 et A2 = 1</span></span>
<span id="cb11-469"><a href="conf.html#cb11-469" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_0.A2_1)</span>
<span id="cb11-470"><a href="conf.html#cb11-470" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-471"><a href="conf.html#cb11-471" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-472"><a href="conf.html#cb11-472" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-473"><a href="conf.html#cb11-473" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-474"><a href="conf.html#cb11-474" tabindex="-1"></a></span>
<span id="cb11-475"><a href="conf.html#cb11-475" tabindex="-1"></a>    <span class="co"># A1 = 1 et A2 = 1</span></span>
<span id="cb11-476"><a href="conf.html#cb11-476" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>p.A1_1.A2_1)</span>
<span id="cb11-477"><a href="conf.html#cb11-477" tabindex="-1"></a>    int.r<span class="sc">$</span>p.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-478"><a href="conf.html#cb11-478" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-479"><a href="conf.html#cb11-479" tabindex="-1"></a>    int.r<span class="sc">$</span>p.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-480"><a href="conf.html#cb11-480" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.p[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-481"><a href="conf.html#cb11-481" tabindex="-1"></a></span>
<span id="cb11-482"><a href="conf.html#cb11-482" tabindex="-1"></a>    <span class="co"># RD.A1.A2is0</span></span>
<span id="cb11-483"><a href="conf.html#cb11-483" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A1.A2_0)</span>
<span id="cb11-484"><a href="conf.html#cb11-484" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">-</span></span>
<span id="cb11-485"><a href="conf.html#cb11-485" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-486"><a href="conf.html#cb11-486" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span></span>
<span id="cb11-487"><a href="conf.html#cb11-487" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]</span>
<span id="cb11-488"><a href="conf.html#cb11-488" tabindex="-1"></a></span>
<span id="cb11-489"><a href="conf.html#cb11-489" tabindex="-1"></a>    <span class="co"># RD.A1.A2is1</span></span>
<span id="cb11-490"><a href="conf.html#cb11-490" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A1.A2_1)</span>
<span id="cb11-491"><a href="conf.html#cb11-491" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-492"><a href="conf.html#cb11-492" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-493"><a href="conf.html#cb11-493" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-494"><a href="conf.html#cb11-494" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-495"><a href="conf.html#cb11-495" tabindex="-1"></a></span>
<span id="cb11-496"><a href="conf.html#cb11-496" tabindex="-1"></a>    <span class="co"># RD.A2.A1is0</span></span>
<span id="cb11-497"><a href="conf.html#cb11-497" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A2.A1_0)</span>
<span id="cb11-498"><a href="conf.html#cb11-498" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-499"><a href="conf.html#cb11-499" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-500"><a href="conf.html#cb11-500" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-501"><a href="conf.html#cb11-501" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-502"><a href="conf.html#cb11-502" tabindex="-1"></a></span>
<span id="cb11-503"><a href="conf.html#cb11-503" tabindex="-1"></a>    <span class="co"># RD.A2.A1is1</span></span>
<span id="cb11-504"><a href="conf.html#cb11-504" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>RD.A2.A1_1)</span>
<span id="cb11-505"><a href="conf.html#cb11-505" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-506"><a href="conf.html#cb11-506" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-507"><a href="conf.html#cb11-507" tabindex="-1"></a>    int.r<span class="sc">$</span>RD.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-508"><a href="conf.html#cb11-508" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.RD.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-509"><a href="conf.html#cb11-509" tabindex="-1"></a></span>
<span id="cb11-510"><a href="conf.html#cb11-510" tabindex="-1"></a>    <span class="co"># RR.A1.A2is0</span></span>
<span id="cb11-511"><a href="conf.html#cb11-511" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A1.A2_0)</span>
<span id="cb11-512"><a href="conf.html#cb11-512" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span></span>
<span id="cb11-513"><a href="conf.html#cb11-513" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb11-514"><a href="conf.html#cb11-514" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">+</span></span>
<span id="cb11-515"><a href="conf.html#cb11-515" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb11-516"><a href="conf.html#cb11-516" tabindex="-1"></a></span>
<span id="cb11-517"><a href="conf.html#cb11-517" tabindex="-1"></a>    <span class="co"># RR.A1.A2is1</span></span>
<span id="cb11-518"><a href="conf.html#cb11-518" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A1.A2_1)</span>
<span id="cb11-519"><a href="conf.html#cb11-519" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-520"><a href="conf.html#cb11-520" tabindex="-1"></a>                                                               <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]))</span>
<span id="cb11-521"><a href="conf.html#cb11-521" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A1.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-522"><a href="conf.html#cb11-522" tabindex="-1"></a>                                                               <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A1[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]))</span>
<span id="cb11-523"><a href="conf.html#cb11-523" tabindex="-1"></a></span>
<span id="cb11-524"><a href="conf.html#cb11-524" tabindex="-1"></a>    <span class="co"># RR.A2.A1is0</span></span>
<span id="cb11-525"><a href="conf.html#cb11-525" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A2.A1_0)</span>
<span id="cb11-526"><a href="conf.html#cb11-526" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-527"><a href="conf.html#cb11-527" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-528"><a href="conf.html#cb11-528" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-529"><a href="conf.html#cb11-529" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-530"><a href="conf.html#cb11-530" tabindex="-1"></a></span>
<span id="cb11-531"><a href="conf.html#cb11-531" tabindex="-1"></a>    <span class="co"># RR.A2.A1is1</span></span>
<span id="cb11-532"><a href="conf.html#cb11-532" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRR.A2.A1_1)</span>
<span id="cb11-533"><a href="conf.html#cb11-533" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-534"><a href="conf.html#cb11-534" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-535"><a href="conf.html#cb11-535" tabindex="-1"></a>    int.r<span class="sc">$</span>RR.A2.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-536"><a href="conf.html#cb11-536" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRR.A2[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-537"><a href="conf.html#cb11-537" tabindex="-1"></a></span>
<span id="cb11-538"><a href="conf.html#cb11-538" tabindex="-1"></a>    <span class="co"># additive interaction</span></span>
<span id="cb11-539"><a href="conf.html#cb11-539" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>a.INT)</span>
<span id="cb11-540"><a href="conf.html#cb11-540" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb11-541"><a href="conf.html#cb11-541" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-542"><a href="conf.html#cb11-542" tabindex="-1"></a>    int.r<span class="sc">$</span>a.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> int.r<span class="sc">$</span>a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb11-543"><a href="conf.html#cb11-543" tabindex="-1"></a>      <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.a.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb11-544"><a href="conf.html#cb11-544" tabindex="-1"></a></span>
<span id="cb11-545"><a href="conf.html#cb11-545" tabindex="-1"></a>    <span class="co"># RERI</span></span>
<span id="cb11-546"><a href="conf.html#cb11-546" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.lnRERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>lnRERI)</span>
<span id="cb11-547"><a href="conf.html#cb11-547" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-548"><a href="conf.html#cb11-548" tabindex="-1"></a>                                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-549"><a href="conf.html#cb11-549" tabindex="-1"></a>    int.r<span class="sc">$</span>RERI.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>RERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-550"><a href="conf.html#cb11-550" tabindex="-1"></a>                                                          <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.lnRERI[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-551"><a href="conf.html#cb11-551" tabindex="-1"></a></span>
<span id="cb11-552"><a href="conf.html#cb11-552" tabindex="-1"></a>    <span class="co"># multiplicative interaction</span></span>
<span id="cb11-553"><a href="conf.html#cb11-553" tabindex="-1"></a>    int.r<span class="sc">$</span>sd.ln.m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(ltmle_MSM<span class="sc">$</span>bootstrap.res<span class="sc">$</span>ln.m.INT)</span>
<span id="cb11-554"><a href="conf.html#cb11-554" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.lo[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span></span>
<span id="cb11-555"><a href="conf.html#cb11-555" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.ln.m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-556"><a href="conf.html#cb11-556" tabindex="-1"></a>    int.r<span class="sc">$</span>m.INT.up[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(int.r<span class="sc">$</span>m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb11-557"><a href="conf.html#cb11-557" tabindex="-1"></a>                                                           <span class="fu">qnorm</span>(<span class="fl">0.975</span>) <span class="sc">*</span> int.r<span class="sc">$</span>sd.ln.m.INT[int.r<span class="sc">$</span>A1 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> int.r<span class="sc">$</span>A2 <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb11-558"><a href="conf.html#cb11-558" tabindex="-1"></a></span>
<span id="cb11-559"><a href="conf.html#cb11-559" tabindex="-1"></a>    bootstrap.res <span class="ot">&lt;-</span> ltmle_MSM<span class="sc">$</span>bootstrap.res</span>
<span id="cb11-560"><a href="conf.html#cb11-560" tabindex="-1"></a>  }</span>
<span id="cb11-561"><a href="conf.html#cb11-561" tabindex="-1"></a></span>
<span id="cb11-562"><a href="conf.html#cb11-562" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">int.r =</span> int.r,</span>
<span id="cb11-563"><a href="conf.html#cb11-563" tabindex="-1"></a>              <span class="at">bootstrap.res =</span> bootstrap.res))</span>
<span id="cb11-564"><a href="conf.html#cb11-564" tabindex="-1"></a>}</span>
<span id="cb11-565"><a href="conf.html#cb11-565" tabindex="-1"></a><span class="do">### Obtention du MSM par la fonction ltmle, estimation par gcomp, iptw ou tmle</span></span>
<span id="cb11-566"><a href="conf.html#cb11-566" tabindex="-1"></a><span class="co"># avec la fonction int.ltmleMSM()</span></span>
<span id="cb11-567"><a href="conf.html#cb11-567" tabindex="-1"></a></span>
<span id="cb11-568"><a href="conf.html#cb11-568" tabindex="-1"></a><span class="co"># on définit les arguments de la fonction ltmleMSM du package ltmle</span></span>
<span id="cb11-569"><a href="conf.html#cb11-569" tabindex="-1"></a><span class="fu">library</span>(ltmle)</span>
<span id="cb11-570"><a href="conf.html#cb11-570" tabindex="-1"></a><span class="fu">library</span>(SuperLearner)</span>
<span id="cb11-571"><a href="conf.html#cb11-571" tabindex="-1"></a></span>
<span id="cb11-572"><a href="conf.html#cb11-572" tabindex="-1"></a><span class="do">## arguments à renseigner</span></span>
<span id="cb11-573"><a href="conf.html#cb11-573" tabindex="-1"></a>Q_formulas <span class="ot">=</span> <span class="fu">c</span>(<span class="at">Y=</span><span class="st">&quot;Q.kplus1 ~ L1 + L2 + L3 + A1 * A2&quot;</span>) <span class="co"># useful to add A1 * A2 interaction here</span></span>
<span id="cb11-574"><a href="conf.html#cb11-574" tabindex="-1"></a>g_formulas <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A1 ~ L1 + L2&quot;</span>,</span>
<span id="cb11-575"><a href="conf.html#cb11-575" tabindex="-1"></a>               <span class="st">&quot;A2 ~ L1 + L3&quot;</span>)</span>
<span id="cb11-576"><a href="conf.html#cb11-576" tabindex="-1"></a></span>
<span id="cb11-577"><a href="conf.html#cb11-577" tabindex="-1"></a>SL.library <span class="ot">=</span> <span class="fu">list</span>(<span class="at">Q=</span><span class="fu">list</span>(<span class="st">&quot;SL.glm&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;SL.glm&quot;</span>, <span class="st">&quot;screen.corP&quot;</span>),</span>
<span id="cb11-578"><a href="conf.html#cb11-578" tabindex="-1"></a>                         <span class="st">&quot;SL.xgboost&quot;</span>, <span class="st">&quot;SL.rpartPrune&quot;</span>, <span class="co">#&quot;SL.randomForest&quot;,</span></span>
<span id="cb11-579"><a href="conf.html#cb11-579" tabindex="-1"></a>                         <span class="st">&quot;SL.step.interaction&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;SL.step.interaction&quot;</span>,<span class="st">&quot;screen.corP&quot;</span>),</span>
<span id="cb11-580"><a href="conf.html#cb11-580" tabindex="-1"></a>                         <span class="st">&quot;SL.glmnet&quot;</span>, <span class="st">&quot;SL.stepAIC&quot;</span>,</span>
<span id="cb11-581"><a href="conf.html#cb11-581" tabindex="-1"></a>                         <span class="st">&quot;SL.mean&quot;</span>),</span>
<span id="cb11-582"><a href="conf.html#cb11-582" tabindex="-1"></a>                  <span class="at">g=</span><span class="fu">list</span>(<span class="st">&quot;SL.glm&quot;</span>,  <span class="fu">c</span>(<span class="st">&quot;SL.glm&quot;</span>, <span class="st">&quot;screen.corP&quot;</span>),</span>
<span id="cb11-583"><a href="conf.html#cb11-583" tabindex="-1"></a>                         <span class="st">&quot;SL.xgboost&quot;</span>, <span class="st">&quot;SL.rpartPrune&quot;</span>, <span class="co">#&quot;SL.randomForest&quot;,</span></span>
<span id="cb11-584"><a href="conf.html#cb11-584" tabindex="-1"></a>                         <span class="st">&quot;SL.step.interaction&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;SL.step.interaction&quot;</span>,<span class="st">&quot;screen.corP&quot;</span>),</span>
<span id="cb11-585"><a href="conf.html#cb11-585" tabindex="-1"></a>                         <span class="st">&quot;SL.glmnet&quot;</span>, <span class="st">&quot;SL.stepAIC&quot;</span>,</span>
<span id="cb11-586"><a href="conf.html#cb11-586" tabindex="-1"></a>                         <span class="st">&quot;SL.mean&quot;</span>))</span>
<span id="cb11-587"><a href="conf.html#cb11-587" tabindex="-1"></a></span>
<span id="cb11-588"><a href="conf.html#cb11-588" tabindex="-1"></a><span class="do">### estimation par IPTW et TMLE</span></span>
<span id="cb11-589"><a href="conf.html#cb11-589" tabindex="-1"></a>  interaction.ltmle <span class="ot">&lt;-</span> <span class="fu">int.ltmleMSM</span>(<span class="at">data =</span> df,</span>
<span id="cb11-590"><a href="conf.html#cb11-590" tabindex="-1"></a>                                  <span class="at">Q_formulas =</span> Q_formulas,</span>
<span id="cb11-591"><a href="conf.html#cb11-591" tabindex="-1"></a>                                  <span class="at">g_formulas =</span> g_formulas,</span>
<span id="cb11-592"><a href="conf.html#cb11-592" tabindex="-1"></a>                                  <span class="at">Anodes =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>),</span>
<span id="cb11-593"><a href="conf.html#cb11-593" tabindex="-1"></a>                                  <span class="at">Lnodes =</span> <span class="fu">c</span>(<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;L2&quot;</span>, <span class="st">&quot;L3&quot;</span>),</span>
<span id="cb11-594"><a href="conf.html#cb11-594" tabindex="-1"></a>                                  <span class="at">Ynodes =</span> <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>),</span>
<span id="cb11-595"><a href="conf.html#cb11-595" tabindex="-1"></a>                                  <span class="at">final.Ynodes =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb11-596"><a href="conf.html#cb11-596" tabindex="-1"></a>                                  <span class="at">SL.library =</span> SL.library,</span>
<span id="cb11-597"><a href="conf.html#cb11-597" tabindex="-1"></a>                                  <span class="at">gcomp =</span> <span class="cn">FALSE</span>,            <span class="co"># si FALSE, fait tmle + IPTW</span></span>
<span id="cb11-598"><a href="conf.html#cb11-598" tabindex="-1"></a>                                  <span class="at">iptw.only =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-599"><a href="conf.html#cb11-599" tabindex="-1"></a>                                  <span class="co"># si (gcomp = FALSE et iptw.only = TRUE), fait uniquement iptw</span></span>
<span id="cb11-600"><a href="conf.html#cb11-600" tabindex="-1"></a>                                  <span class="at">survivalOutcome =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-601"><a href="conf.html#cb11-601" tabindex="-1"></a>                                  <span class="at">variance.method =</span> <span class="st">&quot;ic&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required namespace: xgboost</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="conf.html#cb13-1" tabindex="-1"></a><span class="do">### estimation par g-computation</span></span>
<span id="cb13-2"><a href="conf.html#cb13-2" tabindex="-1"></a>  <span class="co"># par défaut, il fait une régression logistique à partir de la formule Q_formulas</span></span>
<span id="cb13-3"><a href="conf.html#cb13-3" tabindex="-1"></a>  <span class="co"># si on veut faire un régression linéaire pour le modèle additif, on peut créer une fonction de SuperLearner</span></span>
<span id="cb13-4"><a href="conf.html#cb13-4" tabindex="-1"></a>  <span class="co"># à partir de la fonction SL.glm</span></span>
<span id="cb13-5"><a href="conf.html#cb13-5" tabindex="-1"></a>  SL.glm.gaussian <span class="ot">&lt;-</span> <span class="cf">function</span> (Y, X, newX,</span>
<span id="cb13-6"><a href="conf.html#cb13-6" tabindex="-1"></a>                               <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb13-7"><a href="conf.html#cb13-7" tabindex="-1"></a>                               <span class="co"># tout est comme SL.glm, sauf cette famille &quot;gaussian&quot;</span></span>
<span id="cb13-8"><a href="conf.html#cb13-8" tabindex="-1"></a>                               obsWeights, <span class="at">model =</span> <span class="cn">TRUE</span>, ...) {</span>
<span id="cb13-9"><a href="conf.html#cb13-9" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.matrix</span>(X)) {</span>
<span id="cb13-10"><a href="conf.html#cb13-10" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">as.data.frame</span>(X)</span>
<span id="cb13-11"><a href="conf.html#cb13-11" tabindex="-1"></a>  }</span>
<span id="cb13-12"><a href="conf.html#cb13-12" tabindex="-1"></a>  fit.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> X, <span class="at">family =</span> family, <span class="at">weights =</span> obsWeights,</span>
<span id="cb13-13"><a href="conf.html#cb13-13" tabindex="-1"></a>                 <span class="at">model =</span> model)</span>
<span id="cb13-14"><a href="conf.html#cb13-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.matrix</span>(newX)) {</span>
<span id="cb13-15"><a href="conf.html#cb13-15" tabindex="-1"></a>    newX <span class="ot">=</span> <span class="fu">as.data.frame</span>(newX)</span>
<span id="cb13-16"><a href="conf.html#cb13-16" tabindex="-1"></a>  }</span>
<span id="cb13-17"><a href="conf.html#cb13-17" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit.glm, <span class="at">newdata =</span> newX, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb13-18"><a href="conf.html#cb13-18" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">object =</span> fit.glm)</span>
<span id="cb13-19"><a href="conf.html#cb13-19" tabindex="-1"></a>  <span class="fu">class</span>(fit) <span class="ot">&lt;-</span> <span class="st">&quot;SL.glm&quot;</span></span>
<span id="cb13-20"><a href="conf.html#cb13-20" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">pred =</span> pred, <span class="at">fit =</span> fit)</span>
<span id="cb13-21"><a href="conf.html#cb13-21" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb13-22"><a href="conf.html#cb13-22" tabindex="-1"></a>}</span>
<span id="cb13-23"><a href="conf.html#cb13-23" tabindex="-1"></a><span class="fu">environment</span>(SL.glm.gaussian) <span class="ot">&lt;-</span><span class="fu">asNamespace</span>(<span class="st">&quot;SuperLearner&quot;</span>)</span>
<span id="cb13-24"><a href="conf.html#cb13-24" tabindex="-1"></a></span>
<span id="cb13-25"><a href="conf.html#cb13-25" tabindex="-1"></a>interaction.gcomp <span class="ot">&lt;-</span> <span class="fu">int.ltmleMSM</span>(<span class="at">data =</span> df,</span>
<span id="cb13-26"><a href="conf.html#cb13-26" tabindex="-1"></a>                                  <span class="at">Q_formulas =</span> Q_formulas,</span>
<span id="cb13-27"><a href="conf.html#cb13-27" tabindex="-1"></a>                                  <span class="at">g_formulas =</span> g_formulas,</span>
<span id="cb13-28"><a href="conf.html#cb13-28" tabindex="-1"></a>                                  <span class="at">Anodes =</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>),</span>
<span id="cb13-29"><a href="conf.html#cb13-29" tabindex="-1"></a>                                  <span class="at">Lnodes =</span> <span class="fu">c</span>(<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;L2&quot;</span>, <span class="st">&quot;L3&quot;</span>),</span>
<span id="cb13-30"><a href="conf.html#cb13-30" tabindex="-1"></a>                                  <span class="at">Ynodes =</span> <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>),</span>
<span id="cb13-31"><a href="conf.html#cb13-31" tabindex="-1"></a>                                  <span class="at">final.Ynodes =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb13-32"><a href="conf.html#cb13-32" tabindex="-1"></a>                                  <span class="co"># SL.library = SL.library,</span></span>
<span id="cb13-33"><a href="conf.html#cb13-33" tabindex="-1"></a>                                  <span class="at">SL.library =</span> <span class="fu">list</span>(<span class="at">Q=</span><span class="st">&quot;SL.glm.gaussian&quot;</span>, <span class="co">#</span></span>
<span id="cb13-34"><a href="conf.html#cb13-34" tabindex="-1"></a>                                                    <span class="at">g=</span><span class="st">&quot;SL.mean&quot;</span>),</span>
<span id="cb13-35"><a href="conf.html#cb13-35" tabindex="-1"></a>                                  <span class="at">gcomp =</span> <span class="cn">TRUE</span>,            <span class="co"># si FALSE, fait tmle + IPTW</span></span>
<span id="cb13-36"><a href="conf.html#cb13-36" tabindex="-1"></a>                                  <span class="at">iptw.only =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-37"><a href="conf.html#cb13-37" tabindex="-1"></a>                                  <span class="co"># si (gcomp = FALSE et iptw.only = TRUE), fait uniquement iptw</span></span>
<span id="cb13-38"><a href="conf.html#cb13-38" tabindex="-1"></a>                                  <span class="at">survivalOutcome =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-39"><a href="conf.html#cb13-39" tabindex="-1"></a>                                  <span class="at">variance.method =</span> <span class="st">&quot;ic&quot;</span>,</span>
<span id="cb13-40"><a href="conf.html#cb13-40" tabindex="-1"></a>                                  <span class="at">B =</span> <span class="dv">1000</span>, <span class="co"># nombre d&#39;échantillons bootstrap</span></span>
<span id="cb13-41"><a href="conf.html#cb13-41" tabindex="-1"></a>                                  <span class="at">boot.seed =</span> <span class="dv">54321</span>) <span class="co"># seed pour l&#39;échantillonnage bootstrap</span></span>
<span id="cb13-42"><a href="conf.html#cb13-42" tabindex="-1"></a></span>
<span id="cb13-43"><a href="conf.html#cb13-43" tabindex="-1"></a></span>
<span id="cb13-44"><a href="conf.html#cb13-44" tabindex="-1"></a><span class="do">### 3) Calcul des paramètres utiles pour l&#39;analyse de l&#39;interaction</span></span>
<span id="cb13-45"><a href="conf.html#cb13-45" tabindex="-1"></a>    <span class="co"># avec la fonction summary.int()</span></span>
<span id="cb13-46"><a href="conf.html#cb13-46" tabindex="-1"></a></span>
<span id="cb13-47"><a href="conf.html#cb13-47" tabindex="-1"></a>    <span class="do">### récupération des résultats tmle</span></span>
<span id="cb13-48"><a href="conf.html#cb13-48" tabindex="-1"></a>    summary.tmle <span class="ot">&lt;-</span> <span class="fu">summary.int</span>(<span class="at">data =</span> df,</span>
<span id="cb13-49"><a href="conf.html#cb13-49" tabindex="-1"></a>                                <span class="at">ltmle_MSM =</span> interaction.ltmle,</span>
<span id="cb13-50"><a href="conf.html#cb13-50" tabindex="-1"></a>                                <span class="at">estimator =</span> <span class="fu">c</span>(<span class="st">&quot;tmle&quot;</span>))</span>
<span id="cb13-51"><a href="conf.html#cb13-51" tabindex="-1"></a>    <span class="co"># summary.tmle$int.r</span></span>
<span id="cb13-52"><a href="conf.html#cb13-52" tabindex="-1"></a></span>
<span id="cb13-53"><a href="conf.html#cb13-53" tabindex="-1"></a>    <span class="do">### récupération des résultats iptw</span></span>
<span id="cb13-54"><a href="conf.html#cb13-54" tabindex="-1"></a>    summary.iptw <span class="ot">&lt;-</span> <span class="fu">summary.int</span>(<span class="at">data =</span> df,</span>
<span id="cb13-55"><a href="conf.html#cb13-55" tabindex="-1"></a>                                <span class="at">ltmle_MSM =</span> interaction.ltmle,</span>
<span id="cb13-56"><a href="conf.html#cb13-56" tabindex="-1"></a>                                <span class="at">estimator =</span> <span class="fu">c</span>(<span class="st">&quot;iptw&quot;</span>))</span>
<span id="cb13-57"><a href="conf.html#cb13-57" tabindex="-1"></a>    <span class="co"># summary.iptw$int.r</span></span>
<span id="cb13-58"><a href="conf.html#cb13-58" tabindex="-1"></a></span>
<span id="cb13-59"><a href="conf.html#cb13-59" tabindex="-1"></a>    <span class="do">### récupération des résultats gcomputation</span></span>
<span id="cb13-60"><a href="conf.html#cb13-60" tabindex="-1"></a>    summary.gcomp <span class="ot">&lt;-</span> <span class="fu">summary.int</span>(<span class="at">data =</span> df,</span>
<span id="cb13-61"><a href="conf.html#cb13-61" tabindex="-1"></a>                                <span class="at">ltmle_MSM =</span> interaction.gcomp,</span>
<span id="cb13-62"><a href="conf.html#cb13-62" tabindex="-1"></a>                                <span class="at">estimator =</span> <span class="fu">c</span>(<span class="st">&quot;gcomp&quot;</span>))</span>
<span id="cb13-63"><a href="conf.html#cb13-63" tabindex="-1"></a>    </span>
<span id="cb13-64"><a href="conf.html#cb13-64" tabindex="-1"></a>    </span>
<span id="cb13-65"><a href="conf.html#cb13-65" tabindex="-1"></a>    <span class="co"># summary.gcomp$int.r</span></span>
<span id="cb13-66"><a href="conf.html#cb13-66" tabindex="-1"></a>    <span class="co"># head(summary.gcomp$bootstrap.res)</span></span>
<span id="cb13-67"><a href="conf.html#cb13-67" tabindex="-1"></a>    <span class="co"># # vérifier la normalité des estimations bootstrap</span></span>
<span id="cb13-68"><a href="conf.html#cb13-68" tabindex="-1"></a>    <span class="co">#     bootstrap.est &lt;- subset(summary.gcomp$bootstrap.res,</span></span>
<span id="cb13-69"><a href="conf.html#cb13-69" tabindex="-1"></a>    <span class="co">#                             select =</span></span>
<span id="cb13-70"><a href="conf.html#cb13-70" tabindex="-1"></a>    <span class="co">#                               c(&quot;p.A1_0.A2_0&quot;,</span></span>
<span id="cb13-71"><a href="conf.html#cb13-71" tabindex="-1"></a>    <span class="co">#                                 &quot;p.A1_1.A2_0&quot;,</span></span>
<span id="cb13-72"><a href="conf.html#cb13-72" tabindex="-1"></a>    <span class="co">#                                 &quot;p.A1_0.A2_1&quot;,</span></span>
<span id="cb13-73"><a href="conf.html#cb13-73" tabindex="-1"></a>    <span class="co">#                                 &quot;p.A1_1.A2_1&quot;,</span></span>
<span id="cb13-74"><a href="conf.html#cb13-74" tabindex="-1"></a>    <span class="co">#                                 &quot;RD.A1.A2_0&quot;,</span></span>
<span id="cb13-75"><a href="conf.html#cb13-75" tabindex="-1"></a>    <span class="co">#                                 &quot;RD.A1.A2_1&quot;,</span></span>
<span id="cb13-76"><a href="conf.html#cb13-76" tabindex="-1"></a>    <span class="co">#                                 &quot;RD.A2.A1_0&quot;,</span></span>
<span id="cb13-77"><a href="conf.html#cb13-77" tabindex="-1"></a>    <span class="co">#                                 &quot;RD.A2.A1_1&quot;,</span></span>
<span id="cb13-78"><a href="conf.html#cb13-78" tabindex="-1"></a>    <span class="co">#                                 &quot;lnRR.A1.A2_0&quot;,</span></span>
<span id="cb13-79"><a href="conf.html#cb13-79" tabindex="-1"></a>    <span class="co">#                                 &quot;lnRR.A1.A2_1&quot;,</span></span>
<span id="cb13-80"><a href="conf.html#cb13-80" tabindex="-1"></a>    <span class="co">#                                 &quot;lnRR.A2.A1_0&quot;,</span></span>
<span id="cb13-81"><a href="conf.html#cb13-81" tabindex="-1"></a>    <span class="co">#                                 &quot;lnRR.A2.A1_1&quot;,</span></span>
<span id="cb13-82"><a href="conf.html#cb13-82" tabindex="-1"></a>    <span class="co">#                                 &quot;a.INT&quot;,</span></span>
<span id="cb13-83"><a href="conf.html#cb13-83" tabindex="-1"></a>    <span class="co">#                                 &quot;lnRERI&quot;,</span></span>
<span id="cb13-84"><a href="conf.html#cb13-84" tabindex="-1"></a>    <span class="co">#                                 &quot;ln.m.INT&quot;))</span></span>
<span id="cb13-85"><a href="conf.html#cb13-85" tabindex="-1"></a>    <span class="co"># par(mfrow = c(4,4))</span></span>
<span id="cb13-86"><a href="conf.html#cb13-86" tabindex="-1"></a>    <span class="co"># for(c in 1:ncol(bootstrap.est)) {</span></span>
<span id="cb13-87"><a href="conf.html#cb13-87" tabindex="-1"></a>    <span class="co">#   hist(bootstrap.est[,c], freq = FALSE, main = names(bootstrap.est)[c])</span></span>
<span id="cb13-88"><a href="conf.html#cb13-88" tabindex="-1"></a>    <span class="co">#   lines(density(bootstrap.est[,c]), col = 2, lwd = 3)</span></span>
<span id="cb13-89"><a href="conf.html#cb13-89" tabindex="-1"></a>    <span class="co">#   curve(1/sqrt(var(bootstrap.est[,c]) * 2 * pi) *  exp(-1/2*((x-mean(bootstrap.est[,c]))/sd(bootstrap.est[,c]))^2),</span></span>
<span id="cb13-90"><a href="conf.html#cb13-90" tabindex="-1"></a>    <span class="co">#         col = 1, lwd = 2, lty = 2, add = TRUE)</span></span>
<span id="cb13-91"><a href="conf.html#cb13-91" tabindex="-1"></a>    <span class="co"># par(mfrow = c(1,1))</span></span>
<span id="cb13-92"><a href="conf.html#cb13-92" tabindex="-1"></a>    <span class="co"># }</span></span></code></pre></div>
<p>Au final, on a (présentation selon recommandation Knol et al. <span class="citation">[<a href="#ref-knol_recommendations_2012">11</a>]</span>):</p>
<div id="tmle" class="section level3 unnumbered hasAnchor">
<h3>TMLE<a href="conf.html#tmle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>## $out.table
##                                  A2=0                        A2=1
## A1=0     $p_{00}$=0.104 [0.095,0.113]  $p_{01}$=0.195 [0.18,0.21]
## A1=1     $p_{10}$=0.408 [0.378,0.439] $p_{11}$=0.903 [0.88,0.927]
## RD.A1|A2          0.304 [0.272,0.336]          0.708 [0.68,0.737]
## RR.A1|A2              3.93 [3.5,4.41]            4.63 [4.55,4.72]
##                     RD.A2|A1         RR.A2|A1
## A1=0     0.091 [0.073,0.109] 1.88 [1.67,2.11]
## A1=1     0.495 [0.457,0.534]  2.21 [2.04,2.4]
## RD.A1|A2                                     
## RR.A1|A2                                     
## 
## $interaction.effects
## [1] &quot;additive Interaction = 0.404 [0.362;0.447]&quot;   
## [2] &quot;RERI = 3.89 [3.45;4.4]&quot;                       
## [3] &quot;multiplicative Interaction = 1.18 [1.02;1.36]&quot;</code></pre>
</div>
<div id="iptw" class="section level3 unnumbered hasAnchor">
<h3>IPTW<a href="conf.html#iptw" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>## $out.table
##                                  A2=0                        A2=1
## A1=0     $p_{00}$=0.104 [0.095,0.113]  $p_{01}$=0.195 [0.18,0.21]
## A1=1     $p_{10}$=0.408 [0.377,0.439] $p_{11}$=0.904 [0.88,0.927]
## RD.A1|A2          0.304 [0.272,0.336]          0.709 [0.68,0.737]
## RR.A1|A2              3.93 [3.5,4.41]            4.63 [4.55,4.72]
##                     RD.A2|A1         RR.A2|A1
## A1=0     0.091 [0.073,0.109] 1.88 [1.67,2.11]
## A1=1     0.496 [0.457,0.534]  2.22 [2.05,2.4]
## RD.A1|A2                                     
## RR.A1|A2                                     
## 
## $interaction.effects
## [1] &quot;additive Interaction = 0.405 [0.362;0.447]&quot;   
## [2] &quot;RERI = 3.9 [3.45;4.4]&quot;                        
## [3] &quot;multiplicative Interaction = 1.18 [1.02;1.36]&quot;</code></pre>
</div>
<div id="g-computation" class="section level3 unnumbered hasAnchor">
<h3>G-computation<a href="conf.html#g-computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>## $out.table
##                                  A2=0                         A2=1
## A1=0     $p_{00}$=0.104 [0.095,0.112] $p_{01}$=0.197 [0.183,0.211]
## A1=1       $p_{10}$=0.4 [0.373,0.427] $p_{11}$=0.893 [0.872,0.914]
## RD.A1|A2          0.296 [0.268,0.325]          0.697 [0.671,0.722]
## RR.A1|A2             3.86 [3.46,4.31]             4.54 [4.46,4.61]
##                    RD.A2|A1        RR.A2|A1
## A1=0     0.093 [0.077,0.11]  1.9 [1.7,2.12]
## A1=1     0.494 [0.46,0.527] 2.23 [2.08,2.4]
## RD.A1|A2                                   
## RR.A1|A2                                   
## 
## $interaction.effects
## [1] &quot;additive Interaction = 0.4 [0.363;0.438]&quot;     
## [2] &quot;RERI = 3.86 [3.46;4.32]&quot;                      
## [3] &quot;multiplicative Interaction = 1.18 [1.03;1.34]&quot;</code></pre>

</div>
</div>
</div>
<h3> Références<a href="références.html#références" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-knol_recommendations_2012" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">Knol MJ, VanderWeele TJ. Recommendations for presenting analyses of effect modification and interaction. International Journal of Epidemiology 2012;41:514–20. <a href="https://doi.org/10.1093/ije/dyr218">https://doi.org/10.1093/ije/dyr218</a>.</div>
</div>
<div id="ref-hernan2020causal" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">Hernán MA, Robins JM. Causal inference: What if - PREPRINT. Chapman &amp; Hall/CRC Boca Raton, FL; 2020.</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graph.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-analyse_confirmatoire.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
